!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.formform=e():t.formform=e()}(this,(function(){return function(){var t={736:function(t,e,r){var n;t=r.nmd(t);var o=function(t){"use strict";var e=1e7,r=9007199254740992,n=f(r),i="0123456789abcdefghijklmnopqrstuvwxyz",u="function"==typeof BigInt;function s(t,e,r,n){return void 0===t?s[0]:void 0===e||10==+e&&!r?Y(t):T(t,e,r,n)}function a(t,e){this.value=t,this.sign=e,this.isSmall=!1}function p(t){this.value=t,this.sign=t<0,this.isSmall=!0}function l(t){this.value=t}function c(t){return-r<t&&t<r}function f(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function h(t){v(t);var r=t.length;if(r<4&&j(t,n)<0)switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function v(t){for(var e=t.length;0===t[--e];);t.length=e+1}function y(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function g(t){return t>0?Math.floor(t):Math.ceil(t)}function d(t,r){var n,o,i=t.length,u=r.length,s=new Array(i),a=0,p=e;for(o=0;o<u;o++)a=(n=t[o]+r[o]+a)>=p?1:0,s[o]=n-a*p;for(;o<i;)a=(n=t[o]+a)===p?1:0,s[o++]=n-a*p;return a>0&&s.push(a),s}function m(t,e){return t.length>=e.length?d(t,e):d(e,t)}function w(t,r){var n,o,i=t.length,u=new Array(i),s=e;for(o=0;o<i;o++)n=t[o]-s+r,r=Math.floor(n/s),u[o]=n-r*s,r+=1;for(;r>0;)u[o++]=r%s,r=Math.floor(r/s);return u}function b(t,r){var n,o,i=t.length,u=r.length,s=new Array(i),a=0,p=e;for(n=0;n<u;n++)(o=t[n]-a-r[n])<0?(o+=p,a=1):a=0,s[n]=o;for(n=u;n<i;n++){if(!((o=t[n]-a)<0)){s[n++]=o;break}o+=p,s[n]=o}for(;n<i;n++)s[n]=t[n];return v(s),s}function N(t,r,n){var o,i,u=t.length,s=new Array(u),l=-r,c=e;for(o=0;o<u;o++)i=t[o]+l,l=Math.floor(i/c),i%=c,s[o]=i<0?i+c:i;return"number"==typeof(s=h(s))?(n&&(s=-s),new p(s)):new a(s,n)}function E(t,r){var n,o,i,u,s=t.length,a=r.length,p=y(s+a),l=e;for(i=0;i<s;++i){u=t[i];for(var c=0;c<a;++c)n=u*r[c]+p[i+c],o=Math.floor(n/l),p[i+c]=n-o*l,p[i+c+1]+=o}return v(p),p}function S(t,r){var n,o,i=t.length,u=new Array(i),s=e,a=0;for(o=0;o<i;o++)n=t[o]*r+a,a=Math.floor(n/s),u[o]=n-a*s;for(;a>0;)u[o++]=a%s,a=Math.floor(a/s);return u}function O(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function A(t,e){var r=Math.max(t.length,e.length);if(r<=30)return E(t,e);r=Math.ceil(r/2);var n=t.slice(r),o=t.slice(0,r),i=e.slice(r),u=e.slice(0,r),s=A(o,u),a=A(n,i),p=A(m(o,n),m(u,i)),l=m(m(s,O(b(b(p,s),a),r)),O(a,2*r));return v(l),l}function M(t,r,n){return new a(t<e?S(r,t):E(r,f(t)),n)}function q(t){var r,n,o,i,u=t.length,s=y(u+u),a=e;for(o=0;o<u;o++){n=0-(i=t[o])*i;for(var p=o;p<u;p++)r=i*t[p]*2+s[o+p]+n,n=Math.floor(r/a),s[o+p]=r-n*a;s[o+u]=n}return v(s),s}function I(t,e){var r,n,o,i,u=t.length,s=y(u);for(o=0,r=u-1;r>=0;--r)o=(i=1e7*o+t[r])-(n=g(i/e))*e,s[r]=0|n;return[s,0|o]}function x(t,r){var n,o=Y(r);if(u)return[new l(t.value/o.value),new l(t.value%o.value)];var i,c=t.value,d=o.value;if(0===d)throw new Error("Cannot divide by zero");if(t.isSmall)return o.isSmall?[new p(g(c/d)),new p(c%d)]:[s[0],t];if(o.isSmall){if(1===d)return[t,s[0]];if(-1==d)return[t.negate(),s[0]];var m=Math.abs(d);if(m<e){i=h((n=I(c,m))[0]);var w=n[1];return t.sign&&(w=-w),"number"==typeof i?(t.sign!==o.sign&&(i=-i),[new p(i),new p(w)]):[new a(i,t.sign!==o.sign),new p(w)]}d=f(m)}var N=j(c,d);if(-1===N)return[s[0],t];if(0===N)return[s[t.sign===o.sign?1:-1],s[0]];i=(n=c.length+d.length<=200?function(t,r){var n,o,i,u,s,a,p,l=t.length,c=r.length,f=e,v=y(r.length),g=r[c-1],d=Math.ceil(f/(2*g)),m=S(t,d),w=S(r,d);for(m.length<=l&&m.push(0),w.push(0),g=w[c-1],o=l-c;o>=0;o--){for(n=f-1,m[o+c]!==g&&(n=Math.floor((m[o+c]*f+m[o+c-1])/g)),i=0,u=0,a=w.length,s=0;s<a;s++)i+=n*w[s],p=Math.floor(i/f),u+=m[o+s]-(i-p*f),i=p,u<0?(m[o+s]=u+f,u=-1):(m[o+s]=u,u=0);for(;0!==u;){for(n-=1,i=0,s=0;s<a;s++)(i+=m[o+s]-f+w[s])<0?(m[o+s]=i+f,i=0):(m[o+s]=i,i=1);u+=i}v[o]=n}return m=I(m,d)[0],[h(v),h(m)]}(c,d):function(t,r){for(var n,o,i,u,s,a=t.length,p=r.length,l=[],c=[],f=e;a;)if(c.unshift(t[--a]),v(c),j(c,r)<0)l.push(0);else{i=c[(o=c.length)-1]*f+c[o-2],u=r[p-1]*f+r[p-2],o>p&&(i=(i+1)*f),n=Math.ceil(i/u);do{if(j(s=S(r,n),c)<=0)break;n--}while(n);l.push(n),c=b(c,s)}return l.reverse(),[h(l),h(c)]}(c,d))[0];var E=t.sign!==o.sign,O=n[1],A=t.sign;return"number"==typeof i?(E&&(i=-i),i=new p(i)):i=new a(i,E),"number"==typeof O?(A&&(O=-O),O=new p(O)):O=new a(O,A),[i,O]}function j(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function L(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function P(t,e){for(var r,n,i,u=t.prev(),s=u,a=0;s.isEven();)s=s.divide(2),a++;t:for(n=0;n<e.length;n++)if(!t.lesser(e[n])&&!(i=o(e[n]).modPow(s,t)).isUnit()&&!i.equals(u)){for(r=a-1;0!=r;r--){if((i=i.square().mod(t)).isUnit())return!1;if(i.equals(u))continue t}return!1}return!0}a.prototype=Object.create(s.prototype),p.prototype=Object.create(s.prototype),l.prototype=Object.create(s.prototype),a.prototype.add=function(t){var e=Y(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new a(w(r,Math.abs(n)),this.sign):new a(m(r,n),this.sign)},a.prototype.plus=a.prototype.add,p.prototype.add=function(t){var e=Y(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(c(r+n))return new p(r+n);n=f(Math.abs(n))}return new a(w(n,Math.abs(r)),r<0)},p.prototype.plus=p.prototype.add,l.prototype.add=function(t){return new l(this.value+Y(t).value)},l.prototype.plus=l.prototype.add,a.prototype.subtract=function(t){var e=Y(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,n=e.value;return e.isSmall?N(r,Math.abs(n),this.sign):function(t,e,r){var n;return j(t,e)>=0?n=b(t,e):(n=b(e,t),r=!r),"number"==typeof(n=h(n))?(r&&(n=-n),new p(n)):new a(n,r)}(r,n,this.sign)},a.prototype.minus=a.prototype.subtract,p.prototype.subtract=function(t){var e=Y(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new p(r-n):N(n,Math.abs(r),r>=0)},p.prototype.minus=p.prototype.subtract,l.prototype.subtract=function(t){return new l(this.value-Y(t).value)},l.prototype.minus=l.prototype.subtract,a.prototype.negate=function(){return new a(this.value,!this.sign)},p.prototype.negate=function(){var t=this.sign,e=new p(-this.value);return e.sign=!t,e},l.prototype.negate=function(){return new l(-this.value)},a.prototype.abs=function(){return new a(this.value,!1)},p.prototype.abs=function(){return new p(Math.abs(this.value))},l.prototype.abs=function(){return new l(this.value>=0?this.value:-this.value)},a.prototype.multiply=function(t){var r,n,o,i=Y(t),u=this.value,p=i.value,l=this.sign!==i.sign;if(i.isSmall){if(0===p)return s[0];if(1===p)return this;if(-1===p)return this.negate();if((r=Math.abs(p))<e)return new a(S(u,r),l);p=f(r)}return new a(-.012*(n=u.length)-.012*(o=p.length)+15e-6*n*o>0?A(u,p):E(u,p),l)},a.prototype.times=a.prototype.multiply,p.prototype._multiplyBySmall=function(t){return c(t.value*this.value)?new p(t.value*this.value):M(Math.abs(t.value),f(Math.abs(this.value)),this.sign!==t.sign)},a.prototype._multiplyBySmall=function(t){return 0===t.value?s[0]:1===t.value?this:-1===t.value?this.negate():M(Math.abs(t.value),this.value,this.sign!==t.sign)},p.prototype.multiply=function(t){return Y(t)._multiplyBySmall(this)},p.prototype.times=p.prototype.multiply,l.prototype.multiply=function(t){return new l(this.value*Y(t).value)},l.prototype.times=l.prototype.multiply,a.prototype.square=function(){return new a(q(this.value),!1)},p.prototype.square=function(){var t=this.value*this.value;return c(t)?new p(t):new a(q(f(Math.abs(this.value))),!1)},l.prototype.square=function(t){return new l(this.value*this.value)},a.prototype.divmod=function(t){var e=x(this,t);return{quotient:e[0],remainder:e[1]}},l.prototype.divmod=p.prototype.divmod=a.prototype.divmod,a.prototype.divide=function(t){return x(this,t)[0]},l.prototype.over=l.prototype.divide=function(t){return new l(this.value/Y(t).value)},p.prototype.over=p.prototype.divide=a.prototype.over=a.prototype.divide,a.prototype.mod=function(t){return x(this,t)[1]},l.prototype.mod=l.prototype.remainder=function(t){return new l(this.value%Y(t).value)},p.prototype.remainder=p.prototype.mod=a.prototype.remainder=a.prototype.mod,a.prototype.pow=function(t){var e,r,n,o=Y(t),i=this.value,u=o.value;if(0===u)return s[1];if(0===i)return s[0];if(1===i)return s[1];if(-1===i)return o.isEven()?s[1]:s[-1];if(o.sign)return s[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&c(e=Math.pow(i,u)))return new p(g(e));for(r=this,n=s[1];!0&u&&(n=n.times(r),--u),0!==u;)u/=2,r=r.square();return n},p.prototype.pow=a.prototype.pow,l.prototype.pow=function(t){var e=Y(t),r=this.value,n=e.value,o=BigInt(0),i=BigInt(1),u=BigInt(2);if(n===o)return s[1];if(r===o)return s[0];if(r===i)return s[1];if(r===BigInt(-1))return e.isEven()?s[1]:s[-1];if(e.isNegative())return new l(o);for(var a=this,p=s[1];(n&i)===i&&(p=p.times(a),--n),n!==o;)n/=u,a=a.square();return p},a.prototype.modPow=function(t,e){if(t=Y(t),(e=Y(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=s[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(s[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return s[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},l.prototype.modPow=p.prototype.modPow=a.prototype.modPow,a.prototype.compareAbs=function(t){var e=Y(t),r=this.value,n=e.value;return e.isSmall?1:j(r,n)},p.prototype.compareAbs=function(t){var e=Y(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},l.prototype.compareAbs=function(t){var e=this.value,r=Y(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},a.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Y(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:j(r,n)*(this.sign?-1:1)},a.prototype.compareTo=a.prototype.compare,p.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Y(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},p.prototype.compareTo=p.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,r=Y(t).value;return e===r?0:e>r?1:-1},l.prototype.compareTo=l.prototype.compare,a.prototype.equals=function(t){return 0===this.compare(t)},l.prototype.eq=l.prototype.equals=p.prototype.eq=p.prototype.equals=a.prototype.eq=a.prototype.equals,a.prototype.notEquals=function(t){return 0!==this.compare(t)},l.prototype.neq=l.prototype.notEquals=p.prototype.neq=p.prototype.notEquals=a.prototype.neq=a.prototype.notEquals,a.prototype.greater=function(t){return this.compare(t)>0},l.prototype.gt=l.prototype.greater=p.prototype.gt=p.prototype.greater=a.prototype.gt=a.prototype.greater,a.prototype.lesser=function(t){return this.compare(t)<0},l.prototype.lt=l.prototype.lesser=p.prototype.lt=p.prototype.lesser=a.prototype.lt=a.prototype.lesser,a.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},l.prototype.geq=l.prototype.greaterOrEquals=p.prototype.geq=p.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals,a.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},l.prototype.leq=l.prototype.lesserOrEquals=p.prototype.leq=p.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals,a.prototype.isEven=function(){return 0==(1&this.value[0])},p.prototype.isEven=function(){return 0==(1&this.value)},l.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},a.prototype.isOdd=function(){return 1==(1&this.value[0])},p.prototype.isOdd=function(){return 1==(1&this.value)},l.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},a.prototype.isPositive=function(){return!this.sign},p.prototype.isPositive=function(){return this.value>0},l.prototype.isPositive=p.prototype.isPositive,a.prototype.isNegative=function(){return this.sign},p.prototype.isNegative=function(){return this.value<0},l.prototype.isNegative=p.prototype.isNegative,a.prototype.isUnit=function(){return!1},p.prototype.isUnit=function(){return 1===Math.abs(this.value)},l.prototype.isUnit=function(){return this.abs().value===BigInt(1)},a.prototype.isZero=function(){return!1},p.prototype.isZero=function(){return 0===this.value},l.prototype.isZero=function(){return this.value===BigInt(0)},a.prototype.isDivisibleBy=function(t){var e=Y(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},l.prototype.isDivisibleBy=p.prototype.isDivisibleBy=a.prototype.isDivisibleBy,a.prototype.isPrime=function(e){var r=L(this);if(r!==t)return r;var n=this.abs(),i=n.bitLength();if(i<=64)return P(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var u=Math.log(2)*i.toJSNumber(),s=Math.ceil(!0===e?2*Math.pow(u,2):u),a=[],p=0;p<s;p++)a.push(o(p+2));return P(n,a)},l.prototype.isPrime=p.prototype.isPrime=a.prototype.isPrime,a.prototype.isProbablePrime=function(e,r){var n=L(this);if(n!==t)return n;for(var i=this.abs(),u=e===t?5:e,s=[],a=0;a<u;a++)s.push(o.randBetween(2,i.minus(2),r));return P(i,s)},l.prototype.isProbablePrime=p.prototype.isProbablePrime=a.prototype.isProbablePrime,a.prototype.modInv=function(t){for(var e,r,n,i=o.zero,u=o.one,s=Y(t),a=this.abs();!a.isZero();)e=s.divide(a),r=i,n=s,i=u,s=a,u=r.subtract(e.multiply(u)),a=n.subtract(e.multiply(a));if(!s.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===i.compare(0)&&(i=i.add(t)),this.isNegative()?i.negate():i},l.prototype.modInv=p.prototype.modInv=a.prototype.modInv,a.prototype.next=function(){var t=this.value;return this.sign?N(t,1,this.sign):new a(w(t,1),this.sign)},p.prototype.next=function(){var t=this.value;return t+1<r?new p(t+1):new a(n,!1)},l.prototype.next=function(){return new l(this.value+BigInt(1))},a.prototype.prev=function(){var t=this.value;return this.sign?new a(w(t,1),!0):N(t,1,this.sign)},p.prototype.prev=function(){var t=this.value;return t-1>-r?new p(t-1):new a(n,!0)},l.prototype.prev=function(){return new l(this.value-BigInt(1))};for(var R=[1];2*R[R.length-1]<=e;)R.push(2*R[R.length-1]);var k=R.length,D=R[k-1];function F(t){return Math.abs(t)<=e}function B(t,e,r){e=Y(e);for(var n=t.isNegative(),i=e.isNegative(),u=n?t.not():t,s=i?e.not():e,a=0,p=0,l=null,c=null,f=[];!u.isZero()||!s.isZero();)a=(l=x(u,D))[1].toJSNumber(),n&&(a=D-1-a),p=(c=x(s,D))[1].toJSNumber(),i&&(p=D-1-p),u=l[0],s=c[0],f.push(r(a,p));for(var h=0!==r(n?1:0,i?1:0)?o(-1):o(0),v=f.length-1;v>=0;v-=1)h=h.multiply(D).add(o(f[v]));return h}a.prototype.shiftLeft=function(t){var e=Y(t).toJSNumber();if(!F(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=k;)r=r.multiply(D),e-=k-1;return r.multiply(R[e])},l.prototype.shiftLeft=p.prototype.shiftLeft=a.prototype.shiftLeft,a.prototype.shiftRight=function(t){var e,r=Y(t).toJSNumber();if(!F(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=k;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=x(n,D))[1].isNegative()?e[0].prev():e[0],r-=k-1}return(e=x(n,R[r]))[1].isNegative()?e[0].prev():e[0]},l.prototype.shiftRight=p.prototype.shiftRight=a.prototype.shiftRight,a.prototype.not=function(){return this.negate().prev()},l.prototype.not=p.prototype.not=a.prototype.not,a.prototype.and=function(t){return B(this,t,(function(t,e){return t&e}))},l.prototype.and=p.prototype.and=a.prototype.and,a.prototype.or=function(t){return B(this,t,(function(t,e){return t|e}))},l.prototype.or=p.prototype.or=a.prototype.or,a.prototype.xor=function(t){return B(this,t,(function(t,e){return t^e}))},l.prototype.xor=p.prototype.xor=a.prototype.xor;var $=1<<30;function J(t){var r=t.value,n="number"==typeof r?r|$:"bigint"==typeof r?r|BigInt($):r[0]+r[1]*e|1073758208;return n&-n}function V(t,e){if(e.compareTo(t)<=0){var r=V(t,e.square(e)),n=r.p,i=r.e,u=n.multiply(e);return u.compareTo(t)<=0?{p:u,e:2*i+1}:{p:n,e:2*i}}return{p:o(1),e:0}}function Z(t,e){return t=Y(t),e=Y(e),t.greater(e)?t:e}function _(t,e){return t=Y(t),e=Y(e),t.lesser(e)?t:e}function z(t,e){if(t=Y(t).abs(),e=Y(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,o=s[1];t.isEven()&&e.isEven();)r=_(J(t),J(e)),t=t.divide(r),e=e.divide(r),o=o.multiply(r);for(;t.isEven();)t=t.divide(J(t));do{for(;e.isEven();)e=e.divide(J(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero());return o.isUnit()?t:t.multiply(o)}a.prototype.bitLength=function(){var t=this;return t.compareTo(o(0))<0&&(t=t.negate().subtract(o(1))),0===t.compareTo(o(0))?o(0):o(V(t,o(2)).e).add(o(1))},l.prototype.bitLength=p.prototype.bitLength=a.prototype.bitLength;var T=function(t,e,r,n){r=r||i,t=String(t),n||(t=t.toLowerCase(),r=r.toLowerCase());var o,u=t.length,s=Math.abs(e),a={};for(o=0;o<r.length;o++)a[r[o]]=o;for(o=0;o<u;o++)if("-"!==(c=t[o])&&c in a&&a[c]>=s){if("1"===c&&1===s)continue;throw new Error(c+" is not a valid digit in base "+e+".")}e=Y(e);var p=[],l="-"===t[0];for(o=l?1:0;o<t.length;o++){var c;if((c=t[o])in a)p.push(Y(a[c]));else{if("<"!==c)throw new Error(c+" is not a valid character");var f=o;do{o++}while(">"!==t[o]&&o<t.length);p.push(Y(t.slice(f+1,o)))}}return C(p,e,l)};function C(t,e,r){var n,o=s[0],i=s[1];for(n=t.length-1;n>=0;n--)o=o.add(t[n].times(i)),i=i.times(e);return r?o.negate():o}function U(t,e){if((e=o(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(t.isNegative()&&e.isPositive()&&(n=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var i,u=[],s=t;s.isNegative()||s.compareAbs(e)>=0;){i=s.divmod(e),s=i.quotient;var a=i.remainder;a.isNegative()&&(a=e.minus(a).abs(),s=s.next()),u.push(a.toJSNumber())}return u.push(s.toJSNumber()),{value:u.reverse(),isNegative:n}}function W(t,e,r){var n=U(t,e);return(n.isNegative?"-":"")+n.value.map((function(t){return function(t,e){return t<(e=e||i).length?e[t]:"<"+t+">"}(t,r)})).join("")}function G(t){if(c(+t)){var e=+t;if(e===g(e))return u?new l(BigInt(e)):new p(e);throw new Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var o=n[1];if("+"===o[0]&&(o=o.slice(1)),(o=+o)!==g(o)||!c(o))throw new Error("Invalid integer: "+o+" is not a valid exponent.");var i=n[0],s=i.indexOf(".");if(s>=0&&(o-=i.length-s-1,i=i.slice(0,s)+i.slice(s+1)),o<0)throw new Error("Cannot include negative exponent part for integers");t=i+=new Array(o+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(u)return new l(BigInt(r?"-"+t:t));for(var f=[],h=t.length,y=h-7;h>0;)f.push(+t.slice(y,h)),(y-=7)<0&&(y=0),h-=7;return v(f),new a(f,r)}function Y(t){return"number"==typeof t?function(t){if(u)return new l(BigInt(t));if(c(t)){if(t!==g(t))throw new Error(t+" is not an integer.");return new p(t)}return G(t.toString())}(t):"string"==typeof t?G(t):"bigint"==typeof t?new l(t):t}a.prototype.toArray=function(t){return U(this,t)},p.prototype.toArray=function(t){return U(this,t)},l.prototype.toArray=function(t){return U(this,t)},a.prototype.toString=function(e,r){if(e===t&&(e=10),10!==e)return W(this,e,r);for(var n,o=this.value,i=o.length,u=String(o[--i]);--i>=0;)n=String(o[i]),u+="0000000".slice(n.length)+n;return(this.sign?"-":"")+u},p.prototype.toString=function(e,r){return e===t&&(e=10),10!=e?W(this,e,r):String(this.value)},l.prototype.toString=p.prototype.toString,l.prototype.toJSON=a.prototype.toJSON=p.prototype.toJSON=function(){return this.toString()},a.prototype.valueOf=function(){return parseInt(this.toString(),10)},a.prototype.toJSNumber=a.prototype.valueOf,p.prototype.valueOf=function(){return this.value},p.prototype.toJSNumber=p.prototype.valueOf,l.prototype.valueOf=l.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var H=0;H<1e3;H++)s[H]=Y(H),H>0&&(s[-H]=Y(-H));return s.one=s[1],s.zero=s[0],s.minusOne=s[-1],s.max=Z,s.min=_,s.gcd=z,s.lcm=function(t,e){return t=Y(t).abs(),e=Y(e).abs(),t.divide(z(t,e)).multiply(e)},s.isInstance=function(t){return t instanceof a||t instanceof p||t instanceof l},s.randBetween=function(t,r,n){t=Y(t),r=Y(r);var o=n||Math.random,i=_(t,r),u=Z(t,r).subtract(i).add(1);if(u.isSmall)return i.add(Math.floor(o()*u));for(var a=U(u,e).value,p=[],l=!0,c=0;c<a.length;c++){var f=l?a[c]:e,h=g(o()*f);p.push(h),h<f&&(l=!1)}return i.add(s.fromArray(p,e,!1))},s.fromArray=function(t,e,r){return C(t.map(Y),Y(e||10),r)},s}();t.hasOwnProperty("exports")&&(t.exports=o),void 0===(n=function(){return o}.call(e,r,e,t))||(t.exports=n)}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n](i,i.exports,r),i.loaded=!0,i.exports}r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t};var n={};return function(){"use strict";r.d(n,{default:function(){return Mt}});var t={};r.r(t),r.d(t,{cont:function(){return v},equiv:function(){return y},iForm2:function(){return d},iForm3:function(){return w},iForm4:function(){return N},iForm5:function(){return S},implL:function(){return l},implR:function(){return c},inv:function(){return a},inv_logic:function(){return s},post:function(){return h},pre:function(){return f},reEntry:function(){return p},rel:function(){return u},rel_logic:function(){return i},uForm2:function(){return g},uForm3:function(){return m},uForm4:function(){return b},uForm5:function(){return E}});var e={};r.r(e),r.d(e,{calc:function(){return R},calcAll:function(){return k},cleanLinear:function(){return Z},constructFromLinear:function(){return _},constructNested:function(){return z},convFromLinear:function(){return V},decodeVars:function(){return H},encodeVars:function(){return K},expand_reEntry:function(){return T},formMatchesVarList:function(){return nt},getTotalVars:function(){return G},getValidForm:function(){return ot},getVariables:function(){return U},interCalc:function(){return D},interpret:function(){return F},inv_logic:function(){return $},isValidForm:function(){return X},isValidFormula:function(){return tt},isValidJSONForm:function(){return rt},isValidReEntry:function(){return et},jsonString:function(){return C},matchDefaultVarOrder:function(){return Q},parseLinear:function(){return J},reOrderVars:function(){return Y},rel_logic:function(){return B},traverseForm:function(){return W}});var o={};function i(t,e){return t>3||t<0||e>3||e<0?-98:0===t||1===e?e:0===e||1===t||t===e?t:2===t&&3===e||3===t&&2===e?1:-99}function u(...t){if(t.length>1){let e=0;for(const r in t)e=i(e,t[r]);return e}return-97}function s(t){switch(t){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}return-99}function a(t,e){if(e>0){let r=t;for(let t=0;t<e;t++)r=s(r);return r}return s(t)}function p(t,e,r,...n){void 0===t&&(t=!1),void 0===e&&(e=!1);const o=n.length%2==0;let i=0,s=-1,p=!1;o?e&&(p=!0):t||(p=!0);let l=-1;for(let t=0;t<n.length;t++){const e=n[t];if(1==e){l=t;break}if(0==e)i++;else if(2==e||3==e)if(-1==s)s=t;else if(e!=n[s]){l=s;break}}if(i==n.length)return p?3:2;if(l>=0){let t=1;for(let r=l;r<n.length;r++)t=e&&r==n.length-1?u(t,n[r]):a(u(t,n[r]));return t}const c=!t||o||e?1:2;for(let i=n.length*c-1;i>=0;i--){const s=i%n.length;if(2==n[s]||3==n[s]){const l=n.length*c-1-i;if(r&&(e&&l%2==0||!e&&l%2==1))return u(p?3:2,n[s]);{let r=2;!e||o||t||(r=a(r));for(let t=0;t<n.length*c;t++){let o=0;t==i&&(o=2==n[s]?0:a(0)),r=e&&t==n.length-1?u(r,o):a(u(r,o))}let p=2;!e||o||t||(p=a(p));for(let t=0;t<n.length*c;t++){let r=0;t==i&&(r=2==n[s]?1:a(1)),p=e&&t==n.length-1?u(p,r):a(u(p,r))}return v(r,p)}}}return-99}function l(t,e){return u(a(t),e)}function c(t,e){return u(t,a(e))}function f(t,e){return a(l(t,e))}function h(t,e){return a(c(t,e))}function v(t,e){return u(f(t,e),h(t,e))}function y(t,e){return a(v(t,e))}function g(t,e,r=!1){return p(void 0,!1,r,t,e)}function d(t,e,r=!1){return p(void 0,!0,r,t,e)}function m(t,e,r,n,o=!1){return p(!0,t,o,e,r,n)}function w(t,e,r,n,o=!1){return p(!1,t,o,e,r,n)}function b(t,e,r,n,o=!1){return p(void 0,!1,o,t,e,r,n)}function N(t,e,r,n,o=!1){return p(void 0,!0,o,t,e,r,n)}function E(t,e,r,n,o,i,u=!1){return p(!0,t,u,e,r,n,o,i)}function S(t,e,r,n,o,i,u=!1){return p(!1,t,u,e,r,n,o,i)}function O(t,e){for(var r=t+"";r.length<e;)r="0"+r;return r}function A(t){return t.reduce((function(t,e){return t.concat(Array.isArray(e)?A(e):e)}),[])}r.r(o),r.d(o,{calcAll:function(){return ut},constructVmap:function(){return dt},decode:function(){return pt},dnaMatchesForm:function(){return mt},dnaToFORM:function(){return ft},encode:function(){return at},formToDNA:function(){return ct},genRandomDNA:function(){return ht},generateVarNames:function(){return bt},getDNAparts:function(){return At},getVariables:function(){return st},intToDNA:function(){return lt},isValidDNA:function(){return wt},repairDNA:function(){return Ot},totalVarsFromDNA:function(){return St},universe_1:function(){return Nt},universe_n:function(){return Et},vmap:function(){return vt},vmapList:function(){return gt},vmapPerspectives:function(){return yt}});const M=(t,e="(",r=")")=>0===t.length||0===t.split("").reduce(((t,n,o,i)=>{if(n===e)t++;else if(n===r){if(null===t)return NaN;t--}return o===i.length-1&&null===t?0:t}),null),q=(t,e)=>(...r)=>{const n=t(...r);return{cata:t=>n?t.success(n):t.error(e)}},I=(t,e='"',r="‽")=>x(t,e)?t.split(e).filter(((t,e,r)=>e%2==0||e===r.length-1)).join(r):null,x=(t,e='"')=>t.split(e).length%2==1,j=(t,e={open:"{",close:"}"},r=[])=>{const n=t.match(new RegExp(`\\${e.open}[^${e.open}${e.close}]*?\\${e.close}`,"g"));if(!n)return r;const o=n.reduce(((t,e)=>t.replace(e,"•")),t);return j(o,e,[...r,...n])},L={a:"ᴬ",b:"ᴮ",c:"ᵓ",d:"ᴰ",e:"ᴱ",f:"ᵎ",g:"ᴳ",h:"ᴴ",i:"ᴵ",j:"ᴶ",k:"ᴷ",l:"ᴸ",m:"ᴹ",n:"ᴺ",o:"ᴼ",p:"ᴾ",q:"ᴽ",r:"ᴿ",s:"ᵕ",t:"ᵀ",u:"ᵁ",v:"ᵛ",w:"ᵂ",x:"ᵡ",y:"ᵞ",z:"ᵜ",alt:"ᵽ","2r":"ᵳ","2r+1":"ᵲ"},P=((t,e=!1)=>Object.keys(t).reduce(((r,n)=>Object.assign(r,{[t[n]]:e?n:(r[t[n]]||[]).concat(n)})),{}))(L,!0);function R(t){let e=0;const r=ot(t);for(const t in r.space)if("form"===r.space[t].type)e=u(e,R(r.space[t]));else if("const"===r.space[t].type)e=u(e,r.space[t].value);else if("var"===r.space[t].type)isNaN(r.space[t].value)||(e=u(e,r.space[t].value));else if("unclear"===r.space[t].type)e=u(e,r.space[t].value);else if("reEntry"===r.space[t].type){let n=[];const o=r.space[t];for(const t in o.nested)n=[...n,R(o.nested[t])];e=u(e,p(o.nested.length%2==0?void 0:o.reEven,o.lastOpen,o.altInterpretation,...n))}return r.unmarked?e:a(e)}function k(t){const e=ot(t),r=U(e),n=r.length,o={};if(n<1)return o.Result=R(e),o;const i=r.join()+";";for(let t=0;t<4**n;t++){const u=O(t.toString(4),n),s=u.split("").map(((t,e)=>({var:r[e],value:parseInt(t)})));o[i+u]=D(e,s)}return o}function D(t,e){return R(F(t,e))}function F(t,e){const r=ot(t),n=JSON.parse(JSON.stringify(r));return W(n,(function(t){const r=t.space;for(const t in r)if("var"===r[t].type)for(const n in e)if(r[t].symbol===e[n].var){r[t].value=e[n].value;break}})),n}function B(t,e){return typeof t===Array||typeof e===Array?null:i(t,e)}function $(t){return typeof t===Array?null:s(t)}function J(t){const e=V(t);let r=null;try{r=JSON.parse(e)}catch(t){console.log(t)}return r}function V(t){return A(_(Z(t))).join("")}function Z(t){let e="",r=!1,n=!1;for(const o in t){const i=t[o];if("string"!=typeof i)break;'"'!==i||n||(r=!r),"/"!==i||r||(n=!n)," "===i?(r||n)&&(e+=i):e+=i}return e}function _(t){let e=[],r=!0,n=0,o=!1,i=!1;for(const e in t){const u=t[e];if("string"!=typeof u)break;if(!o&&!i)if("("===u){if(0==n&&0!=e)break;n++}else if(")"===u&&(n--,0==n)){if(e==t.length-1){r=!1;break}break}'"'!==u||i||(o=!o),"/"!==u||o||(i=!i)}e=[...e,"  {"],e=[...e,'"type":"form",'],r?e=[...e,'"unmarked":true,']:t=t.slice(1,t.length-1),e=[...e,'"space":['];let u=[""];n=0,o=!1,i=!1;for(const e in t){let r=t[e];const s=t[e-1];if("string"!=typeof r)break;o||i||(")"!==r&&"}"!==r||n--,"("===r||"{"===r?(0===n&&e>0&&(u=[...u,""]),n++):")"!==s&&"}"!==s||")"===r||"}"===r||0===n&&(u=[...u,""]),1===n&&","===r?r="⤵":1===n&&"|"===r?r="⤴":1===n&&"@"===r&&(r="↻")),'"'!==r||i||(o=!o),"/"!==r||o||(i=!i),u[u.length-1]+=r}for(const t in u){if("("===u[t][0]){const e=[_(u[t])];u[t]=e.slice()}else if("{"===u[t][0]){let e=["  {"];e=[...e,'"type":"reEntry",'];const r=u[t].slice(1,u[t].length-1);let n;if(r.includes("↻")){const t=r.startsWith("alt⤴"),o=t?r.slice(4):r.slice();let i=[-1,-1];o.startsWith("..↻._")?i=[3,1]:o.startsWith("..↻.")?i=[3,0]:o.startsWith("..↻_")?i=[2,1]:o.startsWith("..↻")?i=[2,0]:o.startsWith("↻_")?i=[0,1]:o.startsWith("↻")&&(i=[0,0]);const u=i[0]+i[1]+1;n=o.slice(u).split("⤵"),e=n.length%2==0?[...e,'"reEven":"undefined",']:2===i[0]?[...e,'"reEven":true,']:[...e,'"reEven":false,'],e=i[1]>0?[...e,'"lastOpen":true,']:[...e,'"lastOpen":false,'],e=t?[...e,'"altInterpretation":true,']:[...e,'"altInterpretation":false,']}else{const t=r.split("⤴");n=t[t.length-1].split("⤵"),e=n.length%2==0?[...e,'"reEven":"undefined",']:"2r"===t[0]||"2r"===t[1]||"2r"===t[2]?[...e,'"reEven":true,']:[...e,'"reEven":false,'],e="open"===t[0]||"open"===t[1]||"open"===t[2]?[...e,'"lastOpen":true,']:[...e,'"lastOpen":false,'],e="alt"===t[0]||"alt"===t[1]||"alt"===t[2]?[...e,'"altInterpretation":true,']:[...e,'"altInterpretation":false,']}e=[...e,'"nested":['];for(const t in n)e=[...e,_(n[t])],t<n.length-1&&(e=[...e,","]);e=[...e,"]}  "],u[t]=e.slice()}else{let e=[],r=[],n=!1,o=!1;for(const e in u[t]){const i=u[t][e];if("string"!=typeof i)break;'"'!==i||o?"/"!==i||n?(n||o||(r=[...r,""]),r[r.length-1]+='"'===i&&o?"\\"+i:i):(o=!o,o&&(r=[...r,"‽"])):(n=!n,n&&(r=[...r,"‖"]))}for(const t in r){if("string"!=typeof r[t])break;e=[...e,"  {"],!isNaN(r[t])&&r[t].length>0&&"‽"!==r[t][0]&&"‖"!==r[t][0]?(e=[...e,'"type":"const",'],e=[...e,'"value":'],e=[...e,r[t]]):"‽"===r[t][0]?(e=[...e,'"type":"unclear",'],e=[...e,'"value":2,'],e=[...e,'"symbol":'],e=[...e,'"'+r[t].slice(1)+'"']):(e=[...e,'"type":"var",'],e=[...e,'"value":"*",'],e=[...e,'"symbol":'],e="‖"===r[t][0]?[...e,'"'+r[t].slice(1)+'"']:[...e,'"'+r[t]+'"']),e=[...e,"}  "],t<r.length-1&&(e=[...e,","])}u[t]=e.slice()}e=[...e,u[t]],t<u.length-1&&(e=[...e,","])}return e=[...e,"]}  "],e}function z(t,e={}){let r=t.space=[];t.nested.reverse();for(const n in t.nested){if(n>0){r.unshift({type:"form",reChild:!0,space:[]});const e=r[0];t.nested[n].unmarked?e.space.push(...t.nested[n].space):e.space.push(t.nested[n]),r=e.space}else t.nested[n].unmarked?r.push(...t.nested[n].space):r.push(t.nested[n]);e.addEmptyReChildSpace&&0===r.length&&r.push({type:"space"})}let n=t;if(t.space.length>0)for(;Object.prototype.hasOwnProperty.call(n.space[0],"reChild")&&(n=n.space[0],!(n.space.length<1)););return t.lastOpen?(n.space.unshift({type:"form",reChild:!0,space:[]}),n.space[0].space.unshift({type:"reEntryPoint"})):n.space.unshift({type:"reEntryPoint"}),delete t.nested,t}function T(t,e={}){const r=ot(t),n=JSON.parse(JSON.stringify(r));let o=0;return W(r,(function(t){t.runningIndex=o,o++})),o=0,W(n,(function(t){t.runningIndex=o,o++})),W(r,(function(t){"reEntry"===t.type&&W(n,(function(r){if(JSON.stringify(t)===JSON.stringify(r)&&t.runningIndex===(Object.prototype.hasOwnProperty.call(r,"runningIndex")?r.runningIndex:null))return r=z(r,e),!0}))})),W(n,(function(t){delete t.runningIndex})),n}function C(t,e=!1){const r=ot(e?T(t):t);return JSON.stringify(r,void 0,2)}function U(t){const e=ot(t);let r=[];return W(e,(function(t){const e=t.space;for(const t in e)"var"===e[t].type&&(n=r,o=e[t].symbol,-1==n.indexOf(o)&&(r=[...r,e[t].symbol]));var n,o})),r.sort()}function W(t,e){const r=e.apply(this,[t]);if(t.space){if(t.space.length>0)for(const r in t.space)if(("form"===t.space[r].type||"reEntry"===t.space[r].type)&&W(t.space[r],e))break}else if(t.nested){if(t.nested.length>0)for(const r in t.nested)if(W(t.nested[r],e))break}else console.log("ERROR: Not a form!");return r}function G(t){return U(t.substr()).length}function Y(t,e){return H(K(t,e))}function H(t,e){let r=P;if(e){const t=Object.keys(P),n=t.slice(0,e.length),o=t.slice(-3);r=n.concat(o).reduce(((t,r,n)=>({...t,[r]:n<e.length?e[n]:P[r]})),{})}return t.split("").map((t=>Object.keys(r).indexOf(t)>-1?r[t]:t)).join("")}function K(t,e){function r(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}e||(e=U(t));return e.reduce(((t,e,n)=>t.replace(new RegExp("alt(?=|)","g"),L.alt).replace(new RegExp("2r(?=|)","g"),L["2r"]).replace(new RegExp("2r+1(?=|)","g"),L["2r+1"]).replace(new RegExp((t=>t.length>1?`"${r(t)}"`:`${r(t)}`)(e),"g"),Object.keys(P)[n])),t)}function Q(t){return"ELR"===t.join("")?["L","E","R"]:"+-LR"===t.join("")?["-","L","R","+"]:"+-ELR"===t.join("")?["-","L","E","R","+"]:t}function X(t,e){return"string"==typeof t?tt(t):rt()}function tt(t,e){let r=[q((()=>"string"==typeof t),"Formula input is not of type ‘string’")];if(t.length>0&&(r=[...r,q((()=>!!I(t,'"')&&!!I(t,"/")),'Number of quotes for literal variables (e.g.: "x") or number of slashes for unclear FORMs (e.g.: /x/) don\'t match')]),r.every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))),t.length>0){const e=I(I(t,'"'),"/");[q((()=>M(e,"(",")")),"Number or opening/closing order of parantheses in formula don't match"),q((()=>M(e,"{","}")),"Number or opening/closing order of curly brackets in formula don't match")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})));const r=j(e,{open:"(",close:")"}),n=j(e,{open:"{",close:"}"});[q((()=>r.every((t=>M(t,"{","}")))&&n.every((t=>M(t,"(",")")))),"Opening/closing of parantheses overlaps with opening/closing of curly brackets in formula (e.g.: ({a)b})"),q((()=>n.every((t=>et(t)))),"Option part of one or more re-entry constructions is not well-formed")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}return!0}function et(t,e){const r=t.slice(1,-1).split("|");if(r.length>1){const t=r.filter(((t,e,r)=>e<r.length-1)),e=["alt","open","2r","2r+1"],n=t.reduce(((t,r)=>[...t,e.filter((t=>r===t))[0]]),[]).filter((t=>t)),o=[...new Set(n)];return[q((()=>o.length===t.length),"One or more re-entry constructions have invalid or duplicate options"),q((()=>o.filter((t=>t===e[2]||t===e[3])).length<2),"One or more re-entry constructions have both options ‘2r’ and ‘2r+1’ set at the same time")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}return!0}function rt(t,e){return[q((()=>!0),"")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}function nt(t,e){const r=U(t);if(e.length!==r.length||!r.every((t=>e.some((e=>t===e)))))throw new Error("FORM doesn't match the given variable list");return!0}function ot(t){if("string"==typeof t){if(!tt(t))throw new Error("Input is not a valid formula");return J(t)}return t}var it=r(736);function ut(t){if(t.includes("::")&&wt(t)){const e=t.split(":").pop(),r=e.split("").reverse(),n=St(e),o=Array.from({length:n},((t,e)=>`"x_${e}"`)),i={};if(n<1)return i.Result=parseInt(r[0]),i;const u=o.join()+";";for(let t=0;t<r.length;t++)i[u+O(t.toString(4),n)]=r[t];return i}return k(t)}function st(t){if("string"==typeof t&&t.includes("::")){const{dna:e,formula:r,varList:n}=At(t);if(void 0!==n)return n;if(void 0!==r)return U(r);const o=St(e);return Array.from({length:o},((t,e)=>`x_${e}`))}return U(t)}function at(t,e){const r=e?Y(t,e):t;return Object.values(ut(r)).reverse().join("")}function pt(t,e){if(e&&e.length!==St(t))throw new Error("Number of variables in given variable list doesn't match formDNA code length");e||(e=bt(St(t)));const r=Et(e),n=t.split("").reverse();return r.map(((t,e)=>`((${n[e]})(${t}))`)).join("")}function lt(t,e){const r=t.toString(4);if("-"===r.substr(0,1))throw new Error("Negative integers cannot be converted to formDNA.");if(r.includes("."))throw new Error("Fractional numbers cannot be converted to formDNA.");const n=e?4**e:function t(e,r=0){return 4**r>=e?4**r:t(e,r+1)}(r.length);if(r.length>n)throw new Error("Integer size exceeds desired DNA length.");return O(r,n)}function ct(t,e,r){const{output:n}={output:void 0,...r};let o,i,u;if(t.includes("::")){if(!wt(t))throw new Error("Input is not valid formDNA");const e=At(t);o=e.dna,i=e.formula,u=e.varList}else o=at(t,e||void 0),i=t,u=e||st(i);switch(n){case"text":return(void 0!==i?i:"")+(u&&o.length>1?`.[${u.join(",")}]`:"")+"::"+o;case"num":return o;default:return[i,u,o]}}function ft(t,e,r){return pt(t,e)}function ht(t){var e;return lt((e=it(4).pow(it(4).pow(t)).subtract(1),it.randBetween(0,e)),t)}function vt(t,e,r){const{limitSize:n,convDefaultVarorder:o,size:i,gapGrow:u,marginFunc:s,strokeW:a}={limitSize:!0,convDefaultVarorder:!0,size:void 0,gapGrow:1.5,marginFunc:void 0,strokeW:.5,...r};let p,l=t;if(t.includes("::")&&wt(t)){const r=At(t);p=r.dna,l=r.formula;const n=r.varList?r.varList:st(t);if(void 0!==e&&void 0!==n&&(f=n,void 0===(c=e)||void 0===f||c.length!==f.length||!c.every((t=>f.some((e=>t===e))))))throw new Error("Variable order is specified in the formDNA input and as an argument for the vmap function and they are different. Please select only one specification to avoid conflicting results.");n?e=n:l&&(e=st(l))}else e||(e=st(l),o&&(e=Q(e)));var c,f;p||(p=at(l,e));const h=St(p);if(isNaN(h))throw new Error("Invalid variable number for vmaps.");if(n&&h>8)throw new Error('vmaps with more than 8 variables are too computationally intensive to be rendered with this implementation. If you still want to proceed, add the option "limitSize: false" to your vmap function call (using the formform library).');const v=p.split("").reverse().join(""),y=i||(t=>{const e=17-(t>3?2*(t-3):0);return Math.max(2,e)})(h);return{tree:dt(v,h,{w:y,h:y},[a,...Array.from({length:h-1},s||((t,e)=>(e+1)*u))]),input:t,varorder:e,options:r}}function yt(t,e,r,n){const{limitSize:o}={limitSize:!0,...r};if("string"==typeof t&&t.includes("::"))throw new Error("formDNA input is not yet supported for vmap perspectives.");void 0===e&&(e=Q(st(t)));const i=e.length;if(o&&i>5)throw new Error('Rendering all the perspectives for vmaps with more than 5 variables is too computationally intensive with this implementation. You can, however, still compute single permutations by changing the variable order of your FORM. If you still want to proceed, add the option "limitSize: false" to your vmapPerspectives function call (using the formform library).');const u=t;var s;return(s=e,s.reduce((function t(e,r,n,o){return e.concat(o.length>1&&o.slice(0,n).concat(o.slice(n+1)).reduce(t,[]).map((function(t){return[r].concat(t)}))||[[r]])}),[])).map((t=>vt(u,t,{hideInputLabel:!0,customLabel:void 0,...n})))}function gt(t,e){return t.map((t=>vt(t[0],t[1],{...t[2],...e})))}function dt(t,e,r,n){const o=(t,e)=>t%2*(void 0!==e?e:0),i=(t,e)=>+(t>0&&t<3)*(void 0!==e?e:0),u=(t,r,n,s,a=0)=>{const p={},l=((t,e)=>e.slice(1,t).reverse().reduce(((t,e,r)=>t+2**r*e),0))(r,s),c=4**r,f=Math.sqrt(c);if(t=t.substr(a*c,c),p.data={dna:"::"+t.split("").reverse().join(""),vnum:r,cell:n,margins:e>0?s.slice(0,r):s.slice(0,1)},p.height=r,p.depth=e-Math.log(c)/Math.log(4),p.order=a,p.position=[o(a,f*n.w)+o(a,l)+o(a,s[r]),i(a,f*n.h)+i(a,l)+i(a,s[r])],p.scale=[f*n.w+l,f*n.h+l],0===e)return p.value=t,p;p.children=[];for(let e=0;r>0&&e<4||0===r&&e<1;e++)if(r>1)p.children=[...p.children,u(t,r-1,n,s,e)];else{const u=t.substr(e,1);p.children=[...p.children,{data:{dna:"::"+u,vnum:0,cell:n,margins:s.slice(0,1)},value:u,height:r-1,depth:p.depth+1,order:e,position:[o(e,n.w),i(e,n.h)],scale:[n.w,n.h]}]}return p};return u(t,e,r,n)}function mt(t,e,r,n){const o=r||U(e);return(r?[q((()=>nt(e,o)),"FORM doesn't match the given variable list"),q((()=>o.length===St(t)),"Number of variables in given variable list doesn't match formDNA code length"),q((()=>at(e,o)===t),"formDNA code is inconsistent with FORM interpretation results (respecting specified variable order)")]:[q((()=>o&&o.length===St(t)),"Number of FORM variables doesn't match formDNA code length"),q((()=>at(e)===t),"formDNA code is inconsistent with FORM interpretation results")]).every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}function wt(t,e){const{compareForm:r,requireMark:n}={compareForm:!0,requireMark:!0,...e},o=n?t:"::"+t;[q((()=>"string"==typeof o),"formDNA input is not of type ‘string’"),q((()=>o.includes("::")),"Input does not include the mark ‘::’ for formDNA"),q((()=>o.length>=3),"formDNA input is too short")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})));const{dna:i,formula:u,varList:s}=At(o);return[q((()=>St(i)>=0),"formDNA code length is not in the range 4^x"),q((()=>!i.split("").some((t=>isNaN(parseInt(t))||parseInt(t)<0||parseInt(t)>3))),"formDNA code is not in quaternion format (consisting only of the numbers 0/1/2/3)"),r&&void 0!==u?q((()=>mt(i,u,s)),"formDNA code part doesn't match formula part or formula part doesn't match its specified variable order"):null].filter((t=>t)).every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))),!0}function bt(t,e){return Array.from({length:t},((t,r)=>{let n=`x_${r}`;if(void 0!==e)for(;e.includes(n);)n+="′";return n}))}function Nt(t){return t.length>1&&(t=`"${t}"`),[`({(${t})}{2r|(${t})})`,`({${t}}{2r|${t}})`,`(({(${t})}${t})({2r|${t}}(${t})))`,`(({${t}}(${t}))({2r|(${t})}${t}))`]}function Et(t){const e=t.length,r=t.map((t=>Nt(t)));return Array.from({length:4**e},((t,n)=>{const o=O(n.toString(4),e).split(""),i=r.reduce(((t,e,r,n)=>t+`(${e[o[r]]})`+(r===n.length-1?")":"")),"(");return e>1?i:i.slice(2,-2)}))}function St(t){const e=t.split(":").pop(),r=Math.log(e.length)/Math.log(4);return r%1==0?r:NaN}function Ot(t){if(t.includes("::")){const e=At(t);if(e.formula){let t;try{e.varList&&nt(e.formula,e.varList)&&(t=e.varList)}catch(t){console.error(t.message)}return ct(e.formula,t)}return wt(t)?t:null}return ct(t)}function At(t){let e,r,n;const o=t.split(":");if(e=o.pop(),o[0].length>0){const t=o[0].split(".");r=t[0],n=t.length>1?t[1].slice(1,-1).split(","):n}return{dna:e,formula:r,varList:n}}var Mt={calc:t,form:e,dna:o}}(),n.default}()}));
//# sourceMappingURL=formform.min.js.map