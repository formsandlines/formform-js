!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.formform=e(require("d3")):t.formform=e(t.d3)}(window,(function(t){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(e,r){e.exports=t},function(t,e,r){(function(t){var i,n=function(t){"use strict";var e=1e7,r=9007199254740992,i=c(r),s="function"==typeof BigInt;function a(t,e,r,i){return void 0===t?a[0]:void 0!==e&&(10!=+e||r)?L(t,e,r,i):_(t)}function o(t,e){this.value=t,this.sign=e,this.isSmall=!1}function l(t){this.value=t,this.sign=t<0,this.isSmall=!0}function h(t){this.value=t}function u(t){return-r<t&&t<r}function c(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function f(t){p(t);var r=t.length;if(r<4&&M(t,i)<0)switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function p(t){for(var e=t.length;0===t[--e];);t.length=e+1}function d(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function y(t){return t>0?Math.floor(t):Math.ceil(t)}function m(t,r){var i,n,s=t.length,a=r.length,o=new Array(s),l=0,h=e;for(n=0;n<a;n++)l=(i=t[n]+r[n]+l)>=h?1:0,o[n]=i-l*h;for(;n<s;)l=(i=t[n]+l)===h?1:0,o[n++]=i-l*h;return l>0&&o.push(l),o}function g(t,e){return t.length>=e.length?m(t,e):m(e,t)}function v(t,r){var i,n,s=t.length,a=new Array(s),o=e;for(n=0;n<s;n++)i=t[n]-o+r,r=Math.floor(i/o),a[n]=i-r*o,r+=1;for(;r>0;)a[n++]=r%o,r=Math.floor(r/o);return a}function b(t,e){var r,i,n=t.length,s=e.length,a=new Array(n),o=0;for(r=0;r<s;r++)(i=t[r]-o-e[r])<0?(i+=1e7,o=1):o=0,a[r]=i;for(r=s;r<n;r++){if(!((i=t[r]-o)<0)){a[r++]=i;break}i+=1e7,a[r]=i}for(;r<n;r++)a[r]=t[r];return p(a),a}function x(t,e,r){var i,n,s=t.length,a=new Array(s),h=-e;for(i=0;i<s;i++)n=t[i]+h,h=Math.floor(n/1e7),n%=1e7,a[i]=n<0?n+1e7:n;return"number"==typeof(a=f(a))?(r&&(a=-a),new l(a)):new o(a,r)}function w(t,e){var r,i,n,s,a=t.length,o=e.length,l=d(a+o);for(n=0;n<a;++n){s=t[n];for(var h=0;h<o;++h)r=s*e[h]+l[n+h],i=Math.floor(r/1e7),l[n+h]=r-1e7*i,l[n+h+1]+=i}return p(l),l}function E(t,r){var i,n,s=t.length,a=new Array(s),o=e,l=0;for(n=0;n<s;n++)i=t[n]*r+l,l=Math.floor(i/o),a[n]=i-l*o;for(;l>0;)a[n++]=l%o,l=Math.floor(l/o);return a}function P(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function S(t,r,i){return new o(t<e?E(r,t):w(r,c(t)),i)}function k(t){var e,r,i,n,s=t.length,a=d(s+s);for(i=0;i<s;i++){r=0-(n=t[i])*n;for(var o=i;o<s;o++)e=n*t[o]*2+a[i+o]+r,r=Math.floor(e/1e7),a[i+o]=e-1e7*r;a[i+s]=r}return p(a),a}function C(t,e){var r,i,n,s,a=t.length,o=d(a);for(n=0,r=a-1;r>=0;--r)n=(s=1e7*n+t[r])-(i=y(s/e))*e,o[r]=0|i;return[o,0|n]}function B(t,r){var i,n=_(r);if(s)return[new h(t.value/n.value),new h(t.value%n.value)];var u,m=t.value,g=n.value;if(0===g)throw new Error("Cannot divide by zero");if(t.isSmall)return n.isSmall?[new l(y(m/g)),new l(m%g)]:[a[0],t];if(n.isSmall){if(1===g)return[t,a[0]];if(-1==g)return[t.negate(),a[0]];var v=Math.abs(g);if(v<e){u=f((i=C(m,v))[0]);var x=i[1];return t.sign&&(x=-x),"number"==typeof u?(t.sign!==n.sign&&(u=-u),[new l(u),new l(x)]):[new o(u,t.sign!==n.sign),new l(x)]}g=c(v)}var w=M(m,g);if(-1===w)return[a[0],t];if(0===w)return[a[t.sign===n.sign?1:-1],a[0]];u=(i=m.length+g.length<=200?function(t,r){var i,n,s,a,o,l,h,u=t.length,c=r.length,p=e,y=d(r.length),m=r[c-1],g=Math.ceil(p/(2*m)),v=E(t,g),b=E(r,g);for(v.length<=u&&v.push(0),b.push(0),m=b[c-1],n=u-c;n>=0;n--){for(i=p-1,v[n+c]!==m&&(i=Math.floor((v[n+c]*p+v[n+c-1])/m)),s=0,a=0,l=b.length,o=0;o<l;o++)s+=i*b[o],h=Math.floor(s/p),a+=v[n+o]-(s-h*p),s=h,a<0?(v[n+o]=a+p,a=-1):(v[n+o]=a,a=0);for(;0!==a;){for(i-=1,s=0,o=0;o<l;o++)(s+=v[n+o]-p+b[o])<0?(v[n+o]=s+p,s=0):(v[n+o]=s,s=1);a+=s}y[n]=i}return v=C(v,g)[0],[f(y),f(v)]}(m,g):function(t,e){for(var r,i,n,s,a,o=t.length,l=e.length,h=[],u=[];o;)if(u.unshift(t[--o]),p(u),M(u,e)<0)h.push(0);else{n=1e7*u[(i=u.length)-1]+u[i-2],s=1e7*e[l-1]+e[l-2],i>l&&(n=1e7*(n+1)),r=Math.ceil(n/s);do{if(M(a=E(e,r),u)<=0)break;r--}while(r);h.push(r),u=b(u,a)}return h.reverse(),[f(h),f(u)]}(m,g))[0];var P=t.sign!==n.sign,S=i[1],k=t.sign;return"number"==typeof u?(P&&(u=-u),u=new l(u)):u=new o(u,P),"number"==typeof S?(k&&(S=-S),S=new l(S)):S=new o(S,k),[u,S]}function M(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function V(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function A(t,e){for(var r,i,s,a=t.prev(),o=a,l=0;o.isEven();)o=o.divide(2),l++;t:for(i=0;i<e.length;i++)if(!t.lesser(e[i])&&!(s=n(e[i]).modPow(o,t)).isUnit()&&!s.equals(a)){for(r=l-1;0!=r;r--){if((s=s.square().mod(t)).isUnit())return!1;if(s.equals(a))continue t}return!1}return!0}o.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),h.prototype=Object.create(a.prototype),o.prototype.add=function(t){var e=_(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,i=e.value;return e.isSmall?new o(v(r,Math.abs(i)),this.sign):new o(g(r,i),this.sign)},o.prototype.plus=o.prototype.add,l.prototype.add=function(t){var e=_(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var i=e.value;if(e.isSmall){if(u(r+i))return new l(r+i);i=c(Math.abs(i))}return new o(v(i,Math.abs(r)),r<0)},l.prototype.plus=l.prototype.add,h.prototype.add=function(t){return new h(this.value+_(t).value)},h.prototype.plus=h.prototype.add,o.prototype.subtract=function(t){var e=_(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,i=e.value;return e.isSmall?x(r,Math.abs(i),this.sign):function(t,e,r){var i;return M(t,e)>=0?i=b(t,e):(i=b(e,t),r=!r),"number"==typeof(i=f(i))?(r&&(i=-i),new l(i)):new o(i,r)}(r,i,this.sign)},o.prototype.minus=o.prototype.subtract,l.prototype.subtract=function(t){var e=_(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var i=e.value;return e.isSmall?new l(r-i):x(i,Math.abs(r),r>=0)},l.prototype.minus=l.prototype.subtract,h.prototype.subtract=function(t){return new h(this.value-_(t).value)},h.prototype.minus=h.prototype.subtract,o.prototype.negate=function(){return new o(this.value,!this.sign)},l.prototype.negate=function(){var t=this.sign,e=new l(-this.value);return e.sign=!t,e},h.prototype.negate=function(){return new h(-this.value)},o.prototype.abs=function(){return new o(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},h.prototype.abs=function(){return new h(this.value>=0?this.value:-this.value)},o.prototype.multiply=function(t){var r,i,n,s=_(t),l=this.value,h=s.value,u=this.sign!==s.sign;if(s.isSmall){if(0===h)return a[0];if(1===h)return this;if(-1===h)return this.negate();if((r=Math.abs(h))<e)return new o(E(l,r),u);h=c(r)}return i=l.length,n=h.length,new o(-.012*i-.012*n+15e-6*i*n>0?function t(e,r){var i=Math.max(e.length,r.length);if(i<=30)return w(e,r);i=Math.ceil(i/2);var n=e.slice(i),s=e.slice(0,i),a=r.slice(i),o=r.slice(0,i),l=t(s,o),h=t(n,a),u=t(g(s,n),g(o,a)),c=g(g(l,P(b(b(u,l),h),i)),P(h,2*i));return p(c),c}(l,h):w(l,h),u)},o.prototype.times=o.prototype.multiply,l.prototype._multiplyBySmall=function(t){return u(t.value*this.value)?new l(t.value*this.value):S(Math.abs(t.value),c(Math.abs(this.value)),this.sign!==t.sign)},o.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():S(Math.abs(t.value),this.value,this.sign!==t.sign)},l.prototype.multiply=function(t){return _(t)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,h.prototype.multiply=function(t){return new h(this.value*_(t).value)},h.prototype.times=h.prototype.multiply,o.prototype.square=function(){return new o(k(this.value),!1)},l.prototype.square=function(){var t=this.value*this.value;return u(t)?new l(t):new o(k(c(Math.abs(this.value))),!1)},h.prototype.square=function(t){return new h(this.value*this.value)},o.prototype.divmod=function(t){var e=B(this,t);return{quotient:e[0],remainder:e[1]}},h.prototype.divmod=l.prototype.divmod=o.prototype.divmod,o.prototype.divide=function(t){return B(this,t)[0]},h.prototype.over=h.prototype.divide=function(t){return new h(this.value/_(t).value)},l.prototype.over=l.prototype.divide=o.prototype.over=o.prototype.divide,o.prototype.mod=function(t){return B(this,t)[1]},h.prototype.mod=h.prototype.remainder=function(t){return new h(this.value%_(t).value)},l.prototype.remainder=l.prototype.mod=o.prototype.remainder=o.prototype.mod,o.prototype.pow=function(t){var e,r,i,n=_(t),s=this.value,o=n.value;if(0===o)return a[1];if(0===s)return a[0];if(1===s)return a[1];if(-1===s)return n.isEven()?a[1]:a[-1];if(n.sign)return a[0];if(!n.isSmall)throw new Error("The exponent "+n.toString()+" is too large.");if(this.isSmall&&u(e=Math.pow(s,o)))return new l(y(e));for(r=this,i=a[1];!0&o&&(i=i.times(r),--o),0!==o;)o/=2,r=r.square();return i},l.prototype.pow=o.prototype.pow,h.prototype.pow=function(t){var e=_(t),r=this.value,i=e.value,n=BigInt(0),s=BigInt(1),o=BigInt(2);if(i===n)return a[1];if(r===n)return a[0];if(r===s)return a[1];if(r===BigInt(-1))return e.isEven()?a[1]:a[-1];if(e.isNegative())return new h(n);for(var l=this,u=a[1];(i&s)===s&&(u=u.times(l),--i),i!==n;)i/=o,l=l.square();return u},o.prototype.modPow=function(t,e){if(t=_(t),(e=_(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=a[1],i=this.mod(e);for(t.isNegative()&&(t=t.multiply(a[-1]),i=i.modInv(e));t.isPositive();){if(i.isZero())return a[0];t.isOdd()&&(r=r.multiply(i).mod(e)),t=t.divide(2),i=i.square().mod(e)}return r},h.prototype.modPow=l.prototype.modPow=o.prototype.modPow,o.prototype.compareAbs=function(t){var e=_(t),r=this.value,i=e.value;return e.isSmall?1:M(r,i)},l.prototype.compareAbs=function(t){var e=_(t),r=Math.abs(this.value),i=e.value;return e.isSmall?r===(i=Math.abs(i))?0:r>i?1:-1:-1},h.prototype.compareAbs=function(t){var e=this.value,r=_(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},o.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=_(t),r=this.value,i=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:M(r,i)*(this.sign?-1:1)},o.prototype.compareTo=o.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=_(t),r=this.value,i=e.value;return e.isSmall?r==i?0:r>i?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},l.prototype.compareTo=l.prototype.compare,h.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,r=_(t).value;return e===r?0:e>r?1:-1},h.prototype.compareTo=h.prototype.compare,o.prototype.equals=function(t){return 0===this.compare(t)},h.prototype.eq=h.prototype.equals=l.prototype.eq=l.prototype.equals=o.prototype.eq=o.prototype.equals,o.prototype.notEquals=function(t){return 0!==this.compare(t)},h.prototype.neq=h.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=o.prototype.neq=o.prototype.notEquals,o.prototype.greater=function(t){return this.compare(t)>0},h.prototype.gt=h.prototype.greater=l.prototype.gt=l.prototype.greater=o.prototype.gt=o.prototype.greater,o.prototype.lesser=function(t){return this.compare(t)<0},h.prototype.lt=h.prototype.lesser=l.prototype.lt=l.prototype.lesser=o.prototype.lt=o.prototype.lesser,o.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},h.prototype.geq=h.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=o.prototype.geq=o.prototype.greaterOrEquals,o.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},h.prototype.leq=h.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=o.prototype.leq=o.prototype.lesserOrEquals,o.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},h.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},o.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},h.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},o.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},h.prototype.isPositive=l.prototype.isPositive,o.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},h.prototype.isNegative=l.prototype.isNegative,o.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},h.prototype.isUnit=function(){return this.abs().value===BigInt(1)},o.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},h.prototype.isZero=function(){return this.value===BigInt(0)},o.prototype.isDivisibleBy=function(t){var e=_(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},h.prototype.isDivisibleBy=l.prototype.isDivisibleBy=o.prototype.isDivisibleBy,o.prototype.isPrime=function(t){var e=V(this);if(void 0!==e)return e;var r=this.abs(),i=r.bitLength();if(i<=64)return A(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var s=Math.log(2)*i.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(s,2):s),o=[],l=0;l<a;l++)o.push(n(l+2));return A(r,o)},h.prototype.isPrime=l.prototype.isPrime=o.prototype.isPrime,o.prototype.isProbablePrime=function(t,e){var r=V(this);if(void 0!==r)return r;for(var i=this.abs(),s=void 0===t?5:t,a=[],o=0;o<s;o++)a.push(n.randBetween(2,i.minus(2),e));return A(i,a)},h.prototype.isProbablePrime=l.prototype.isProbablePrime=o.prototype.isProbablePrime,o.prototype.modInv=function(t){for(var e,r,i,s=n.zero,a=n.one,o=_(t),l=this.abs();!l.isZero();)e=o.divide(l),r=s,i=o,s=a,o=l,a=r.subtract(e.multiply(a)),l=i.subtract(e.multiply(l));if(!o.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(t)),this.isNegative()?s.negate():s},h.prototype.modInv=l.prototype.modInv=o.prototype.modInv,o.prototype.next=function(){var t=this.value;return this.sign?x(t,1,this.sign):new o(v(t,1),this.sign)},l.prototype.next=function(){var t=this.value;return t+1<r?new l(t+1):new o(i,!1)},h.prototype.next=function(){return new h(this.value+BigInt(1))},o.prototype.prev=function(){var t=this.value;return this.sign?new o(v(t,1),!0):x(t,1,this.sign)},l.prototype.prev=function(){var t=this.value;return t-1>-r?new l(t-1):new o(i,!0)},h.prototype.prev=function(){return new h(this.value-BigInt(1))};for(var N=[1];2*N[N.length-1]<=e;)N.push(2*N[N.length-1]);var T=N.length,O=N[T-1];function D(t){return Math.abs(t)<=e}function z(t,e,r){e=_(e);for(var i=t.isNegative(),s=e.isNegative(),a=i?t.not():t,o=s?e.not():e,l=0,h=0,u=null,c=null,f=[];!a.isZero()||!o.isZero();)l=(u=B(a,O))[1].toJSNumber(),i&&(l=O-1-l),h=(c=B(o,O))[1].toJSNumber(),s&&(h=O-1-h),a=u[0],o=c[0],f.push(r(l,h));for(var p=0!==r(i?1:0,s?1:0)?n(-1):n(0),d=f.length-1;d>=0;d-=1)p=p.multiply(O).add(n(f[d]));return p}o.prototype.shiftLeft=function(t){var e=_(t).toJSNumber();if(!D(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=T;)r=r.multiply(O),e-=T-1;return r.multiply(N[e])},h.prototype.shiftLeft=l.prototype.shiftLeft=o.prototype.shiftLeft,o.prototype.shiftRight=function(t){var e,r=_(t).toJSNumber();if(!D(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var i=this;r>=T;){if(i.isZero()||i.isNegative()&&i.isUnit())return i;i=(e=B(i,O))[1].isNegative()?e[0].prev():e[0],r-=T-1}return(e=B(i,N[r]))[1].isNegative()?e[0].prev():e[0]},h.prototype.shiftRight=l.prototype.shiftRight=o.prototype.shiftRight,o.prototype.not=function(){return this.negate().prev()},h.prototype.not=l.prototype.not=o.prototype.not,o.prototype.and=function(t){return z(this,t,(function(t,e){return t&e}))},h.prototype.and=l.prototype.and=o.prototype.and,o.prototype.or=function(t){return z(this,t,(function(t,e){return t|e}))},h.prototype.or=l.prototype.or=o.prototype.or,o.prototype.xor=function(t){return z(this,t,(function(t,e){return t^e}))},h.prototype.xor=l.prototype.xor=o.prototype.xor;function I(t){var r=t.value,i="number"==typeof r?r|1<<30:"bigint"==typeof r?r|BigInt(1<<30):r[0]+r[1]*e|1073758208;return i&-i}function R(t,e){return t=_(t),e=_(e),t.greater(e)?t:e}function F(t,e){return t=_(t),e=_(e),t.lesser(e)?t:e}function $(t,e){if(t=_(t).abs(),e=_(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,i,n=a[1];t.isEven()&&e.isEven();)r=F(I(t),I(e)),t=t.divide(r),e=e.divide(r),n=n.multiply(r);for(;t.isEven();)t=t.divide(I(t));do{for(;e.isEven();)e=e.divide(I(e));t.greater(e)&&(i=e,e=t,t=i),e=e.subtract(t)}while(!e.isZero());return n.isUnit()?t:t.multiply(n)}o.prototype.bitLength=function(){var t=this;return t.compareTo(n(0))<0&&(t=t.negate().subtract(n(1))),0===t.compareTo(n(0))?n(0):n(function t(e,r){if(r.compareTo(e)<=0){var i=t(e,r.square(r)),s=i.p,a=i.e,o=s.multiply(r);return o.compareTo(e)<=0?{p:o,e:2*a+1}:{p:s,e:2*a}}return{p:n(1),e:0}}(t,n(2)).e).add(n(1))},h.prototype.bitLength=l.prototype.bitLength=o.prototype.bitLength;var L=function(t,e,r,i){r=r||"0123456789abcdefghijklmnopqrstuvwxyz",t=String(t),i||(t=t.toLowerCase(),r=r.toLowerCase());var n,s=t.length,a=Math.abs(e),o={};for(n=0;n<r.length;n++)o[r[n]]=n;for(n=0;n<s;n++){if("-"!==(u=t[n])&&(u in o&&o[u]>=a)){if("1"===u&&1===a)continue;throw new Error(u+" is not a valid digit in base "+e+".")}}e=_(e);var l=[],h="-"===t[0];for(n=h?1:0;n<t.length;n++){var u;if((u=t[n])in o)l.push(_(o[u]));else{if("<"!==u)throw new Error(u+" is not a valid character");var c=n;do{n++}while(">"!==t[n]&&n<t.length);l.push(_(t.slice(c+1,n)))}}return q(l,e,h)};function q(t,e,r){var i,n=a[0],s=a[1];for(i=t.length-1;i>=0;i--)n=n.add(t[i].times(s)),s=s.times(e);return r?n.negate():n}function j(t,e){if((e=n(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var i=!1;if(t.isNegative()&&e.isPositive()&&(i=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:i};for(var s,a=[],o=t;o.isNegative()||o.compareAbs(e)>=0;){s=o.divmod(e),o=s.quotient;var l=s.remainder;l.isNegative()&&(l=e.minus(l).abs(),o=o.next()),a.push(l.toJSNumber())}return a.push(o.toJSNumber()),{value:a.reverse(),isNegative:i}}function X(t,e,r){var i=j(t,e);return(i.isNegative?"-":"")+i.value.map((function(t){return function(t,e){return t<(e=e||"0123456789abcdefghijklmnopqrstuvwxyz").length?e[t]:"<"+t+">"}(t,r)})).join("")}function W(t){if(u(+t)){var e=+t;if(e===y(e))return s?new h(BigInt(e)):new l(e);throw new Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var i=t.split(/e/i);if(i.length>2)throw new Error("Invalid integer: "+i.join("e"));if(2===i.length){var n=i[1];if("+"===n[0]&&(n=n.slice(1)),(n=+n)!==y(n)||!u(n))throw new Error("Invalid integer: "+n+" is not a valid exponent.");var a=i[0],c=a.indexOf(".");if(c>=0&&(n-=a.length-c-1,a=a.slice(0,c)+a.slice(c+1)),n<0)throw new Error("Cannot include negative exponent part for integers");t=a+=new Array(n+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(s)return new h(BigInt(r?"-"+t:t));for(var f=[],d=t.length,m=d-7;d>0;)f.push(+t.slice(m,d)),(m-=7)<0&&(m=0),d-=7;return p(f),new o(f,r)}function _(t){return"number"==typeof t?function(t){if(s)return new h(BigInt(t));if(u(t)){if(t!==y(t))throw new Error(t+" is not an integer.");return new l(t)}return W(t.toString())}(t):"string"==typeof t?W(t):"bigint"==typeof t?new h(t):t}o.prototype.toArray=function(t){return j(this,t)},l.prototype.toArray=function(t){return j(this,t)},h.prototype.toArray=function(t){return j(this,t)},o.prototype.toString=function(t,e){if(void 0===t&&(t=10),10!==t)return X(this,t,e);for(var r,i=this.value,n=i.length,s=String(i[--n]);--n>=0;)r=String(i[n]),s+="0000000".slice(r.length)+r;return(this.sign?"-":"")+s},l.prototype.toString=function(t,e){return void 0===t&&(t=10),10!=t?X(this,t,e):String(this.value)},h.prototype.toString=l.prototype.toString,h.prototype.toJSON=o.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},o.prototype.valueOf=function(){return parseInt(this.toString(),10)},o.prototype.toJSNumber=o.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,h.prototype.valueOf=h.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var G=0;G<1e3;G++)a[G]=_(G),G>0&&(a[-G]=_(-G));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=R,a.min=F,a.gcd=$,a.lcm=function(t,e){return t=_(t).abs(),e=_(e).abs(),t.divide($(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof o||t instanceof l||t instanceof h},a.randBetween=function(t,r,i){t=_(t),r=_(r);var n=i||Math.random,s=F(t,r),o=R(t,r).subtract(s).add(1);if(o.isSmall)return s.add(Math.floor(n()*o));for(var l=j(o,e).value,h=[],u=!0,c=0;c<l.length;c++){var f=u?l[c]:e,p=y(n()*f);h.push(p),p<f&&(u=!1)}return s.add(a.fromArray(h,e,!1))},a.fromArray=function(t,e,r){return q(t.map(_),_(e||10),r)},a}();t.hasOwnProperty("exports")&&(t.exports=n),void 0===(i=function(){return n}.call(e,r,e,t))||(t.exports=i)}).call(this,r(6)(t))},function(t,e,r){t.exports=function(t,e){"use strict";var r;return t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,function(r){var i;function n(){return document.createElement("canvas")}r.exports,(i=window).DOMParser=window.DOMParser;var s,a=function(r,o,l){if(null!=r||null!=o||null!=l){var h=function(r){var a={opts:r,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,rootEmSize:12,emSize:12,log:function(t){}};1==a.opts.log&&"undefined"!=typeof console&&(a.log=function(t){console.log(t)}),a.init=function(t){var e=0;a.UniqueId=function(){return"canvg"+ ++e},a.Definitions={},a.Styles={},a.StylesSpecificity={},a.Animations=[],a.Images=[],a.ctx=t,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var t=0;t<a.Images.length;t++)if(!a.Images[t].loaded)return!1;return!0},a.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(t){return t.replace(/(?!\u3000)\s+/gm," ")},a.ajax=function(t){var e;return(e=i.XMLHttpRequest?new i.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(e.open("GET",t,!1),e.send(null),e.responseText):null},a.parseXml=function(t){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,n=new Windows.Data.Xml.Dom.XmlLoadSettings;return n.prohibitDtd=!1,e.loadXml(t,n),e}if(!i.DOMParser)return t=t.replace(/<!DOCTYPE svg[^>]*>/,""),(e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t),e;try{var s=r.xmldom?new i.DOMParser(r.xmldom):new i.DOMParser;return s.parseFromString(t,"image/svg+xml")}catch(e){return(s=r.xmldom?new i.DOMParser(r.xmldom):new i.DOMParser).parseFromString(t,"text/xml")}},a.Property=function(t,e){this.name=t,this.value=e},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},a.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},a.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},a.Property.prototype.addOpacity=function(e){var r=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var i=new t(this.value);i.ok&&(r="rgba("+i.r+", "+i.g+", "+i.b+", "+e.numValue()+")")}return new a.Property(this.name,r)},a.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),a.Definitions[t]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(t,e){var r=this.getDefinition();if(null!=r&&r.createGradient)return r.createGradient(a.ctx,t,e);if(null!=r&&r.createPattern){if(r.getHrefAttribute().hasValue()){var i=r.attribute("patternTransform");r=r.getHrefAttribute().getDefinition(),i.hasValue()&&(r.attribute("patternTransform",!0).value=i.value)}return r.createPattern(a.ctx,t)}return null},a.Property.prototype.getDPI=function(t){return 96},a.Property.prototype.getREM=function(t){return a.rootEmSize},a.Property.prototype.getEM=function(t){return a.emSize},a.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},a.Property.prototype.isPixels=function(){if(!this.hasValue())return!1;var t=this.value+"";return!!t.match(/px$/)||!!t.match(/^[0-9]+$/)},a.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var r=this.value+"";if(r.match(/rem$/))return this.numValue()*this.getREM(t);if(r.match(/em$/))return this.numValue()*this.getEM(t);if(r.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(r.match(/px$/))return this.numValue();if(r.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(r.match(/pc$/))return 15*this.numValue();if(r.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(r.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(r.match(/in$/))return this.numValue()*this.getDPI(t);if(r.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(t);var i=this.numValue();return e&&i<1?i*a.ViewPort.ComputeSize(t):i},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var o={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return a.Property.prototype.toTextBaseline=function(){return this.hasValue()?o[this.value]:null},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,r,i,n,s){var o=null!=s?this.Parse(s):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:n=n||o.fontFamily,fontSize:i||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:r||o.fontWeight,fontVariant:e||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var r={},i=a.trim(a.compressSpaces(e||"")).split(" "),n={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},s="",o=0;o<i.length;o++)n.fontStyle||-1==t.Styles.indexOf(i[o])?n.fontVariant||-1==t.Variants.indexOf(i[o])?n.fontWeight||-1==t.Weights.indexOf(i[o])?n.fontSize?"inherit"!=i[o]&&(s+=i[o]):("inherit"!=i[o]&&(r.fontSize=i[o].split("/")[0]),n.fontStyle=n.fontVariant=n.fontWeight=n.fontSize=!0):("inherit"!=i[o]&&(r.fontWeight=i[o]),n.fontStyle=n.fontVariant=n.fontWeight=!0):("inherit"!=i[o]&&(r.fontVariant=i[o]),n.fontStyle=n.fontVariant=!0):("inherit"!=i[o]&&(r.fontStyle=i[o]),n.fontStyle=!0);return""!=s&&(r.fontFamily=s),r}},a.ToNumberArray=function(t){for(var e=a.trim(a.compressSpaces((t||"").replace(/,/g," "))).split(" "),r=0;r<e.length;r++)e[r]=parseFloat(e[r]);return e},a.Point=function(t,e){this.x=t,this.y=e},a.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},a.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],r=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=r},a.CreatePoint=function(t){var e=a.ToNumberArray(t);return new a.Point(e[0],e[1])},a.CreatePath=function(t){for(var e=a.ToNumberArray(t),r=[],i=0;i<e.length;i+=2)r.push(new a.Point(e[i],e[i+1]));return r},a.BoundingBox=function(t,e,r,i){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,r,i,n,s){var a=t+2/3*(r-t),o=e+2/3*(i-e),l=a+1/3*(n-t),h=o+1/3*(s-e);this.addBezierCurve(t,e,a,l,o,h,n,s)},this.addBezierCurve=function(t,e,r,i,n,s,a,o){var l=[t,e],h=[r,i],u=[n,s],c=[a,o];this.addPoint(l[0],l[1]),this.addPoint(c[0],c[1]);for(var f=0;f<=1;f++){var p=function(t){return Math.pow(1-t,3)*l[f]+3*Math.pow(1-t,2)*t*h[f]+3*(1-t)*Math.pow(t,2)*u[f]+Math.pow(t,3)*c[f]},d=6*l[f]-12*h[f]+6*u[f],y=-3*l[f]+9*h[f]-9*u[f]+3*c[f],m=3*h[f]-3*l[f];if(0!=y){var g=Math.pow(d,2)-4*m*y;if(!(g<0)){var v=(-d+Math.sqrt(g))/(2*y);0<v&&v<1&&(0==f&&this.addX(p(v)),1==f&&this.addY(p(v)));var b=(-d-Math.sqrt(g))/(2*y);0<b&&b<1&&(0==f&&this.addX(p(b)),1==f&&this.addY(p(b)))}}else{if(0==d)continue;var x=-m/d;0<x&&x<1&&(0==f&&this.addX(p(x)),1==f&&this.addY(p(x)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(r,i)},a.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=a.ToNumberArray(t);this.angle=new a.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=a.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],r=this.m[2],i=this.m[4],n=this.m[1],s=this.m[3],a=this.m[5],o=1/(e*(1*s-0*a)-r*(1*n-0*a)+i*(0*n-0*s));t.transform(o*(1*s-0*a),o*(0*a-1*n),o*(0*i-1*r),o*(1*e-0*i),o*(r*a-i*s),o*(i*n-e*a))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new a.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;0<=e;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var r=a.trim(a.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),i=0;i<r.length;i++)if("none"!==r[i]){var n=a.trim(r[i].split("(")[0]),s=r[i].split("(")[1].replace(")",""),o=this.Type[n];if(void 0!==o){var l=new o(s);l.type=n,this.transforms.push(l)}}},a.AspectRatio=function(t,e,r,i,n,s,o,l,h,u){var c=(e=(e=a.compressSpaces(e)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",f=e.split(" ")[1]||"meet",p=r/i,d=n/s,y=Math.min(p,d),m=Math.max(p,d);"meet"==f&&(i*=y,s*=y),"slice"==f&&(i*=m,s*=m),h=new a.Property("refX",h),u=new a.Property("refY",u),h.hasValue()&&u.hasValue()?t.translate(-y*h.toPixels("x"),-y*u.toPixels("y")):(c.match(/^xMid/)&&("meet"==f&&y==d||"slice"==f&&m==d)&&t.translate(r/2-i/2,0),c.match(/YMid$/)&&("meet"==f&&y==p||"slice"==f&&m==p)&&t.translate(0,n/2-s/2),c.match(/^xMax/)&&("meet"==f&&y==d||"slice"==f&&m==d)&&t.translate(r-i,0),c.match(/YMax$/)&&("meet"==f&&y==p||"slice"==f&&m==p)&&t.translate(0,n-s)),"none"==c?t.scale(p,d):"meet"==f?t.scale(y,y):"slice"==f&&t.scale(m,m),t.translate(null==o?0:-o,null==l?0:-l)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var r=this.attributes[t];return null!=r?r:(1==e&&(r=new a.Property(t,""),this.attributes[t]=r),r||a.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return a.EmptyProperty},this.style=function(t,e,r){var i=this.styles[t];if(null!=i)return i;var n=this.attribute(t);if(null!=n&&n.hasValue())return this.styles[t]=n;if(1!=r){var s=this.parent;if(null!=s){var o=s.style(t);if(null!=o&&o.hasValue())return o}}return 1==e&&(i=new a.Property(t,""),this.styles[t]=i),i||a.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var r=this.style("filter").getDefinition();null!=r&&r.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(t){},this.clearContext=function(t){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var r=t;e&&(r=a.CreateElement(t)),r.parent=this,"title"!=r.type&&this.children.push(r)},this.addStylesFromStyleDefinition=function(){for(var e in a.Styles)if("@"!=e[0]&&s(t,e)){var r=a.Styles[e],i=a.StylesSpecificity[e];if(null!=r)for(var n in r){var o=this.stylesSpecificity[n];void 0===o&&(o="000"),o<i&&(this.styles[n]=r[n],this.stylesSpecificity[n]=i)}}};var e,r=new RegExp("^[A-Z-]+$");if(null!=t&&1==t.nodeType){for(var i=0;i<t.attributes.length;i++){var n=t.attributes[i],o=(e=n.nodeName,r.test(e)?e.toLowerCase():e);this.attributes[o]=new a.Property(o,n.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var l=this.attribute("style").value.split(";");for(i=0;i<l.length;i++)if(""!=a.trim(l[i])){var h=l[i].split(":"),u=a.trim(h[0]),c=a.trim(h[1]);this.styles[u]=new a.Property(u,c)}}for(this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this),i=0;i<t.childNodes.length;i++){var f=t.childNodes[i];if(1==f.nodeType&&this.addChild(f,!0),this.captureTextNodes&&(3==f.nodeType||4==f.nodeType)){var p=f.value||f.text||f.textContent||"";""!=a.compressSpaces(p)&&this.addChild(new a.Element.tspan(f),!1)}}}},a.Element.RenderedElementBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.calculateOpacity=function(){for(var t=1,e=this;null!=e;){var r=e.style("opacity",!1,!0);r.hasValue()&&(t*=r.numValue()),e=e.parent}return t},this.setContext=function(t,e){if(!e){var r;if(this.style("fill").isUrlDefinition())null!=(r=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=r);else if(this.style("fill").hasValue()){var i;"currentColor"==(i=this.style("fill")).value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("fill-opacity").hasValue()&&(i=(i=new a.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=i.value),this.style("stroke").isUrlDefinition())null!=(r=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=r);else if(this.style("stroke").hasValue()){var n;"currentColor"==(n=this.style("stroke")).value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.strokeStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}if(this.style("stroke-opacity").hasValue()&&(n=(n=new a.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=n.value),this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();t.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("paint-order").hasValue()&&(t.paintOrder=this.style("paint-order").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var o=a.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(o):void 0!==t.webkitLineDash?t.webkitLineDash=o:void 0===t.mozDash||1==o.length&&0==o[0]||(t.mozDash=o);var l=this.style("stroke-dashoffset").toPixels();void 0!==t.lineDashOffset?t.lineDashOffset=l:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=l:void 0!==t.mozDashOffset&&(t.mozDashOffset=l)}}if(void 0!==t.font){t.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString();var h=this.style("font-size",!1,!1);h.isPixels()&&(a.emSize=h.toPixels())}if(this.style("transform",!1,!0).hasValue()&&new a.Transform(this.style("transform",!1,!0).value).apply(t),this.style("clip-path",!1,!0).hasValue()){var u=this.style("clip-path",!1,!0).getDefinition();null!=u&&u.apply(t)}t.globalAlpha=this.calculateOpacity()}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new a.BoundingBox},this.renderChildren=function(t){this.path(t),a.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()&&(r=this.style("marker-start").getDefinition()).render(t,e[0][0],e[0][1]),this.style("marker-mid").isUrlDefinition())for(var r=this.style("marker-mid").getDefinition(),i=1;i<e.length-1;i++)r.render(t,e[i][0],e[i][1]);this.style("marker-end").isUrlDefinition()&&(r=this.style("marker-end").getDefinition()).render(t,e[e.length-1][0],e[e.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){if(t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,t.canvas.style&&void 0!==t.font&&void 0!==i.getComputedStyle){t.font=i.getComputedStyle(t.canvas).getPropertyValue("font");var e=new a.Property("fontSize",a.Font.Parse(t.font).fontSize);e.hasValue()&&(a.rootEmSize=a.emSize=e.toPixels("y"))}this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var r=a.ViewPort.width(),n=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){r=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");var s=0,o=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(s=-this.attribute("refX").toPixels("x"),o=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(s,o),t.lineTo(r,o),t.lineTo(r,n),t.lineTo(s,n),t.closePath(),t.clip())}if(a.ViewPort.SetCurrent(r,n),this.attribute("viewBox").hasValue()){var l=a.ToNumberArray(this.attribute("viewBox").value),h=l[0],u=l[1];r=l[2],n=l[3],a.AspectRatio(t,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),r,a.ViewPort.height(),n,h,u,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(l[2],l[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y"),s=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=s),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(s=o),s=Math.min(s,i/2),o=Math.min(o,n/2),null!=t){var l=(Math.sqrt(2)-1)/3*4;t.beginPath(),t.moveTo(e+s,r),t.lineTo(e+i-s,r),t.bezierCurveTo(e+i-s+l*s,r,e+i,r+o-l*o,e+i,r+o),t.lineTo(e+i,r+n-o),t.bezierCurveTo(e+i,r+n-o+l*o,e+i-s+l*s,r+n,e+i-s,r+n),t.lineTo(e+s,r+n),t.bezierCurveTo(e+s-l*s,r+n,e,r+n-o+l*o,e,r+n-o),t.lineTo(e,r+o),t.bezierCurveTo(e,r+o-l*o,e+s-l*s,r,e+s,r),t.closePath()}return new a.BoundingBox(e,r,e+i,r+n)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y"),i=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,r,i,0,2*Math.PI,!1),t.closePath()),new a.BoundingBox(e-i,r-i,e+i,r+i)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=(Math.sqrt(2)-1)/3*4,r=this.attribute("rx").toPixels("x"),i=this.attribute("ry").toPixels("y"),n=this.attribute("cx").toPixels("x"),s=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(n+r,s),t.bezierCurveTo(n+r,s+e*i,n+e*r,s+i,n,s+i),t.bezierCurveTo(n-e*r,s+i,n-r,s+e*i,n-r,s),t.bezierCurveTo(n-r,s-e*i,n-e*r,s-i,n,s-i),t.bezierCurveTo(n+e*r,s-i,n+r,s-e*i,n+r,s),t.closePath()),new a.BoundingBox(n-r,s-i,n+r,s+i)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(t){this.base=a.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new a.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(t){this.base=a.Element.PathElementBase,this.base(t),this.points=a.CreatePath(this.attribute("points").value),this.path=function(t){var e=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var r=1;r<this.points.length;r++)e.addPoint(this.points[r].x,this.points[r].y),null!=t&&t.lineTo(this.points[r].x,this.points[r].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return 0<t.length&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(t){this.base=a.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(t){this.base=a.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var r=0;r<2;r++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(e=(e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),r=0;r<2;r++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=a.compressSpaces(e),e=a.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,r){null!=r&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(r)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var r=new a.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var i=e.getAsCurrentPoint();for(e.addMarker(i),r.addPoint(i.x,i.y),null!=t&&t.moveTo(i.x,i.y),e.start=e.current;!e.isCommandOrEnd();)i=e.getAsCurrentPoint(),e.addMarker(i,e.start),r.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y);break;case"L":case"l":for(;!e.isCommandOrEnd();){var n=e.current;i=e.getAsCurrentPoint(),e.addMarker(i,n),r.addPoint(i.x,i.y),null!=t&&t.lineTo(i.x,i.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var s=new a.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(s,e.current),e.current=s,r.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();)s=new a.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar()),e.addMarker(s,e.current),e.current=s,r.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y);break;case"C":case"c":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getPoint(),h=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,h,l),r.addBezierCurve(o.x,o.y,l.x,l.y,h.x,h.y,u.x,u.y),null!=t&&t.bezierCurveTo(l.x,l.y,h.x,h.y,u.x,u.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();)o=e.current,l=e.getReflectedControlPoint(),h=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,h,l),r.addBezierCurve(o.x,o.y,l.x,l.y,h.x,h.y,u.x,u.y),null!=t&&t.bezierCurveTo(l.x,l.y,h.x,h.y,u.x,u.y);break;case"Q":case"q":for(;!e.isCommandOrEnd();)o=e.current,h=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,h,h),r.addQuadraticCurve(o.x,o.y,h.x,h.y,u.x,u.y),null!=t&&t.quadraticCurveTo(h.x,h.y,u.x,u.y);break;case"T":case"t":for(;!e.isCommandOrEnd();)o=e.current,h=e.getReflectedControlPoint(),e.control=h,u=e.getAsCurrentPoint(),e.addMarker(u,h,h),r.addQuadraticCurve(o.x,o.y,h.x,h.y,u.x,u.y),null!=t&&t.quadraticCurveTo(h.x,h.y,u.x,u.y);break;case"A":case"a":for(;!e.isCommandOrEnd();){o=e.current;var c=e.getScalar(),f=e.getScalar(),p=e.getScalar()*(Math.PI/180),d=e.getScalar(),y=e.getScalar(),m=(u=e.getAsCurrentPoint(),new a.Point(Math.cos(p)*(o.x-u.x)/2+Math.sin(p)*(o.y-u.y)/2,-Math.sin(p)*(o.x-u.x)/2+Math.cos(p)*(o.y-u.y)/2)),g=Math.pow(m.x,2)/Math.pow(c,2)+Math.pow(m.y,2)/Math.pow(f,2);1<g&&(c*=Math.sqrt(g),f*=Math.sqrt(g));var v=(d==y?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(f,2)-Math.pow(c,2)*Math.pow(m.y,2)-Math.pow(f,2)*Math.pow(m.x,2))/(Math.pow(c,2)*Math.pow(m.y,2)+Math.pow(f,2)*Math.pow(m.x,2)));isNaN(v)&&(v=0);var b=new a.Point(v*c*m.y/f,v*-f*m.x/c),x=new a.Point((o.x+u.x)/2+Math.cos(p)*b.x-Math.sin(p)*b.y,(o.y+u.y)/2+Math.sin(p)*b.x+Math.cos(p)*b.y),w=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(w(t)*w(e))},P=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))},S=P([1,0],[(m.x-b.x)/c,(m.y-b.y)/f]),k=[(m.x-b.x)/c,(m.y-b.y)/f],C=[(-m.x-b.x)/c,(-m.y-b.y)/f],B=P(k,C);E(k,C)<=-1&&(B=Math.PI),1<=E(k,C)&&(B=0);var M=1-y?1:-1,V=S+M*(B/2),A=new a.Point(x.x+c*Math.cos(V),x.y+f*Math.sin(V));if(e.addMarkerAngle(A,V-M*Math.PI/2),e.addMarkerAngle(u,V-M*Math.PI),r.addPoint(u.x,u.y),null!=t){E=f<c?c:f;var N=f<c?1:c/f,T=f<c?f/c:1;t.translate(x.x,x.y),t.rotate(p),t.scale(N,T),t.arc(0,0,E,S,S+B,1-y),t.scale(1/N,1/T),t.rotate(-p),t.translate(-x.x,-x.y)}}break;case"Z":case"z":null!=t&&r.x1!==r.x2&&r.y1!==r.y2&&t.closePath(),e.current=e.start}return r},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),r=[],i=0;i<t.length;i++)r.push([t[i],e[i]]);return r}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(t){this.base=a.Element.ElementBase,this.base(t),this.createPattern=function(t,e){var r=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),s=new a.Element.svg;s.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),s.attributes.width=new a.Property("width",r+"px"),s.attributes.height=new a.Property("height",i+"px"),s.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),s.children=this.children;var o=n();o.width=r,o.height=i;var l=o.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&l.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var h=-1;h<=1;h++)for(var u=-1;u<=1;u++)l.save(),s.attributes.x=new a.Property("x",h*o.width),s.attributes.y=new a.Property("y",u*o.height),s.render(l),l.restore();return t.createPattern(o,"repeat")}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(t){this.base=a.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,r){if(e){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(r),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var i=new a.Element.svg;i.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),i.attributes.refX=new a.Property("refX",this.attribute("refX").value),i.attributes.refY=new a.Property("refY",this.attribute("refY").value),i.attributes.width=new a.Property("width",this.attribute("markerWidth").value),i.attributes.height=new a.Property("height",this.attribute("markerHeight").value),i.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),i.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),i.children=this.children,i.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-r),t.translate(-e.x,-e.y)}}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(t){this.base=a.Element.ElementBase,this.base(t),this.render=function(t){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var r=this.children[e];"stop"==r.type&&this.stops.push(r)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var r=this.attributesToInherit[e];!this.attribute(r).hasValue()&&t.attribute(r).hasValue()&&(this.attribute(r,!0).value=t.attribute(r).value)}},this.createGradient=function(t,e,r){var i=this;this.getHrefAttribute().hasValue()&&(i=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(i));var s=function(t){return r.hasValue()?new a.Property("color",t).addOpacity(r).value:t},o=this.getGradient(t,e);if(null==o)return s(i.stops[i.stops.length-1].color);for(var l=0;l<i.stops.length;l++)o.addColorStop(i.stops[l].offset,s(i.stops[l].color));if(this.attribute("gradientTransform").hasValue()){var h=a.ViewPort.viewPorts[0],u=new a.Element.rect;u.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),u.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),u.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),u.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var c=new a.Element.g;c.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),c.children=[u];var f=new a.Element.svg;f.attributes.x=new a.Property("x",0),f.attributes.y=new a.Property("y",0),f.attributes.width=new a.Property("width",h.width),f.attributes.height=new a.Property("height",h.height),f.children=[c];var p=n();p.width=h.width,p.height=h.height;var d=p.getContext("2d");return d.fillStyle=o,f.render(d),d.createPattern(p,"no-repeat")}return o}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var r="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox(t):null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var i="objectBoundingBox"==this.gradientUnits()?r.x()+r.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),n="objectBoundingBox"==this.gradientUnits()?r.y()+r.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),s="objectBoundingBox"==this.gradientUnits()?r.x()+r.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),a="objectBoundingBox"==this.gradientUnits()?r.y()+r.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return i==s&&n==a?null:t.createLinearGradient(i,n,s,a)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var r=e.getBoundingBox(t);this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var i="objectBoundingBox"==this.gradientUnits()?r.x()+r.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),n="objectBoundingBox"==this.gradientUnits()?r.y()+r.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),s=i,a=n;this.attribute("fx").hasValue()&&(s="objectBoundingBox"==this.gradientUnits()?r.x()+r.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?r.y()+r.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var o="objectBoundingBox"==this.gradientUnits()?(r.width()+r.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(s,a,0,i,n,o)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(t){this.base=a.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(t){this.base=a.Element.ElementBase,this.base(t),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var r=this.calcValue();this.attribute("type").hasValue()&&(r=this.attribute("type").value+"("+r+")"),this.getProperty().value=r,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),r=Math.floor(e),i=Math.ceil(e);t.from=new a.Property("from",parseFloat(this.values.value[r])),t.to=new a.Property("to",parseFloat(this.values.value[i])),t.progress=(e-r)/(i-r)}else t.from=this.from,t.to=this.to;return t}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress();return t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),r=new t(e.from.value),i=new t(e.to.value);if(r.ok&&i.ok){var n=r.r+(i.r-r.r)*e.progress,s=r.g+(i.g-r.g)*e.progress,a=r.b+(i.b-r.b)*e.progress;return"rgb("+parseInt(n,10)+","+parseInt(s,10)+","+parseInt(a,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=a.ToNumberArray(t.from.value),r=a.ToNumberArray(t.to.value),i="",n=0;n<e.length;n++)i+=e[n]+(r[n]-e[n])*t.progress+" ";return i}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(t){this.base=a.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var r=this.children[e];"font-face"==r.type?(this.fontFace=r).style("font-family").hasValue()&&(a.Definitions[r.style("font-family").value]=this):"missing-glyph"==r.type?this.missingGlyph=r:"glyph"==r.type&&(""!=r.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[r.unicode]&&(this.glyphs[r.unicode]=[]),this.glyphs[r.unicode][r.arabicForm]=r):this.glyphs[r.unicode]=r)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(t){this.base=a.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(t){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.initializeCoordinates=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0)},this.getBoundingBox=function(t){this.initializeCoordinates(t);for(var e=null,r=0;r<this.children.length;r++){var i=this.getChildBoundingBox(t,this,this,r);null==e?e=i:e.addBoundingBox(i)}return e},this.renderChildren=function(t){this.initializeCoordinates(t);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,r){var i=this.style("text-anchor").valueOrDefault("start");if("start"!=i){for(var n=0,s=r;s<e.children.length;s++){var a=e.children[s];if(r<s&&a.attribute("x").hasValue())break;n+=a.measureTextRecursive(t)}return-1*("end"==i?n:n/2)}return 0},this.adjustChildCoordinates=function(t,e,r,i){var n=r.children[i];return n.attribute("x").hasValue()?(n.x=n.attribute("x").toPixels("x")+e.getAnchorDelta(t,r,i),n.attribute("dx").hasValue()&&(n.x+=n.attribute("dx").toPixels("x"))):(n.attribute("dx").hasValue()&&(e.x+=n.attribute("dx").toPixels("x")),n.x=e.x),e.x=n.x+n.measureText(t),n.attribute("y").hasValue()?(n.y=n.attribute("y").toPixels("y"),n.attribute("dy").hasValue()&&(n.y+=n.attribute("dy").toPixels("y"))):(n.attribute("dy").hasValue()&&(e.y+=n.attribute("dy").toPixels("y")),n.y=e.y),e.y=n.y,n},this.getChildBoundingBox=function(t,e,r,i){var n=this.adjustChildCoordinates(t,e,r,i),s=n.getBoundingBox(t);for(i=0;i<n.children.length;i++){var a=e.getChildBoundingBox(t,e,n,i);s.addBoundingBox(a)}return s},this.renderChild=function(t,e,r,i){var n=this.adjustChildCoordinates(t,e,r,i);for(n.render(t),i=0;i<n.children.length;i++)e.renderChild(t,e,n,i)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,r){var i=e[r],n=null;if(t.isArabic){var s="isolated";(0==r||" "==e[r-1])&&r<e.length-2&&" "!=e[r+1]&&(s="terminal"),0<r&&" "!=e[r-1]&&r<e.length-2&&" "!=e[r+1]&&(s="medial"),0<r&&" "!=e[r-1]&&(r==e.length-1||" "==e[r+1])&&(s="initial"),void 0!==t.glyphs[i]&&null==(n=t.glyphs[i][s])&&"glyph"==t.glyphs[i].type&&(n=t.glyphs[i])}else n=t.glyphs[i];return null==n&&(n=t.missingGlyph),n},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)"stroke"==t.paintOrder?(""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y)):(""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y));else{var r=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),n=this.getText();e.isRTL&&(n=n.split("").reverse().join(""));for(var s=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<n.length;o++){var l=this.getGlyph(e,n,o),h=r/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(h,-h);var u=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/r,"italic"==i&&t.transform(1,0,.4,1,0,0),l.render(t),"italic"==i&&t.transform(1,0,-.4,1,0,0),t.lineWidth=u,t.scale(1/h,-1/h),t.translate(-this.x,-this.y),this.x+=r*(l.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,void 0===s[o]||isNaN(s[o])||(this.x+=s[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),r=0;r<this.children.length;r++)e+=this.children[r].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var r=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),i=0,n=this.getText();e.isRTL&&(n=n.split("").reverse().join(""));for(var s=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<n.length;o++)i+=(this.getGlyph(e,n,o).horizAdvX||e.horizAdvX)*r/e.fontFace.unitsPerEm,void 0===s[o]||isNaN(s[o])||(i+=s[o]);return i}var l=a.compressSpaces(this.getText());if(!t.measureText)return 10*l.length;t.save(),this.setContext(t,!0);var h=t.measureText(l).width;return t.restore(),h},this.getBoundingBox=function(t){var e=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(this.x,this.y-e,this.x+this.measureText(t),this.y)}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(t){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(t),this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(t){this.base=a.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(t){this.base=a.Element.TextElementBase,this.base(t),this.hasText=0<t.childNodes.length;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value||t.childNodes[0].data:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(0<this.children.length){var r=new a.Element.g;r.children=this.children,r.parent=this,r.render(t)}},this.onclick=function(){i.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.image=function(t){this.base=a.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var r=e.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,r)this.img=a.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var i=this;this.img.onload=function(){i.loaded=!0},this.img.onerror=function(){a.log('ERROR: image "'+e+'" not found'),i.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");0!=s&&0!=o&&(t.save(),r?t.drawSvg(this.img,e,n,s,o):(t.translate(e,n),a.AspectRatio(t,this.attribute("preserveAspectRatio").value,s,this.img.width,o,this.img.height,0,0),i.loaded&&(void 0===this.img.complete||this.img.complete)&&t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");return new a.BoundingBox(t,e,t+r,e+i)}}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(t){for(var e=new a.BoundingBox,r=0;r<this.children.length;r++)e.addBoundingBox(this.children[r].getBoundingBox(t));return e}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.render=function(t){}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(t){this.base=a.Element.ElementBase,this.base(t);for(var e="",r=0;r<t.childNodes.length;r++)e+=t.childNodes[r].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var i=(e=a.compressSpaces(e)).split("}");for(r=0;r<i.length;r++)if(""!=a.trim(i[r]))for(var n=i[r].split("{"),s=n[0].split(","),o=n[1].split(";"),l=0;l<s.length;l++){var h=a.trim(s[l]);if(""!=h){for(var u=a.Styles[h]||{},c=0;c<o.length;c++){var f=o[c].indexOf(":"),p=o[c].substr(0,f),y=o[c].substr(f+1,o[c].length-f);null!=p&&null!=y&&(u[a.trim(p)]=new a.Property(a.trim(p),a.trim(y)))}if(a.Styles[h]=u,a.StylesSpecificity[h]=d(h),"@font-face"==h)for(var m=u["font-family"].value.replace(/"/g,""),g=u.src.value.split(","),v=0;v<g.length;v++)if(0<g[v].indexOf('format("svg")'))for(var b=g[v].indexOf("url"),x=g[v].indexOf(")",b),w=g[v].substr(b+5,x-b-6),E=a.parseXml(a.ajax(w)).getElementsByTagName("font"),P=0;P<E.length;P++){var S=a.CreateElement(E[P]);a.Definitions[m]=S}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.elementTransform=function(){if(null!=e&&e.style("transform",!1,!0).hasValue())return new a.Transform(e.style("transform",!1,!0).value)},this.getBoundingBox=function(t){if(null!=e)return e.getBoundingBox(t)},this.renderChildren=function(t){if(null!=e){var r=e;"symbol"==e.type&&((r=new a.Element.svg).type="svg",r.attributes.viewBox=new a.Property("viewBox",e.attribute("viewBox").value),r.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),r.attributes.overflow=new a.Property("overflow",e.attribute("overflow").value),r.children=e.children),"svg"==r.type&&(this.attribute("width").hasValue()&&(r.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(r.attributes.height=new a.Property("height",this.attribute("height").value)));var i=r.parent;r.parent=null,r.render(t),r.parent=i}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var r=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");if(0==s&&0==o){for(var l=new a.BoundingBox,h=0;h<this.children.length;h++)l.addBoundingBox(this.children[h].getBoundingBox(t));r=Math.floor(l.x1),i=Math.floor(l.y1),s=Math.floor(l.width()),o=Math.floor(l.height())}var u=e.attribute("mask").value;e.attribute("mask").value="";var c=n();c.width=r+s,c.height=i+o;var f=c.getContext("2d");this.renderChildren(f);var p=n();p.width=r+s,p.height=i+o;var d=p.getContext("2d");e.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=f.createPattern(c,"no-repeat"),d.fillRect(0,0,r+s,i+o),t.fillStyle=d.createPattern(p,"no-repeat"),t.fillRect(0,0,r+s,i+o),e.attribute("mask").value=u},this.render=function(t){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t){var e="undefined"!=typeof CanvasRenderingContext2D,r=t.beginPath,i=t.closePath;e&&(CanvasRenderingContext2D.prototype.beginPath=function(){},CanvasRenderingContext2D.prototype.closePath=function(){}),r.call(t);for(var n=0;n<this.children.length;n++){var s=this.children[n];if(void 0!==s.path){var o=void 0!==s.elementTransform&&s.elementTransform();!o&&s.style("transform",!1,!0).hasValue()&&(o=new a.Transform(s.style("transform",!1,!0).value)),o&&o.apply(t),s.path(t),e&&(CanvasRenderingContext2D.prototype.closePath=i),o&&o.unapply(t)}}i.call(t),t.clip(),e&&(CanvasRenderingContext2D.prototype.beginPath=r,CanvasRenderingContext2D.prototype.closePath=i)},this.render=function(t){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var r=e.getBoundingBox(t),i=Math.floor(r.x1),s=Math.floor(r.y1),a=Math.floor(r.width()),o=Math.floor(r.height()),l=e.style("filter").value;e.style("filter").value="";for(var h=0,u=0,c=0;c<this.children.length;c++){var f=this.children[c].extraFilterDistance||0;h=Math.max(h,f),u=Math.max(u,f)}var p=n();p.width=a+2*h,p.height=o+2*u;var d=p.getContext("2d");for(d.translate(-i+h,-s+u),e.render(d),c=0;c<this.children.length;c++)"function"==typeof this.children[c].apply&&this.children[c].apply(d,0,0,a+2*h,o+2*u);t.drawImage(p,0,0,a+2*h,o+2*u,i-h,s-u,a+2*h,o+2*u),e.style("filter",!0).value=l},this.render=function(t){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,r,i,n){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feComposite=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,r,i,n){}},a.Element.feComposite.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(t){this.base=a.Element.ElementBase,this.base(t);var e=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var r=e[0];e=[.213+.787*r,.715-.715*r,.072-.072*r,0,0,.213-.213*r,.715+.285*r,.072-.072*r,0,0,.213-.213*r,.715-.715*r,.072+.928*r,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var i=e[0]*Math.PI/180,n=function(t,e,r){return t+Math.cos(i)*e+Math.sin(i)*r};e=[n(.213,.787,-.213),n(.715,-.715,-.715),n(.072,-.072,.928),0,0,n(.213,-.213,.143),n(.715,.285,.14),n(.072,-.072,-.283),0,0,n(.213,-.213,-.787),n(.715,-.715,.715),n(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function s(t,e,r,i,n,s){return t[r*i*4+4*e+s]}function o(t,e,r,i,n,s,a){t[r*i*4+4*e+s]=a}function l(t,r){var i=e[t];return i*(i<0?r-255:r)}this.apply=function(t,e,r,i,n){var a=t.getImageData(0,0,i,n);for(r=0;r<n;r++)for(e=0;e<i;e++){var h=s(a.data,e,r,i,0,0),u=s(a.data,e,r,i,0,1),c=s(a.data,e,r,i,0,2),f=s(a.data,e,r,i,0,3);o(a.data,e,r,i,0,0,l(0,h)+l(1,u)+l(2,c)+l(3,f)+l(4,1)),o(a.data,e,r,i,0,1,l(5,h)+l(6,u)+l(7,c)+l(8,f)+l(9,1)),o(a.data,e,r,i,0,2,l(10,h)+l(11,u)+l(12,c)+l(13,f)+l(14,1)),o(a.data,e,r,i,0,3,l(15,h)+l(16,u)+l(17,c)+l(18,f)+l(19,1))}t.clearRect(0,0,i,n),t.putImageData(a,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(t){this.base=a.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,r,i,n,s){e&&void 0!==e.canvasRGBA?(t.canvas.id=a.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas,r,i,n,s,this.blurRadius),document.body.removeChild(t.canvas)):a.log("ERROR: StackBlur.js must be included for blur to work")}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(t){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(t){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(t){a.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var r=null;return(r=void 0!==a.Element[e]?new a.Element[e](t):new a.Element.MISSING(t)).type=t.nodeName,r},a.load=function(t,e){a.loadXml(t,a.ajax(e))},a.loadXml=function(t,e){a.loadXmlDoc(t,a.parseXml(e))},a.loadXmlDoc=function(t,e){a.init(t);var r=function(e){for(var r=t.canvas;r;)e.x-=r.offsetLeft,e.y-=r.offsetTop,r=r.offsetParent;return i.scrollX&&(e.x+=i.scrollX),i.scrollY&&(e.y+=i.scrollY),e};1!=a.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=r(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=r(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onmousemove(e.x,e.y)});var n=a.CreateElement(e.documentElement);n.root=!0,n.addStylesFromStyleDefinition();var s=!0,o=function(){a.ViewPort.Clear(),t.canvas.parentNode?a.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight):a.ViewPort.SetCurrent(800,600),1!=a.opts.ignoreDimensions&&(n.style("width").hasValue()&&(t.canvas.width=n.style("width").toPixels("x"),t.canvas.style&&(t.canvas.style.width=t.canvas.width+"px")),n.style("height").hasValue()&&(t.canvas.height=n.style("height").toPixels("y"),t.canvas.style&&(t.canvas.style.height=t.canvas.height+"px")));var r=t.canvas.clientWidth||t.canvas.width,i=t.canvas.clientHeight||t.canvas.height;if(1==a.opts.ignoreDimensions&&n.style("width").hasValue()&&n.style("height").hasValue()&&(r=n.style("width").toPixels("x"),i=n.style("height").toPixels("y")),a.ViewPort.SetCurrent(r,i),null!=a.opts.offsetX&&(n.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(n.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var o=null,l=null,h=a.ToNumberArray(n.attribute("viewBox").value);null!=a.opts.scaleWidth&&(n.attribute("width").hasValue()?o=n.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(h[2])||(o=h[2]/a.opts.scaleWidth)),null!=a.opts.scaleHeight&&(n.attribute("height").hasValue()?l=n.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(h[3])||(l=h[3]/a.opts.scaleHeight)),null==o&&(o=l),null==l&&(l=o),n.attribute("width",!0).value=a.opts.scaleWidth,n.attribute("height",!0).value=a.opts.scaleHeight,n.style("transform",!0,!0).value+=" scale("+1/o+","+1/l+")"}1!=a.opts.ignoreClear&&t.clearRect(0,0,r,i),n.render(t),s&&(s=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(e))},l=!0;a.ImagesLoaded()&&(l=!1,o()),a.intervalID=setInterval((function(){var t=!1;if(l&&a.ImagesLoaded()&&(t=!(l=!1)),1!=a.opts.ignoreMouse&&(t|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var e=0;e<a.Animations.length;e++)t|=a.Animations[e].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(t=!0),t&&(o(),a.Mouse.runEvents())}),1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var r=0;r<this.events.length;r++){var i=this.events[r];e.isPointInPath&&e.isPointInPath(i.x,i.y)&&(this.eventElements[r]=t)}},this.checkBoundingBox=function(t,e){for(var r=0;r<this.events.length;r++){var i=this.events[r];e.isPointInBox(i.x,i.y)&&(this.eventElements[r]=t)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],r=this.eventElements[t];r;)e.run(r),r=r.parent;this.events=[],this.eventElements=[]}},a}(l||{});"string"==typeof r&&(r=document.getElementById(r)),null!=r.svg&&r.svg.stop(),r.childNodes&&1==r.childNodes.length&&"OBJECT"==r.childNodes[0].nodeName||(r.svg=h);var u=r.getContext("2d");void 0!==o.documentElement?h.loadXmlDoc(u,o):"<"==o.substr(0,1)?h.loadXml(u,o):h.load(u,o)}else for(var c=document.querySelectorAll("svg"),f=0;f<c.length;f++){var p=c[f],y=document.createElement("canvas");y.width=p.clientWidth,y.height=p.clientHeight,p.parentNode.insertBefore(y,p),p.parentNode.removeChild(p);var m=document.createElement("div");m.appendChild(p),a(y,m.innerHTML)}};"undefined"==typeof Element||(void 0!==Element.prototype.matches?s=function(t,e){return t.matches(e)}:void 0!==Element.prototype.webkitMatchesSelector?s=function(t,e){return t.webkitMatchesSelector(e)}:void 0!==Element.prototype.mozMatchesSelector?s=function(t,e){return t.mozMatchesSelector(e)}:void 0!==Element.prototype.msMatchesSelector?s=function(t,e){return t.msMatchesSelector(e)}:void 0!==Element.prototype.oMatchesSelector?s=function(t,e){return t.oMatchesSelector(e)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(s=function(t,e){return $(t).is(e)}),void 0===s&&"undefined"!=typeof Sizzle&&(s=Sizzle.matchesSelector)));var o=/(\[[^\]]+\])/g,l=/(#[^\s\+>~\.\[:]+)/g,h=/(\.[^\s\+>~\.\[:]+)/g,u=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,c=/(:[\w-]+\([^\)]*\))/gi,f=/(:[^\s\+>~\.\[:]+)/g,p=/([^\s\+>~\.\[:]+)/g;function d(t){var e=[0,0,0],r=function(r,i){var n=t.match(r);null!=n&&(e[i]+=n.length,t=t.replace(r," "))};return t=(t=t.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),r(o,1),r(l,0),r(h,1),r(u,2),r(c,1),r(f,1),t=(t=t.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),r(p,2),e.join("")}"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,r,i,n,s){var o={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:r,scaleWidth:i,scaleHeight:n};for(var l in s)s.hasOwnProperty(l)&&(o[l]=s[l]);a(this.canvas,t,o)}),r.exports=a}(r={exports:{}}),r.exports}(r(4),r(5))},function(t,e,r){var i;window,t.exports=(i=r(0),function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e){t.exports=i},function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return n}));var i=r(0);function n(){var t,e,r,n,s,a,o,l,h,u=[];function c(t){return t.eachAfter(f),t.eachBefore(p),t.eachBefore(d),t}function f(n){var c=h(n).width,f=h(n).height;if(t(n)){if(c=f=0,n.children){for(var p=function(t){var i=[],n=0,s=!1,o=0,h=!0;return t.children.forEach((function(u,c){e(u)&&!s&&(s=!0),n+=u.x1-u.x0,n+=h?r(u)?a(u).left:0:Math.max(a(u).left,a(t.children[c-1]).right);var f=r(u)?a(u).right:0;(n+f>l(t)||c===t.children.length-1)&&(n+=f),n>l(t)||c===t.children.length-1?(i.push({from:o,to:c,width:n,flexHeight:s}),c<t.children.length-1&&(o=c+1,n=0,s=!1,h=!0)):h=!1})),i}(n),d=0;d<p.length;d++)p[d].height=y(n,p,d);u.push({box:n,lines:p}),c+=i.max(p,(function(t){return t.width})),f+=i.sum(p,(function(t){return t.height}))}c+=s(n).left+s(n).right,f+=s(n).top+s(n).bottom,c=Math.max(c,o(n).width),f=Math.max(f,o(n).height)}n.x0=n.y0=0,n.x1=c,n.y1=f}function p(i){var n=i.y1;if(i.parent&&e(i)){n=v(i).height;var s=m(i.parent),o=g(i,s);n-=r(i)||0!==o?a(i).top:0;var l=(n-=r(i)||o!==s.length-1?a(i).bottom:0)-i.y1;if(t(i)&&i.children&&l>0){var h=m(i),u=l/h.length,c=!0,f=!1,p=void 0;try{for(var d,y=h[Symbol.iterator]();!(c=(d=y.next()).done);c=!0)d.value.height+=u}catch(t){f=!0,p=t}finally{try{c||null==y.return||y.return()}finally{if(f)throw p}}}}i.y1=n}function d(t){var e=t.x1-t.x0,i=t.y1-t.y0;if(t.parent){t.y0=t.parent.y0+s(t.parent).top;var o=t.parent.children.indexOf(t);if(0===o||function(t){if(t.parent){var e=t.parent.children.indexOf(t),r=m(t.parent);return r[g(t,r)].from===e}return null}(t))t.x0+=t.parent.x0+s(t.parent).left,r(t)&&(t.x0+=a(t).left);else{var l=t.parent.children[o-1];t.x0=l.x1,t.x0+=Math.max(a(l).right,a(t).left)}}else switch(n){case"top":t.y0=0;break;case"middle":t.y0=i/2;break;case"bottom":t.y0=i}switch(n){case"top":if(t.parent){var h=g(t);t.y0+=r(t)||0!==h?a(t).top:0,t.y0+=b(t)}break;case"middle":t.parent&&(t.y0+=b(t)+v(t).height/2),t.y0-=i/2;break;case"bottom":if(t.parent){var u=m(t.parent),c=g(t,u);t.y0-=r(t)||c!==u.length-1?a(t).bottom:0,t.y0+=b(t,!0)}t.y0-=i}t.x1=t.x0+e,t.y1=t.y0+i}function y(t,e,i){for(var n=e[i],s=0,l=n.from;l<=n.to;l++){var h=t.children[l],u=h.y1-h.y0,c=(r(h)||0!==i?a(h).top:0)+(r(h)||i!==e.length-1?a(h).bottom:0);u+c>s&&(s=u+c)}return Math.max(s,o(t).height)}function m(t){return u[u.findIndex((function(e){return e.box===t}))].lines}function g(t,e){if(t.parent){var r=arguments.length>1?e:m(t.parent),i=t.parent.children.indexOf(t);return r.findIndex((function(t){return i>=t.from&&i<=t.to}))}return null}function v(t){var e=m(t.parent);return e[g(t,e)]}function b(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.parent){var r=m(t.parent),n=g(t,r),s=e?n:n-1;return i.sum(r.filter((function(t,e){return e<=s})),(function(t){return t.height}))}return null}function x(t){return function(){return t}}return c.vAlign=function(t){return arguments.length?(n=t,c):n},c.edgeMargins=function(t){return arguments.length?(r="function"==typeof t?t:x(+t),c):r},c.isContainer=function(e){return arguments.length?(t="function"==typeof e?e:x(+e),c):t},c.spanHeight=function(t){return arguments.length?(e="function"==typeof t?t:x(+t),c):e},c.padding=function(t){return arguments.length?(s="function"==typeof t?t:x(+t),c):s},c.margin=function(t){return arguments.length?(a="function"==typeof t?t:x(+t),c):a},c.nodeSize=function(t){return arguments.length?(h="function"==typeof t?t:x(+t),c):h},c.minContainerSize=function(t){return arguments.length?(o="function"==typeof t?t:x(+t),c):o},c.maxLineWidth=function(t){return arguments.length?(l="function"==typeof t?t:x(+t),c):l},c}}]).default)},function(t,e){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var r=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],i=0;i<r.length;i++){var n=r[i].re,s=r[i].process,a=n.exec(t);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),r=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==r.length&&(r="0"+r),"#"+t+e+r},this.getHelpXML=function(){for(var t=new Array,i=0;i<r.length;i++)for(var n=r[i].example,s=0;s<n.length;s++)t[t.length]=n[s];for(var a in e)t[t.length]=a;var o=document.createElement("ul");o.setAttribute("id","rgbcolor-examples");for(i=0;i<t.length;i++)try{var l=document.createElement("li"),h=new RGBColor(t[i]),u=document.createElement("div");u.style.cssText="margin: 3px; border: 1px solid black; background:"+h.toHex()+"; color:"+h.toHex(),u.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+t[i]+" -> "+h.toRGB()+" -> "+h.toHex());l.appendChild(u),l.appendChild(c),o.appendChild(l)}catch(t){}return o}}},function(t,e){var r=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],i=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function n(t,e,r,i,n){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLCanvasElement&&!t instanceof HTMLCanvasElement)return;var s,a=t.getContext("2d");try{try{s=a.getImageData(e,r,i,n)}catch(t){throw new Error("unable to access local image data: "+t)}}catch(t){throw new Error("unable to access image data: "+t)}return s}function s(t,e,r,i,s,o){if(!(isNaN(o)||o<1)){o|=0;var l=n(t,e,r,i,s);l=a(l,e,r,i,s,o),t.getContext("2d").putImageData(l,e,r)}}function a(t,e,n,s,a,o){var l,u,c,f,p,d,y,m,g,v,b,x,w,E,P,S,k,C,B,M,V,A,N,T,O=t.data,D=o+o+1,z=s-1,I=a-1,R=o+1,F=R*(R+1)/2,$=new h,L=$;for(c=1;c<D;c++)if(L=L.next=new h,c==R)var q=L;L.next=$;var j=null,X=null;y=d=0;var W=r[o],_=i[o];for(u=0;u<a;u++){for(S=k=C=B=m=g=v=b=0,x=R*(M=O[d]),w=R*(V=O[d+1]),E=R*(A=O[d+2]),P=R*(N=O[d+3]),m+=F*M,g+=F*V,v+=F*A,b+=F*N,L=$,c=0;c<R;c++)L.r=M,L.g=V,L.b=A,L.a=N,L=L.next;for(c=1;c<R;c++)f=d+((z<c?z:c)<<2),m+=(L.r=M=O[f])*(T=R-c),g+=(L.g=V=O[f+1])*T,v+=(L.b=A=O[f+2])*T,b+=(L.a=N=O[f+3])*T,S+=M,k+=V,C+=A,B+=N,L=L.next;for(j=$,X=q,l=0;l<s;l++)O[d+3]=N=b*W>>_,0!=N?(N=255/N,O[d]=(m*W>>_)*N,O[d+1]=(g*W>>_)*N,O[d+2]=(v*W>>_)*N):O[d]=O[d+1]=O[d+2]=0,m-=x,g-=w,v-=E,b-=P,x-=j.r,w-=j.g,E-=j.b,P-=j.a,f=y+((f=l+o+1)<z?f:z)<<2,m+=S+=j.r=O[f],g+=k+=j.g=O[f+1],v+=C+=j.b=O[f+2],b+=B+=j.a=O[f+3],j=j.next,x+=M=X.r,w+=V=X.g,E+=A=X.b,P+=N=X.a,S-=M,k-=V,C-=A,B-=N,X=X.next,d+=4;y+=s}for(l=0;l<s;l++){for(k=C=B=S=g=v=b=m=0,x=R*(M=O[d=l<<2]),w=R*(V=O[d+1]),E=R*(A=O[d+2]),P=R*(N=O[d+3]),m+=F*M,g+=F*V,v+=F*A,b+=F*N,L=$,c=0;c<R;c++)L.r=M,L.g=V,L.b=A,L.a=N,L=L.next;for(p=s,c=1;c<=o;c++)d=p+l<<2,m+=(L.r=M=O[d])*(T=R-c),g+=(L.g=V=O[d+1])*T,v+=(L.b=A=O[d+2])*T,b+=(L.a=N=O[d+3])*T,S+=M,k+=V,C+=A,B+=N,L=L.next,c<I&&(p+=s);for(d=l,j=$,X=q,u=0;u<a;u++)O[(f=d<<2)+3]=N=b*W>>_,N>0?(N=255/N,O[f]=(m*W>>_)*N,O[f+1]=(g*W>>_)*N,O[f+2]=(v*W>>_)*N):O[f]=O[f+1]=O[f+2]=0,m-=x,g-=w,v-=E,b-=P,x-=j.r,w-=j.g,E-=j.b,P-=j.a,f=l+((f=u+R)<I?f:I)*s<<2,m+=S+=j.r=O[f],g+=k+=j.g=O[f+1],v+=C+=j.b=O[f+2],b+=B+=j.a=O[f+3],j=j.next,x+=M=X.r,w+=V=X.g,E+=A=X.b,P+=N=X.a,S-=M,k-=V,C-=A,B-=N,X=X.next,d+=s}return t}function o(t,e,r,i,s,a){if(!(isNaN(a)||a<1)){a|=0;var o=n(t,e,r,i,s);o=l(o,e,r,i,s,a),t.getContext("2d").putImageData(o,e,r)}}function l(t,e,n,s,a,o){var l,u,c,f,p,d,y,m,g,v,b,x,w,E,P,S,k,C,B,M,V=t.data,A=o+o+1,N=s-1,T=a-1,O=o+1,D=O*(O+1)/2,z=new h,I=z;for(c=1;c<A;c++)if(I=I.next=new h,c==O)var R=I;I.next=z;var F=null,$=null;y=d=0;var L=r[o],q=i[o];for(u=0;u<a;u++){for(E=P=S=m=g=v=0,b=O*(k=V[d]),x=O*(C=V[d+1]),w=O*(B=V[d+2]),m+=D*k,g+=D*C,v+=D*B,I=z,c=0;c<O;c++)I.r=k,I.g=C,I.b=B,I=I.next;for(c=1;c<O;c++)f=d+((N<c?N:c)<<2),m+=(I.r=k=V[f])*(M=O-c),g+=(I.g=C=V[f+1])*M,v+=(I.b=B=V[f+2])*M,E+=k,P+=C,S+=B,I=I.next;for(F=z,$=R,l=0;l<s;l++)V[d]=m*L>>q,V[d+1]=g*L>>q,V[d+2]=v*L>>q,m-=b,g-=x,v-=w,b-=F.r,x-=F.g,w-=F.b,f=y+((f=l+o+1)<N?f:N)<<2,m+=E+=F.r=V[f],g+=P+=F.g=V[f+1],v+=S+=F.b=V[f+2],F=F.next,b+=k=$.r,x+=C=$.g,w+=B=$.b,E-=k,P-=C,S-=B,$=$.next,d+=4;y+=s}for(l=0;l<s;l++){for(P=S=E=g=v=m=0,b=O*(k=V[d=l<<2]),x=O*(C=V[d+1]),w=O*(B=V[d+2]),m+=D*k,g+=D*C,v+=D*B,I=z,c=0;c<O;c++)I.r=k,I.g=C,I.b=B,I=I.next;for(p=s,c=1;c<=o;c++)d=p+l<<2,m+=(I.r=k=V[d])*(M=O-c),g+=(I.g=C=V[d+1])*M,v+=(I.b=B=V[d+2])*M,E+=k,P+=C,S+=B,I=I.next,c<T&&(p+=s);for(d=l,F=z,$=R,u=0;u<a;u++)V[f=d<<2]=m*L>>q,V[f+1]=g*L>>q,V[f+2]=v*L>>q,m-=b,g-=x,v-=w,b-=F.r,x-=F.g,w-=F.b,f=l+((f=u+O)<T?f:T)*s<<2,m+=E+=F.r=V[f],g+=P+=F.g=V[f+1],v+=S+=F.b=V[f+2],F=F.next,b+=k=$.r,x+=C=$.g,w+=B=$.b,E-=k,P-=C,S-=B,$=$.next,d+=s}return t}function h(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}t.exports={image:function(t,e,r,i){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLImageElement&&!t instanceof HTMLImageElement)return;var n=t.naturalWidth,a=t.naturalHeight;if("string"==typeof e)e=document.getElementById(e);else if("undefined"!=typeof HTMLCanvasElement&&!e instanceof HTMLCanvasElement)return;e.style.width=n+"px",e.style.height=a+"px",e.width=n,e.height=a;var l=e.getContext("2d");l.clearRect(0,0,n,a),l.drawImage(t,0,0),isNaN(r)||r<1||(i?s(e,0,0,n,a,r):o(e,0,0,n,a,r))},canvasRGBA:s,canvasRGB:o,imageDataRGBA:a,imageDataRGB:l}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";r.r(e);class i{constructor(){}static rel_logic(t,e){return t>3||t<0||e>3||e<0?-98:0===t||1===e?e:0===e||1===t||t===e?t:2===t&&3===e||3===t&&2===e?1:-99}static rel(...t){if(t.length>1){let e=0;for(let r in t)e=this.rel_logic(e,t[r]);return e}return-97}static inv_logic(t){switch(t){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}return-99}static inv(t,e){if(e>0){let r=t;for(let t=0;t<e;t++)r=this.inv_logic(r);return r}return this.inv_logic(t)}static uForm2(t,e,r=!1){return this.reEntry(void 0,!1,r,t,e)}static iForm2(t,e,r=!1){return this.reEntry(void 0,!0,r,t,e)}static uForm3(t,e,r,i,n=!1){return this.reEntry(!0,t,n,e,r,i)}static iForm3(t,e,r,i,n=!1){return this.reEntry(!1,t,n,e,r,i)}static uForm4(t,e,r,i,n=!1){return this.reEntry(void 0,!1,n,t,e,r,i)}static iForm4(t,e,r,i,n=!1){return this.reEntry(void 0,!0,n,t,e,r,i)}static uForm5(t,e,r,i,n,s,a=!1){return this.reEntry(!0,t,a,e,r,i,n,s)}static iForm5(t,e,r,i,n,s,a=!1){return this.reEntry(!1,t,a,e,r,i,n,s)}static reEntry(t,e,r,...i){void 0===t&&(t=!1),void 0===e&&(e=!1);const n=i.length%2==0;let s=0,a=-1,o=!1,l=!1;n?e?l=!0:o=!0:t?o=!0:l=!0;let h=-1;for(let t=0;t<i.length;t++){const e=i[t];if(1==e){h=t;break}if(0==e)s++;else if(2==e||3==e)if(-1==a)a=t;else if(e!=i[a]){h=a;break}}if(s==i.length)return l?3:2;if(h>=0){let t=1;for(let r=h;r<i.length;r++)t=e&&r==i.length-1?this.rel(t,i[r]):this.inv(this.rel(t,i[r]));return t}const u=!t||n||e?1:2;for(let s=i.length*u-1;s>=0;s--){const a=s%i.length;if(2==i[a]||3==i[a]){const o=i.length*u-1-s;if(r&&(e&&o%2==0||!e&&o%2==1))return l?this.rel(3,i[a]):this.rel(2,i[a]);{let r=2;!e||n||t||(r=this.inv(r));for(let t=0;t<i.length*u;t++){let n=0;t==s&&(n=2==i[a]?0:this.inv(0)),r=e&&t==i.length-1?this.rel(r,n):this.inv(this.rel(r,n))}let o=2;!e||n||t||(o=this.inv(o));for(let t=0;t<i.length*u;t++){let r=0;t==s&&(r=2==i[a]?1:this.inv(1)),o=e&&t==i.length-1?this.rel(o,r):this.inv(this.rel(o,r))}return this.cont(r,o)}}}return-99}static implL(t,e){return this.rel(this.inv(t),e)}static implR(t,e){return this.rel(t,this.inv(e))}static pre(t,e){return this.inv(this.implL(t,e))}static post(t,e){return this.inv(this.implR(t,e))}static cont(t,e){return this.rel(this.pre(t,e),this.post(t,e))}static equiv(t,e){return this.inv(this.cont(t,e))}}r(2);function n(t,e){for(var r=t+"";r.length<e;)r="0"+r;return r}String.prototype.replaceAll=function(t,e,r){return r&&(t=t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")),this.replace(new RegExp(t,"g"),e)},String.prototype.addBefore=function(t,e){return this.substr(0,t)+e+this.substr(t)},String.prototype.replaceAt=function(t,e){return this.substr(0,t)+e+this.substr(t+e.length)};const s={a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"",alt:"","2r":"","2r+1":""},a=((t,e=!1)=>Object.keys(t).reduce((r,i)=>Object.assign(r,{[t[i]]:e?i:(r[t[i]]||[]).concat(i)}),{}))(s,!0),o=(t,e)=>(...r)=>{const i=t(...r);return{cata:t=>i?t.success(i):t.error(e)}},l=(t,e='"',r="")=>{if(!h(t,e))return null;return t.split(e).filter((t,e,r)=>e%2==0||e===r.length-1).join(r)},h=(t,e='"')=>t.split(e).length%2==1,u=(t,e={open:"{",close:"}"},r=[])=>{const i=t.match(new RegExp(`\\${e.open}[^${e.open}${e.close}]*?\\${e.close}`,"g"));if(!i)return r;const n=i.reduce((t,e)=>t.replace(e,""),t);return u(n,e,[...r,...i])},c=(t,e="(",r=")")=>0===t.length||0===t.split("").reduce((t,i,n,s)=>{if(i===e)t++;else if(i===r){if(null===t)return NaN;t--}return n===s.length-1&&null===t?0:t},null);class f extends i{constructor(){}static calc(t){let e=0;const r=this.getValidForm(t);for(let t in r.space)if("form"===r.space[t].type)e=this.rel(e,this.calc(r.space[t]));else if("const"===r.space[t].type)e=this.rel(e,r.space[t].value);else if("var"===r.space[t].type)isNaN(r.space[t].value)||(e=this.rel(e,r.space[t].value));else if("unclear"===r.space[t].type)e=this.rel(e,r.space[t].value);else if("reEntry"===r.space[t].type){let i=[];const n=r.space[t];for(let t in n.nested)i=[...i,this.calc(n.nested[t])];const s=n.nested.length%2==0?void 0:n.reEven;e=this.rel(e,this.reEntry(s,n.lastOpen,n.altInterpretation,...i))}return r.unmarked?e:this.inv(e)}static calcAll(t){const e=this.getValidForm(t),r=this.getVariables(e),i=r.length,s={};if(i<1)return s.Result=this.calc(e),s;const a=r.join()+";";for(let t=0;t<4**i;t++){const o=n(t.toString(4),i),l=o.split("").map((t,e)=>({var:r[e],value:parseInt(t)}));s[a+o]=this.interCalc(e,l)}return s}static interCalc(t,e){return this.calc(this.interpret(t,e))}static interpret(t,e){const r=this.getValidForm(t),i=JSON.parse(JSON.stringify(r));return this.traverseForm(i,(function(t){const r=t.space;for(let t in r)if("var"===r[t].type)for(let i in e)if(r[t].symbol===e[i].var){r[t].value=e[i].value;break}})),i}static rel_logic(t,e){return typeof t===Array||typeof e===Array?null:super.rel_logic(t,e)}static rel(...t){return super.rel(...t)}static inv_logic(t){return typeof t===Array?null:super.inv_logic(t)}static inv(t,e){return super.inv(t,e)}static parseLinear(t){const e=this.convFromLinear(t);let r=null;try{r=JSON.parse(e)}catch(t){console.log(t)}return r}static convFromLinear(t){const e=this.cleanLinear(t);return function t(e){return e.reduce((function(e,r){return e.concat(Array.isArray(r)?t(r):r)}),[])}(this.constructFromLinear(e)).join("")}static cleanLinear(t){let e="",r=!1,i=!1;for(let n in t){const s=t[n];if("string"!=typeof s)break;'"'!==s||i||(r=!r),"/"!==s||r||(i=!i)," "===s?(r||i)&&(e+=s):e+=s}return e}static constructFromLinear(t){let e=[],r=!0,i=0,n=!1,s=!1;for(let e in t){const a=t[e];if("string"!=typeof a)break;if(!n&&!s)if("("===a){if(0==i&&0!=e)break;i++}else if(")"===a&&(i--,0==i)){if(e==t.length-1){r=!1;break}break}'"'!==a||s||(n=!n),"/"!==a||n||(s=!s)}e=[...e,"  {"],e=[...e,'"type":"form",'],r?e=[...e,'"unmarked":true,']:t=t.slice(1,t.length-1),e=[...e,'"space":['];let a=[""];i=0,n=!1,s=!1;for(let e in t){let r=t[e];const o=t[e-1];if("string"!=typeof r)break;n||s||(")"!==r&&"}"!==r||i--,"("===r||"{"===r?(0===i&&e>0&&(a=[...a,""]),i++):")"!==o&&"}"!==o||")"===r||"}"===r||0===i&&(a=[...a,""]),1===i&&","===r?r="":1===i&&"|"===r?r="":1===i&&"@"===r&&(r="")),'"'!==r||s||(n=!n),"/"!==r||n||(s=!s),a[a.length-1]+=r}for(let t in a){if("("===a[t][0]){let e=[this.constructFromLinear(a[t])];a[t]=e.slice()}else if("{"===a[t][0]){let e=["  {"];e=[...e,'"type":"reEntry",'];const r=a[t].slice(1,a[t].length-1);let i=void 0;if(r.includes("")){const t=r.startsWith("alt"),n=t?r.slice(4):r.slice();let s=[-1,-1];n.startsWith("..._")?s=[3,1]:n.startsWith("...")?s=[3,0]:n.startsWith(".._")?s=[2,1]:n.startsWith("..")?s=[2,0]:n.startsWith("_")?s=[0,1]:n.startsWith("")&&(s=[0,0]);const a=s[0]+s[1]+1;i=n.slice(a).split(""),e=i.length%2==0?[...e,'"reEven":"undefined",']:2===s[0]?[...e,'"reEven":true,']:[...e,'"reEven":false,'],e=s[1]>0?[...e,'"lastOpen":true,']:[...e,'"lastOpen":false,'],e=t?[...e,'"altInterpretation":true,']:[...e,'"altInterpretation":false,']}else{const t=r.split("");i=t[t.length-1].split(""),e=i.length%2==0?[...e,'"reEven":"undefined",']:"2r"===t[0]||"2r"===t[1]||"2r"===t[2]?[...e,'"reEven":true,']:[...e,'"reEven":false,'],e="open"===t[0]||"open"===t[1]||"open"===t[2]?[...e,'"lastOpen":true,']:[...e,'"lastOpen":false,'],e="alt"===t[0]||"alt"===t[1]||"alt"===t[2]?[...e,'"altInterpretation":true,']:[...e,'"altInterpretation":false,']}e=[...e,'"nested":['];for(let t in i)e=[...e,this.constructFromLinear(i[t])],t<i.length-1&&(e=[...e,","]);e=[...e,"]}  "],a[t]=e.slice()}else{let e=[],r=[],i=!1,n=!1;for(let e in a[t]){const s=a[t][e];if("string"!=typeof s)break;'"'!==s||n?"/"!==s||i?(i||n||(r=[...r,""]),r[r.length-1]+='"'===s&&n?"\\"+s:s):(n=!n,n&&(r=[...r,""])):(i=!i,i&&(r=[...r,""]))}for(let t in r){if("string"!=typeof r[t])break;e=[...e,"  {"],!isNaN(r[t])&&r[t].length>0&&""!==r[t][0]&&""!==r[t][0]?(e=[...e,'"type":"const",'],e=[...e,'"value":'],e=[...e,r[t]]):""===r[t][0]?(e=[...e,'"type":"unclear",'],e=[...e,'"value":2,'],e=[...e,'"symbol":'],e=[...e,'"'+r[t].slice(1)+'"']):(e=[...e,'"type":"var",'],e=[...e,'"value":"*",'],e=[...e,'"symbol":'],e=""===r[t][0]?[...e,'"'+r[t].slice(1)+'"']:[...e,'"'+r[t]+'"']),e=[...e,"}  "],t<r.length-1&&(e=[...e,","])}a[t]=e.slice()}e=[...e,a[t]],t<a.length-1&&(e=[...e,","])}return e=[...e,"]}  "],e}static jsonString(t){const e=this.getValidForm(t);return JSON.stringify(e,void 0,2)}static getVariables(t){const e=this.getValidForm(t);let r=[];return this.traverseForm(e,(function(t){const e=t.space;for(let t in e)"var"===e[t].type&&(i=r,n=e[t].symbol,-1==i.indexOf(n)&&(r=[...r,e[t].symbol]));var i,n})),r.sort()}static traverseForm(t,e){const r=e.apply(this,[t]);if(t.space){if(t.space.length>0)for(let r in t.space)if("form"===t.space[r].type||"reEntry"===t.space[r].type){if(this.traverseForm(t.space[r],e))break}}else if(t.nested){if(t.nested.length>0)for(let r in t.nested){if(this.traverseForm(t.nested[r],e))break}}else console.log("ERROR: Not a form!");return r}static getTotalVars(t){return this.getVariables(t.substr()).length}static reOrderVars(t,e){return this.decodeVars(this.encodeVars(t,e))}static decodeVars(t,e){let r=a;if(e){const t=Object.keys(a),i=t.slice(0,e.length),n=t.slice(-3);r=i.concat(n).reduce((t,r,i)=>({...t,[r]:i<e.length?e[i]:a[r]}),{})}return t.split("").map(t=>Object.keys(r).indexOf(t)>-1?r[t]:t).join("")}static encodeVars(t,e){function r(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}e||(e=this.getVariables(t));const i="alt(?=|)",n="2r(?=|)",o="2r+1(?=|)";return e.reduce((t,e,l)=>t.replace(new RegExp(i,"g"),s.alt).replace(new RegExp(n,"g"),s["2r"]).replace(new RegExp(o,"g"),s["2r+1"]).replace(new RegExp((t=>t.length>1?`"${r(t)}"`:""+r(t))(e),"g"),Object.keys(a)[l]),t)}static matchDefaultVarOrder(t){return"ELR"===t.join("")?["L","E","R"]:"+-LR"===t.join("")?["-","L","R","+"]:"+-ELR"===t.join("")?["-","L","E","R","+"]:t}static isValidForm(t,e){return"string"==typeof t?isValidFormula(t,e):isValidJSONForm(t,e)}static isValidFormula(t,e){let r=[o(()=>"string"==typeof t,"Formula input is not of type string")];if(t.length>0&&(r=[...r,o(()=>!!l(t,'"')&&!!l(t,"/"),'Number of quotes for literal variables (e.g.: "x") or number of slashes for unclear FORMs (e.g.: /x/) don\'t match')]),r.every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})),t.length>0){const e=l(l(t,'"'),"/");[o(()=>c(e,"(",")"),"Number or opening/closing order of parantheses in formula don't match"),o(()=>c(e,"{","}"),"Number or opening/closing order of curly brackets in formula don't match")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}));const r=u(e,{open:"(",close:")"}),i=u(e,{open:"{",close:"}"});[o(()=>r.every(t=>c(t,"{","}"))&&i.every(t=>c(t,"(",")")),"Opening/closing of parantheses overlaps with opening/closing of curly brackets in formula (e.g.: ({a)b})"),o(()=>i.every(t=>this.isValidReEntry(t)),"Option part of one or more re-entry constructions is not well-formed")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}return!0}static isValidReEntry(t,e){const r=t.slice(1,-1).split("|");if(r.length>1){const t=r.filter((t,e,r)=>e<r.length-1),e=["alt","open","2r","2r+1"],i=t.reduce((t,r)=>[...t,e.filter(t=>r===t)[0]],[]).filter(t=>t),n=[...new Set(i)];return[o(()=>n.length===t.length,"One or more re-entry constructions have invalid or duplicate options"),o(()=>n.filter(t=>t===e[2]||t===e[3]).length<2,"One or more re-entry constructions have both options 2r and 2r+1 set at the same time")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}return!0}static isValidJSONForm(t,e){return[o(()=>!0,"")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}static formMatchesVarList(t,e){const r=this.getVariables(t);if(!(e.length===r.length&&r.every(t=>e.some(e=>t===e))))throw new Error("FORM doesn't match the given variable list");return!0}static getValidForm(t){if("string"==typeof t){if(!this.isValidFormula(t))throw new Error("Input is not a valid formula");return this.parseLinear(t)}return t}}var p=r(0),d=r(3),y=r.n(d);const m={width:window.innerWidth,height:window.innerHeight,margin:{left:10,right:10,top:10,bottom:10}};function g(t,e){p.select(t.node().parentElement).attr("width",t.node().getBBox().width+e.left+e.right).attr("height",t.node().getBBox().height+e.top+e.bottom)}function v(t){const e=t.ancestors().filter(t=>"form"===t.data.type&&t.data.unmarked||"reEntry"===t.data.type&&t.data.lastOpen).length;return t.depth-e}function b(t){return e=>{e.each((function(e){const r="string"==typeof t(e)?t(e).split("_"):"";2===r.length?(p.select(this).append("tspan").text(t=>r[0]),p.select(this).append("tspan").text(t=>r[1]).attr("dx",1).attr("dy",6).style("font-size",".8em")):p.select(this).text(t(e))}))}}function x(t,e="inherit",r="inherit",i="normal"){if(p){var n=p.select("body").append("svg");n.append("text").style("font-size",e).style("font-style",i).style("font-family",r).attr("x","-9999").attr("y","-9999").call(b(()=>t));var s=n.node().getBBox();return n.remove(),{width:s.width,height:s.height}}}function w(t,e,r){return function(t,e){let r=0,i=1,n=Math.round(e),s=n;for(;t%n>.3&&(s+=.001*i,t%s<t%n&&(n=s),r>=5e3&&(s=Math.round(e),i=-1),!(r>=1e4));)r++;return n}(2*Math.PI*t,e)*r}function E(t,e,r){let i="";for(let n in r)i=i.concat(w(t,e,r[n])+"px ");return i}const P={common:{font:{family:"sans-serif",size:"14px",style:"normal"},fontVar:{family:"sans-serif",size:"14px",style:"italic"},fontConst:{family:"courier, monospace",size:"14px",style:"normal"},fontContext:{family:"sans-serif",size:"10px",style:"normal"},strokeWidth:1,labels:{reEven:"2|r|",reOdd:"2|r|+1"},color:{base:p.color("black"),ground:p.color("white"),indef:p.color("red"),light:p.color("#ddd")}}};P.basic={...P.common,font:{...P.common.font,family:"georgia, serif"},fontVar:{...P.common.fontVar,family:"georgia, serif",style:"italic"},fontConst:{...P.common.fontConst,family:"georgia, serif"},fontContext:{...P.common.fontContext,family:"courier, monospace"}},P.gestalt={...P.common,font:{...P.common.font,family:"arial, sans-serif"},fontVar:{...P.common.fontVar,family:"arial, sans-serif"},fontConst:{...P.common.fontConst,family:"arial, sans-serif"},fontContext:{...P.common.fontContext,family:"georgia, serif"},color:{...P.common.color,pos:p.color("white"),neg:p.color("black")}};const[S,k]=[P.basic,P.gestalt];function C(t){t.attr("stroke","none").attr("fill","none")}const B={common:{nodeSize:{w:10,h:10},nodeSeparation:{hz:20,vt:40},dashes:{link:"4px 6px"}}};B.basic={...S,...B.common},B.basic.applyAxisStyles=function(t){t.selectAll(".tick").select("line").style("stroke-width",1.5*this.nodeSize.w).style("stroke","rgba(0,0,0,.05").style("stroke-linecap","round"),t.selectAll(".tick").select("text").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("fill",this.color.base.toString()).attr("text-anchor","start")},B.basic.applyNodeStyles=function(t,e){const[r,i,n,s,a,o,l,h,u,c]=e;n.selectAll("circle").style("stroke",this.color.base.toString()).style("fill",this.color.ground.toString()),l.selectAll("circle").style("fill",this.color.base.toString()),s.selectAll("circle").style("stroke",this.color.indef.toString()).style("fill",this.color.indef.toString()).filter(t=>t.data.lastOpen).style("fill",this.color.ground.toString()),a.selectAll("circle").style("stroke",this.color.indef.toString()).style("stroke-dasharray",t=>E(t.r,3,[1])),o.selectAll("circle").style("fill",this.color.indef.toString()),t.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("fill",this.color.base.toString()),h.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),u.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),i.selectAll("circle.inner").style("stroke","none").style("fill",this.color.base.toString())},B.basic.applyLinkStyles=function(t,e){const[r,i]=e;t.selectAll("path").style("stroke",this.color.base.toString()),r.selectAll("path").style("stroke",this.color.indef.toString()).style("stroke-dasharray",this.dashes.link),i.selectAll("path").style("stroke",this.color.indef.toString()).style("stroke-dasharray",this.dashes.link)};const M={common:{radius:14,padding:14}};M.basic={...S,...M.common},M.basic.applyNodeStyles=function(t,e){const[r,i,n,s,a,o,l,h,u,c]=e;n.select("circle").style("stroke",this.color.base.toString()).filter(t=>t.data.unmarked).style("stroke","none"),s.select("circle").style("stroke",this.color.indef.toString()).filter(t=>t.data.lastOpen).style("stroke-dasharray",t=>E(t.r,14,[.4,.6])),l.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("text-anchor","middle").style("fill",this.color.base.toString()),h.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),u.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),c.select("rect").style("fill",this.color.light.toString()),o.select("circle").style("fill",this.color.indef.toString()).style("stroke","none");s.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",this.color.indef.toString())},M.gestalt={...k,...M.common},M.gestalt.invertFill=function(t){return v(t)%2?this.color.pos.toString():this.color.neg.toString()},M.gestalt.applyNodeStyles=function(t,e,r){const[i,n,s,a,o,l,h,u,c,f]=e,d=p.select(r.node().parentNode).append("defs"),y=d.append("radialGradient").attr("id","grad-indef-outin").attr("fx","20%");y.append("stop").attr("offset","40%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.3),y.append("stop").attr("offset","90%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.8),y.append("stop").attr("offset","100%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",1);const m=d.append("radialGradient").attr("id","grad-indef-inout").attr("fx","20%");m.append("stop").attr("offset","10%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",1),m.append("stop").attr("offset","50%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.6),m.append("stop").attr("offset","60%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.4),m.append("stop").attr("offset","100%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",0),s.select("circle").filter(t=>!t.data.unmarked).style("stroke","none").style("fill",t=>this.invertFill(t)),a.select("circle").style("stroke",t=>"reEntry"===t.parent.data.type?this.color.pos.toString():"none").style("fill","url(#grad-indef-outin)");const g=a.select("circle").filter(t=>t.data.lastOpen).style("fill","url(#grad-indef-inout)").style("stroke-dasharray",t=>E(t.r,8,[.4,.6]));g.filter(t=>"reEntry"!==t.parent.data.type||!v(t)%2).style("stroke",t=>this.color.indef.toString()),g.filter(t=>"reEntry"===t.parent.data.type&&!t.parent.data.lastOpen).style("stroke",t=>this.color.pos.toString()),h.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("text-anchor","middle").style("stroke","none").style("fill",t=>this.invertFill(t)),u.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),c.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),f.select("rect").style("fill",this.color.light.toString()),f.select("text").style("fill",this.color.base.toString()),l.select("circle").style("fill",this.color.indef.toString()).style("stroke","none").filter(t=>"reEntry"===t.parent.data.type).style("stroke",this.color.indef.toString()).style("fill",this.color.pos.toString()).attr("transform","scale(1.5)");a.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",t=>"reEntry"!==t.parent.data.type||t.parent.data.lastOpen?this.color.indef.toString():this.color.pos.toString());a.select(".label.inside").style("fill",t=>"reEntry"!==t.parent.data.type&&t.data.lastOpen?this.color.indef.toString():this.color.pos.toString())};const V={common:{elemMargin:{hz:12,vt:8},formMargin:{top:10,right:10},formPadding:{hz:0},minFormSize:{width:34,height:34},maxLineWidth:1e4,strokeWidth:1.1}};V.basic={...S,...V.common},V.basic.applyNodeStyles=function(t,e){const[r,i,n,s,a,o,l,h,u,c]=e;i.select("polyline").style("fill","none").style("stroke",this.color.base.toString()).style("stroke-width",this.strokeWidth),n.select("polyline").filter(t=>t.data.unmarked).style("stroke","none"),l.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("fill",this.color.base.toString()),h.select("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),u.select("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),s.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",this.color.base.toString()),c.select(".unclearMark").style("fill",this.color.light.toString()),c.select("text").style("font-size",this.fontVar.size).style("font-style","normal").style("font-family",this.fontVar.family).style("stroke","none").style("fill",this.color.base.toString())};class A{constructor(t,e,r,...i){const n=function(t,e=m){const r=Object.assign({},e,t);return t.parentId?r.parent=p.select("#"+t.parentId):r.parent=p.select("body"),r.svg=r.parent.append("svg").lower().attr("id",r.id||"chart").attr("width",r.width-r.margin.right).attr("height",r.height-r.margin.bottom),t.styleClass&&r.svg.attr("class",t.styleClass),r.svg.append("rect").attr("id","background").attr("width","100%").attr("height","100%").attr("fill",t.drawBackground?"#ffffff":"none"),r.container=r.svg.append("g").attr("id","container").attr("transform",`translate(${r.margin.left}, ${r.margin.top})`),r}({margin:{left:50,right:50,top:50,bottom:50},padding:{left:10,right:10,top:10,bottom:10},styleClass:"basic",...r});Object.assign(this,n),this.innerHeight=this.height-this.margin.top-this.margin.bottom-this.padding.top-this.padding.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right-this.padding.left-this.padding.right,this.constructor[t].call(this,e,...i)}static tree(t){const e=this.container,r=p.hierarchy(t,t=>t.space),i=B[this.styleClass],[n,s]=[i.nodeSize,i.nodeSeparation],[a,o]=[i.font.size,i.font.family];this.padding={left:10,right:10,top:10,bottom:10},r.dx=n.w+s.hz,r.dy=this.width/(r.height+1);const l=p.tree().nodeSize([r.dx,r.dy]).separation((t,e)=>t.parent==e.parent?1:2)(r);let h=1/0,u=-h;l.each(t=>{t.x>u&&(u=t.x),t.x<h&&(h=t.x)});const c=r.data.unmarked,f=1.8*n.h,d=f;this.height=u-h+2*this.padding.top+n.h+2+d,this.svg.attr("width",this.width).attr("height",this.height),C(this.svg),e.classed("graph-tree",!0).attr("transform",`translate(${this.padding.left+n.w/2+(r.data.unmarked?-r.dy:0)},${this.padding.top-h+n.h/2})`);const y=p.range(r.height+(c?0:1));this.depthScale=p.scaleOrdinal().domain(y).range(y.map(t=>(t+(c?1:0))*r.dy));const m=p.axisBottom().scale(this.depthScale).tickSizeInner(-(u-h)).tickSizeOuter(0).tickPadding(f).tickValues(this.depthScale.domain().map(t=>this.depthScale.domain().length<15?"Depth "+t:t)),v=e.append("g").classed("depthAxis",!0).attr("transform",`translate(0, ${u})`).call(m);v.select(".domain").remove();const x=e.selectAll(".link").data(l.links()).enter().append("g").classed("link",!0),w=e.selectAll(".node").data(l.descendants()).enter().append("g").classed("node",!0).attr("transform",t=>`translate(${t.y},${t.x})`);c&&(x.filter(t=>0===t.source.depth).remove(),w.filter(t=>0===t.depth).remove());const E=function(t,e){const r=e.filter(t=>t.target.data.reChild).classed("reChildLink",!0),i=e.filter(t=>"reEntryPoint"===t.target.data.type).classed("rePointLink",!0);return[r,i]}(0,x),[P,S]=E,k=N(l,w),[M,V,A,T,O,D,z,I,R,F]=k;p.line().curve(p.curveBasis);x.append("path").attr("d",p.linkHorizontal().x(t=>t.y).y(t=>t.x)),w.filter(t=>!t.data.unmarked).append("circle").attr("r",n.w/2),D.append("text").attr("x",n.w/2+2).text(t=>{let e=t.parent,r=0;for(;"reEntry"!==e.data.type;){if(e=e.parent,r>1e3)return null;r++}return"undefined"!==e.data.reEven?e.data.reEven?"2|r|":"2|r|+1":""}),z.selectAll("circle").attr("r",n.w/2/2),w.append("text").attr("x",n.w/2+2),I.selectAll("text").call(b(t=>t.data.symbol)),R.selectAll("text").text(t=>"= "+t.data.value),F.selectAll("text").text(t=>`/${t.data.symbol}/`),V.filter(t=>t.children).append("circle").classed("inner",!0).attr("r",n.w/2/2),i.applyAxisStyles(v),i.applyLinkStyles(x,E),i.applyNodeStyles(w,k),g(e,this.padding)}static pack(t){const e=this.container;C(this.svg);const r=p.hierarchy(t,t=>t.space).sum(t=>t.children?0:1),i=M[this.styleClass],[n,s]=[i.radius,i.padding],[a,o]=[i.font.size,i.font.family],l=p.pack().padding(t=>{let e=s;return"form"===t.data.type&&1===t.children.length&&"form"===t.children[0].data.type&&(e*=.4),t.data.unmarked&&1===t.children.length&&(e=0),e}).radius(t=>{let e=n;return"string"==typeof t.data.symbol?(e=x(t.data.symbol,a,o).width/2,"unclear"===t.data.type&&(e+=2*s)):t.data.value?e=x(t.data.value+"",a,o).width/2:(t.data.children||"reEntryPoint"===t.data.type||"space"===t.data.type)&&(e=0),e})(r);e.attr("class","graph-pack").attr("transform",`translate(${l.r+this.padding.left},${l.r+this.padding.top})`);const h=e.selectAll(".node").data(l.descendants()).enter().append("g").classed("node",!0).attr("transform",t=>`translate(${t.x},${t.y})`),u=N(l,h),[c,f,d,y,m,v,w,E,P,S]=u;f.append("circle").attr("r",t=>t.r),E.append("text").call(b(t=>t.data.symbol)),P.append("text").text(t=>t.data.value),S.append("rect").attr("transform",t=>`skewX(-30) translate(${-(t.r-s)},\n            ${-(x("x",a,o).height+2*s)/2})`).attr("width",t=>2*t.r-2*s).attr("height",t=>x("x",a,o).height+2*s),S.append("text").call(b(t=>t.data.symbol)),v.append("circle").attr("r",1.5),y.filter(t=>"undefined"!==t.data.reEven).call(function(t,e="inherit",r="inherit",i="normal"){return n=>{n.each((function(n){const s=x(t(n),e,r);p.select(this).append("text").style("font-size",e).style("font-style",i).style("font-family",r).style("text-anchor","middle").raise().text(e=>t(e)),p.select(this).filter(t=>2*t.r>=s.width+50).select("text").classed("label inside",!0).attr("y",t=>t.r-.5*s.height).attr("dominant-baseline","baseline"),p.select(this).filter(t=>2*t.r<s.width+50).select("text").classed("label outside",!0).attr("y",t=>t.r+4).attr("dominant-baseline","hanging")}))}}(t=>t.data.reEven?"2|r|":"2|r|+1",i.fontContext.size,i.fontContext.family)),i.applyNodeStyles(h,u,e),g(e,this.padding)}static gsbhooks(t){const e=this.container;C(this.svg);const r=p.hierarchy(t,t=>t.space).sum(t=>t.space?0:1);this.styleClass="basic";const i=null===this.compactChecked||this.compactChecked,n=V[this.styleClass],{elemMargin:s,formMargin:a,formPadding:o,minFormSize:l,maxLineWidth:h,fontVar:u,fontConst:c,fontContext:f,labels:d}={...n},m=s.hz/2,v=s.vt,w=y()().vAlign("bottom").edgeMargins(t=>!(T(t)&&!t.parent.parent&&t.parent.data.unmarked)).isContainer(t=>T(t)).padding(t=>{let e={left:0,right:0,top:0,bottom:0};if(T(t)&&(e.left=e.right=o.hz,"reEntry"===t.data.type)){const r=x(t.data.reEven?d.reEven:d.reOdd,f.size,f.family,f.style);e.bottom=r.height+s.vt/2}return e}).margin(t=>{let e={left:0,right:0,top:0,bottom:0};return T(t)?(e.top=a.top,e.right=a.right,0===t.depth&&(e.top=0),t.data.reChild&&(1===t.parent.children.length&&(e.right=l.width),t.parent.data.lastOpen&&(e.top=0),i&&t.parent.data.reChild&&("reEntryPoint"===t.children[0].data.type&&O(t)||(e.top=0)))):"reEntryPoint"!==t.data.type?(e.top=e.bottom=s.vt,e.left=e.right=s.hz,"italic"==u.style&&(e.right+=1),"unclear"===t.data.type&&(e.bottom=0)):"reEntryPoint"===t.data.type&&(e.right=a.right),e}).spanHeight(t=>{let e=!1;return i&&t.data.reChild&&(e=!0),e}).minContainerSize(t=>{let e=l.width,r=l.height;if(t.data.reChild&&1===t.children.length&&"reEntryPoint"===t.children[0].data.type&&O(t)&&(e=l.width/2),"reEntry"===t.data.type&&t.children.length<=2&&"reEntryPoint"===t.children[0].data.type){e=x(t.data.reEven?d.reEven:d.reOdd,f.size,f.family,f.style).width+8,e=e<l.width?l.width:e}return{width:e,height:r}}).maxLineWidth(t=>h).nodeSize(t=>{let e=0,r=0;if("var"===(i=t).data.type||"const"===i.data.type||"unclear"===i.data.type){let i=void 0;switch(t.data.type){case"var":i=x(t.data.symbol,u.size,u.family,u.style),e=i.width,r=.7*i.height;break;case"unclear":i=x(t.data.symbol,u.size,u.family,"normal"),e=i.width,r=.7*i.height,e+=2*D(r+2*v)+2*m,r+=2*v;break;case"const":i=x(t.data.value,c.size,c.family,c.style),e=i.width,r=.7*i.height}}var i;return{width:e,height:r}})(r);e.attr("class","graph-boxmodel").attr("transform",`translate(${this.padding.left},${this.padding.top})`);const E=e.selectAll(".node").data(w.descendants()).enter().append("g").classed("node",!0).attr("transform",t=>`translate(${t.x0},${t.y0})`),P=N(w,E),[S,k,B,M,A,z,I,R,F,$]=P;B.append("polyline").attr("points",t=>`0,0 ${t.x1-t.x0},0 ${t.x1-t.x0},${t.y1-t.y0}`),M.append("polyline").attr("points",t=>{const e=t.x1-t.x0,r=t.y1-t.y0;return`0,0 ${e},0 ${e},${r} 0,${r} 0,${r-l.height}`}).filter(t=>t.data.lastOpen).attr("points",t=>{const e=t.x1-t.x0,r=t.y1-t.y0,i=l.height;return`${e},${r-i} ${e},${r} 0,${r} 0,${r-i}`}),M.filter(t=>"undefined"!==t.data.reEven).append("text").classed("label",!0).attr("transform",t=>`translate(0,${t.y1-t.y0})`).attr("x",t=>4).attr("y",t=>-5).text(t=>t.data.reEven?d.reEven:d.reOdd);const L=t=>D(.7*(t=>x(t.data.symbol,u.size,u.family,"normal"))(t).height+2*v);$.append("rect").classed("unclearMark",!0).attr("transform",t=>`skewX(-30) translate(${L(t)},0)`).attr("width",t=>t.x1-t.x0-L(t)).attr("height",t=>t.y1-t.y0),$.append("text").attr("x",t=>L(t)+m).attr("y",t=>t.y1-t.y0-v-(t.data.symbol.split("_").length>1?6:0)).call(b(t=>t.data.symbol)),F.append("text").attr("y",t=>t.y1-t.y0).text(t=>t.data.value),R.append("text").attr("y",t=>t.y1-t.y0).call(b(t=>t.data.symbol)),n.applyNodeStyles(E,P,e),g(e,this.padding)}static force(t){}}function N(t,e){const r=e.filter(e=>t.leaves().filter(t=>t===e).pop()).classed("leaf",!0),i=e.filter(t=>"form"===t.data.type||"reEntry"===t.data.type).classed("form",!0),n=i.filter(t=>"form"===t.data.type).classed("form",!0),s=i.filter(t=>"reEntry"===t.data.type).classed("reEntry",!0),a=e.filter(t=>!("form"===t.data.type||"reEntry"===t.data.type)).classed("element",!0),o=a.filter(t=>"var"===t.data.type).classed("var",!0);let l=a.filter(t=>"const"===t.data.type).classed("const",!0);l.unmarked=a.filter(t=>0==t.data.value).classed("unmarked",!0),l.marked=a.filter(t=>1==t.data.value).classed("marked",!0),l.indef=a.filter(t=>2==t.data.value).classed("indef",!0),l.imag=a.filter(t=>3==t.data.value).classed("imag",!0);const h=a.filter(t=>"unclear"===t.data.type).classed("unclear",!0),u=n.filter(t=>t.data.reChild).classed("reChild",!0);return[r,i,n,s,u,a.filter(t=>"reEntryPoint"===t.data.type).classed("reEntryPoint",!0),a,o,l,h]}function T(t){return"form"===t.data.type||"reEntry"===t.data.type}function O(t){return t.ancestors().filter(t=>"reEntry"===t.data.type).shift().data.lastOpen}function D(t,e=30){return Math.tan(e*(Math.PI/180))*t}const z=r(1);const I=r(1);e.default={calc:i,form:f,graph:class extends f{constructor(){}static jsonString(t){const e=this.expand_reEntry(t);return super.jsonString(e)}static createGraph(t,e,r){const i="pack"===t,n=this.expand_reEntry(e,{addEmptyReChildSpace:i}),s=new A(t,n,r);return s.formula=e,s}static constructNested(t,e={}){let r=t.space=[];t.nested.reverse();for(let i in t.nested){if(i>0){r.unshift({type:"form",reChild:!0,space:[]});const e=r[0];t.nested[i].unmarked?e.space.push(...t.nested[i].space):e.space.push(t.nested[i]),r=e.space}else t.nested[i].unmarked?r.push(...t.nested[i].space):r.push(t.nested[i]);e.addEmptyReChildSpace&&0===r.length&&r.push({type:"space"})}let i=t;if(t.space.length>0)for(;i.space[0].hasOwnProperty("reChild")&&(i=i.space[0],!(i.space.length<1)););return t.lastOpen?(i.space.unshift({type:"form",reChild:!0,space:[]}),i.space[0].space.unshift({type:"reEntryPoint"})):i.space.unshift({type:"reEntryPoint"}),delete t.nested,t}static expand_reEntry(t,e={}){const r=this.getValidForm(t),i=JSON.parse(JSON.stringify(r));let n=0;return this.traverseForm(r,(function(t){t.runningIndex=n,n++})),n=0,this.traverseForm(i,(function(t){t.runningIndex=n,n++})),this.traverseForm(r,(function(t){"reEntry"===t.type&&this.traverseForm(i,(function(r){if(JSON.stringify(t)===JSON.stringify(r)&&t.runningIndex===(r.hasOwnProperty("runningIndex")?r.runningIndex:null))return r=this.constructNested(r,e),!0}))})),this.traverseForm(i,(function(t){delete t.runningIndex})),i}},dna:class extends f{constructor(){}static calcAll(t){if(t.includes("::")&&this.isValidDNA(t)){const e=t.split(":").pop(),r=e.split("").reverse(),i=this.totalVarsFromDNA(e),s=Array.from({length:i},(t,e)=>`"x_${e}"`),a={};if(i<1)return a.Result=parseInt(r[0]),a;const o=s.join()+";";for(let t=0;t<r.length;t++){const e=n(t.toString(4),i);e.split("").map((t,e)=>({var:s[e],value:parseInt(t)}));a[o+e]=r[t]}return a}return super.calcAll(t)}static getVariables(t){if("string"==typeof t&&t.includes("::")){const{dna:e,formula:r,varList:i}=this.getDNAparts(t);if(void 0!==i)return i;if(void 0!==r)return super.getVariables(r);const n=this.totalVarsFromDNA(e);return Array.from({length:n},(t,e)=>"x_"+e)}return super.getVariables(t)}static encode(t,e){const r=e?this.reOrderVars(t,e):t;return Object.values(this.calcAll(r)).reverse().join("")}static decode(t,e){if(e&&e.length!==this.totalVarsFromDNA(t))throw new Error("Number of variables in given variable list doesn't match formDNA code length");e||(e=this.generateVarNames(this.totalVarsFromDNA(t)));const r=this.universe_n(e),i=t.split("").reverse();return r.map((t,e)=>`((${i[e]})(${t}))`).join("")}static intToDNA(t,e){const r=t.toString(4);if("-"===r.substr(0,1))throw new Error("Negative integers cannot be converted to formDNA.");if(r.includes("."))throw new Error("Fractional numbers cannot be converted to formDNA.");const i=e?4**e:function t(e,r=0){return 4**r>=e?4**r:t(e,r+1)}(r.length);if(r.length>i)throw new Error("Integer size exceeds desired DNA length.");return n(r,i)}static formToDNA(t,e,r){const{output:i}={output:void 0,...r};let n=void 0,s=void 0,a=void 0;if(t.includes("::")){if(!this.isValidDNA(t))throw new Error("Input is not valid formDNA");const e=this.getDNAparts(t);n=e.dna,s=e.formula,a=e.varList}else n=this.encode(t,e||void 0),s=t,a=e||this.getVariables(s);switch(i){case"text":return(void 0!==s?s:"")+(a&&n.length>1?`.[${a.join(",")}]`:"")+"::"+n;case"num":return n;default:return[s,a,n]}}static dnaToFORM(t,e,r){return this.decode(t,e)}static genRandomDNA(t){const e=I(4).pow(I(4).pow(t)),r=(i=e.subtract(1),z.randBetween(0,i));var i;return this.intToDNA(r,t)}static vmap(t,e,r){const{limitSize:i,convDefaultVarorder:n,size:s,gapGrow:a,marginFunc:o,strokeW:l}={limitSize:!0,convDefaultVarorder:!0,size:void 0,gapGrow:1.5,marginFunc:void 0,strokeW:.5,...r};let h=void 0,u=t;if(t.includes("::")&&this.isValidDNA(t)){const r=this.getDNAparts(t);h=r.dna,u=r.formula;const i=r.varList?r.varList:this.getVariables(t);if(void 0!==e&&void 0!==i&&(f=i,void 0===(c=e)||void 0===f||c.length!==f.length||!c.every(t=>f.some(e=>t===e))))throw new Error("Variable order is specified in the formDNA input and as an argument for the vmap function and they are different. Please select only one specification to avoid conflicting results.");i?e=i:u&&(e=this.getVariables(u))}else e||(e=this.getVariables(u),n&&(e=this.matchDefaultVarOrder(e)));var c,f;h||(h=this.encode(u,e));const p=this.totalVarsFromDNA(h);if(NaN===p)throw new Error("Invalid variable number for vmaps.");if(i&&p>8)throw new Error('vmaps with more than 8 variables are too computationally intensive to be rendered with this implementation. If you still want to proceed, add the option "limitSize: false" to your vmap function call (using the formform library).');const d=h.split("").reverse().join(""),y=s||(t=>{const e=17-(t>3?2*(t-3):0);return Math.max(2,e)})(p),m=[l,...Array.from({length:p-1},o||((t,e)=>(e+1)*a))],g={w:y,h:y};return{tree:this.constructVmap(d,p,g,m),input:t,varorder:e,options:r}}static vmapPerspectives(t,e,r,i){const{limitSize:n}={limitSize:!0,...r};if("string"==typeof t&&t.includes("::"))throw new Error("formDNA input is not yet supported for vmap perspectives.");void 0===e&&(e=this.matchDefaultVarOrder(this.getVariables(t)));const s=e.length;if(n&&s>5)throw new Error('Rendering all the perspectives for vmaps with more than 5 variables is too computationally intensive with this implementation. You can, however, still compute single permutations by changing the variable order of your FORM. If you still want to proceed, add the option "limitSize: false" to your vmapPerspectives function call (using the formform library).');const a=t;var o;return(o=e,o.reduce((function t(e,r,i,n){return e.concat(n.length>1&&n.slice(0,i).concat(n.slice(i+1)).reduce(t,[]).map((function(t){return[r].concat(t)}))||[[r]])}),[])).map(t=>this.vmap(a,t,{hideInputLabel:!0,customLabel:void 0,...i}))}static vmapList(t,e){return t.map(t=>this.vmap(t[0],t[1],{...t[2],...e}))}static constructVmap(t,e,r,i){const n=(t,e)=>t%2*(void 0!==e?e:0),s=(t,e)=>+(t>0&&t<3)*(void 0!==e?e:0),a=(t,r,i,o,l=0)=>{const h={},u=((t,e)=>e.slice(1,t).reverse().reduce((t,e,r)=>t+2**r*e,0))(r,o),c=4**r,f=Math.sqrt(c);if(t=t.substr(l*c,c),h.data={dna:"::"+t.split("").reverse().join(""),vnum:r,cell:i,margins:e>0?o.slice(0,r):o.slice(0,1)},h.height=r,h.depth=e-Math.log(c)/Math.log(4),h.order=l,h.position=[n(l,f*i.w)+n(l,u)+n(l,o[r]),s(l,f*i.h)+s(l,u)+s(l,o[r])],h.scale=[f*i.w+u,f*i.h+u],0===e)return h.value=t,h;h.children=[];for(let e=0;r>0&&e<4||0===r&&e<1;e++)if(r>1)h.children=[...h.children,a(t,r-1,i,o,e)];else{const a=t.substr(e,1);h.children=[...h.children,{data:{dna:"::"+a,vnum:0,cell:i,margins:o.slice(0,1)},value:a,height:r-1,depth:h.depth+1,order:e,position:[n(e,i.w),s(e,i.h)],scale:[i.w,i.h]}]}return h};return a(t,e,r,i)}static dnaMatchesForm(t,e,r,i){const n=r||super.getVariables(e);return(r?[o(()=>this.formMatchesVarList(e,n),"FORM doesn't match the given variable list"),o(()=>n.length===this.totalVarsFromDNA(t),"Number of variables in given variable list doesn't match formDNA code length"),o(()=>this.encode(e,n)===t,"formDNA code is inconsistent with FORM interpretation results (respecting specified variable order)")]:[o(()=>n&&n.length===this.totalVarsFromDNA(t),"Number of FORM variables doesn't match formDNA code length"),o(()=>this.encode(e)===t,"formDNA code is inconsistent with FORM interpretation results")]).every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}static isValidDNA(t,e){const{compareForm:r,requireMark:i}={compareForm:!0,requireMark:!0,...e},n=i?t:"::"+t;[o(()=>"string"==typeof n,"formDNA input is not of type string"),o(()=>n.includes("::"),"Input does not include the mark :: for formDNA"),o(()=>n.length>=3,"formDNA input is too short")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}));const{dna:s,formula:a,varList:l}=this.getDNAparts(n);return[o(()=>this.totalVarsFromDNA(s)>=0,"formDNA code length is not in the range 4^x"),o(()=>!s.split("").some(t=>isNaN(parseInt(t))||parseInt(t)<0||parseInt(t)>3),"formDNA code is not in quaternion format (consisting only of the numbers 0/1/2/3)"),r&&void 0!==a?o(()=>this.dnaMatchesForm(s,a,l),"formDNA code part doesn't match formula part or formula part doesn't match its specified variable order"):null].filter(t=>t).every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})),!0}static generateVarNames(t,e){return Array.from({length:t},(t,r)=>{let i="x_"+r;if(void 0!==e)for(;e.includes(i);)i+="";return i})}static universe_1(t){return t.length>1&&(t=`"${t}"`),[`({(${t})}{2r|(${t})})`,`({${t}}{2r|${t}})`,`(({(${t})}${t})({2r|${t}}(${t})))`,`(({${t}}(${t}))({2r|(${t})}${t}))`]}static universe_n(t){const e=t.length,r=t.map(t=>this.universe_1(t));return Array.from({length:4**e},(t,i)=>{const s=n(i.toString(4),e).split(""),a=r.reduce((t,e,r,i)=>t+`(${e[s[r]]})`+(r===i.length-1?")":""),"(");return e>1?a:a.slice(2,-2)})}static totalVarsFromDNA(t){const e=t.split(":").pop(),r=Math.log(e.length)/Math.log(4);return r%1==0?r:NaN}static repairDNA(t){if(t.includes("::")){const e=this.getDNAparts(t);if(e.formula){let t=void 0;try{e.varList&&this.formMatchesVarList(e.formula,e.varList)&&(t=e.varList)}catch(t){console.error(t.message)}return this.formToDNA(e.formula,t)}return this.isValidDNA(t)?t:null}return this.formToDNA(t)}static getDNAparts(t){let e=void 0,r=void 0,i=void 0;const n=t.split(":");if(e=n.pop(),n[0].length>0){const t=n[0].split(".");r=t[0],i=t.length>1?t[1].slice(1,-1).split(","):i}return{dna:e,formula:r,varList:i}}}}}]).default}));
//# sourceMappingURL=formform.min.js.map