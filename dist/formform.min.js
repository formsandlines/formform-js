!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.formform=e(require("d3")):t.formform=e(t.d3)}(window,(function(t){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(e,i){e.exports=t},function(t,e,i){(function(t){var r,n=function(t){"use strict";var e=1e7,i=9007199254740992,r=c(i),s="function"==typeof BigInt;function a(t,e,i,r){return void 0===t?a[0]:void 0!==e&&(10!=+e||i)?F(t,e,i,r):U(t)}function o(t,e){this.value=t,this.sign=e,this.isSmall=!1}function l(t){this.value=t,this.sign=t<0,this.isSmall=!0}function h(t){this.value=t}function u(t){return-i<t&&t<i}function c(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function f(t){p(t);var i=t.length;if(i<4&&M(t,r)<0)switch(i){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function p(t){for(var e=t.length;0===t[--e];);t.length=e+1}function d(t){for(var e=new Array(t),i=-1;++i<t;)e[i]=0;return e}function y(t){return t>0?Math.floor(t):Math.ceil(t)}function m(t,i){var r,n,s=t.length,a=i.length,o=new Array(s),l=0,h=e;for(n=0;n<a;n++)l=(r=t[n]+i[n]+l)>=h?1:0,o[n]=r-l*h;for(;n<s;)l=(r=t[n]+l)===h?1:0,o[n++]=r-l*h;return l>0&&o.push(l),o}function g(t,e){return t.length>=e.length?m(t,e):m(e,t)}function v(t,i){var r,n,s=t.length,a=new Array(s),o=e;for(n=0;n<s;n++)r=t[n]-o+i,i=Math.floor(r/o),a[n]=r-i*o,i+=1;for(;i>0;)a[n++]=i%o,i=Math.floor(i/o);return a}function b(t,e){var i,r,n=t.length,s=e.length,a=new Array(n),o=0;for(i=0;i<s;i++)(r=t[i]-o-e[i])<0?(r+=1e7,o=1):o=0,a[i]=r;for(i=s;i<n;i++){if(!((r=t[i]-o)<0)){a[i++]=r;break}r+=1e7,a[i]=r}for(;i<n;i++)a[i]=t[i];return p(a),a}function x(t,e,i){var r,n,s=t.length,a=new Array(s),h=-e;for(r=0;r<s;r++)n=t[r]+h,h=Math.floor(n/1e7),n%=1e7,a[r]=n<0?n+1e7:n;return"number"==typeof(a=f(a))?(i&&(a=-a),new l(a)):new o(a,i)}function w(t,e){var i,r,n,s,a=t.length,o=e.length,l=d(a+o);for(n=0;n<a;++n){s=t[n];for(var h=0;h<o;++h)i=s*e[h]+l[n+h],r=Math.floor(i/1e7),l[n+h]=i-1e7*r,l[n+h+1]+=r}return p(l),l}function E(t,i){var r,n,s=t.length,a=new Array(s),o=e,l=0;for(n=0;n<s;n++)r=t[n]*i+l,l=Math.floor(r/o),a[n]=r-l*o;for(;l>0;)a[n++]=l%o,l=Math.floor(l/o);return a}function P(t,e){for(var i=[];e-- >0;)i.push(0);return i.concat(t)}function S(t,i,r){return new o(t<e?E(i,t):w(i,c(t)),r)}function k(t){var e,i,r,n,s=t.length,a=d(s+s);for(r=0;r<s;r++){i=0-(n=t[r])*n;for(var o=r;o<s;o++)e=n*t[o]*2+a[r+o]+i,i=Math.floor(e/1e7),a[r+o]=e-1e7*i;a[r+s]=i}return p(a),a}function C(t,e){var i,r,n,s,a=t.length,o=d(a);for(n=0,i=a-1;i>=0;--i)n=(s=1e7*n+t[i])-(r=y(s/e))*e,o[i]=0|r;return[o,0|n]}function B(t,i){var r,n=U(i);if(s)return[new h(t.value/n.value),new h(t.value%n.value)];var u,m=t.value,g=n.value;if(0===g)throw new Error("Cannot divide by zero");if(t.isSmall)return n.isSmall?[new l(y(m/g)),new l(m%g)]:[a[0],t];if(n.isSmall){if(1===g)return[t,a[0]];if(-1==g)return[t.negate(),a[0]];var v=Math.abs(g);if(v<e){u=f((r=C(m,v))[0]);var x=r[1];return t.sign&&(x=-x),"number"==typeof u?(t.sign!==n.sign&&(u=-u),[new l(u),new l(x)]):[new o(u,t.sign!==n.sign),new l(x)]}g=c(v)}var w=M(m,g);if(-1===w)return[a[0],t];if(0===w)return[a[t.sign===n.sign?1:-1],a[0]];u=(r=m.length+g.length<=200?function(t,i){var r,n,s,a,o,l,h,u=t.length,c=i.length,p=e,y=d(i.length),m=i[c-1],g=Math.ceil(p/(2*m)),v=E(t,g),b=E(i,g);for(v.length<=u&&v.push(0),b.push(0),m=b[c-1],n=u-c;n>=0;n--){for(r=p-1,v[n+c]!==m&&(r=Math.floor((v[n+c]*p+v[n+c-1])/m)),s=0,a=0,l=b.length,o=0;o<l;o++)s+=r*b[o],h=Math.floor(s/p),a+=v[n+o]-(s-h*p),s=h,a<0?(v[n+o]=a+p,a=-1):(v[n+o]=a,a=0);for(;0!==a;){for(r-=1,s=0,o=0;o<l;o++)(s+=v[n+o]-p+b[o])<0?(v[n+o]=s+p,s=0):(v[n+o]=s,s=1);a+=s}y[n]=r}return v=C(v,g)[0],[f(y),f(v)]}(m,g):function(t,e){for(var i,r,n,s,a,o=t.length,l=e.length,h=[],u=[];o;)if(u.unshift(t[--o]),p(u),M(u,e)<0)h.push(0);else{n=1e7*u[(r=u.length)-1]+u[r-2],s=1e7*e[l-1]+e[l-2],r>l&&(n=1e7*(n+1)),i=Math.ceil(n/s);do{if(M(a=E(e,i),u)<=0)break;i--}while(i);h.push(i),u=b(u,a)}return h.reverse(),[f(h),f(u)]}(m,g))[0];var P=t.sign!==n.sign,S=r[1],k=t.sign;return"number"==typeof u?(P&&(u=-u),u=new l(u)):u=new o(u,P),"number"==typeof S?(k&&(S=-S),S=new l(S)):S=new o(S,k),[u,S]}function M(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var i=t.length-1;i>=0;i--)if(t[i]!==e[i])return t[i]>e[i]?1:-1;return 0}function V(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function A(t,e){for(var i,r,s,a=t.prev(),o=a,l=0;o.isEven();)o=o.divide(2),l++;t:for(r=0;r<e.length;r++)if(!t.lesser(e[r])&&!(s=n(e[r]).modPow(o,t)).isUnit()&&!s.equals(a)){for(i=l-1;0!=i;i--){if((s=s.square().mod(t)).isUnit())return!1;if(s.equals(a))continue t}return!1}return!0}o.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),h.prototype=Object.create(a.prototype),o.prototype.add=function(t){var e=U(t);if(this.sign!==e.sign)return this.subtract(e.negate());var i=this.value,r=e.value;return e.isSmall?new o(v(i,Math.abs(r)),this.sign):new o(g(i,r),this.sign)},o.prototype.plus=o.prototype.add,l.prototype.add=function(t){var e=U(t),i=this.value;if(i<0!==e.sign)return this.subtract(e.negate());var r=e.value;if(e.isSmall){if(u(i+r))return new l(i+r);r=c(Math.abs(r))}return new o(v(r,Math.abs(i)),i<0)},l.prototype.plus=l.prototype.add,h.prototype.add=function(t){return new h(this.value+U(t).value)},h.prototype.plus=h.prototype.add,o.prototype.subtract=function(t){var e=U(t);if(this.sign!==e.sign)return this.add(e.negate());var i=this.value,r=e.value;return e.isSmall?x(i,Math.abs(r),this.sign):function(t,e,i){var r;return M(t,e)>=0?r=b(t,e):(r=b(e,t),i=!i),"number"==typeof(r=f(r))?(i&&(r=-r),new l(r)):new o(r,i)}(i,r,this.sign)},o.prototype.minus=o.prototype.subtract,l.prototype.subtract=function(t){var e=U(t),i=this.value;if(i<0!==e.sign)return this.add(e.negate());var r=e.value;return e.isSmall?new l(i-r):x(r,Math.abs(i),i>=0)},l.prototype.minus=l.prototype.subtract,h.prototype.subtract=function(t){return new h(this.value-U(t).value)},h.prototype.minus=h.prototype.subtract,o.prototype.negate=function(){return new o(this.value,!this.sign)},l.prototype.negate=function(){var t=this.sign,e=new l(-this.value);return e.sign=!t,e},h.prototype.negate=function(){return new h(-this.value)},o.prototype.abs=function(){return new o(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},h.prototype.abs=function(){return new h(this.value>=0?this.value:-this.value)},o.prototype.multiply=function(t){var i,r,n,s=U(t),l=this.value,h=s.value,u=this.sign!==s.sign;if(s.isSmall){if(0===h)return a[0];if(1===h)return this;if(-1===h)return this.negate();if((i=Math.abs(h))<e)return new o(E(l,i),u);h=c(i)}return r=l.length,n=h.length,new o(-.012*r-.012*n+15e-6*r*n>0?function t(e,i){var r=Math.max(e.length,i.length);if(r<=30)return w(e,i);r=Math.ceil(r/2);var n=e.slice(r),s=e.slice(0,r),a=i.slice(r),o=i.slice(0,r),l=t(s,o),h=t(n,a),u=t(g(s,n),g(o,a)),c=g(g(l,P(b(b(u,l),h),r)),P(h,2*r));return p(c),c}(l,h):w(l,h),u)},o.prototype.times=o.prototype.multiply,l.prototype._multiplyBySmall=function(t){return u(t.value*this.value)?new l(t.value*this.value):S(Math.abs(t.value),c(Math.abs(this.value)),this.sign!==t.sign)},o.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():S(Math.abs(t.value),this.value,this.sign!==t.sign)},l.prototype.multiply=function(t){return U(t)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,h.prototype.multiply=function(t){return new h(this.value*U(t).value)},h.prototype.times=h.prototype.multiply,o.prototype.square=function(){return new o(k(this.value),!1)},l.prototype.square=function(){var t=this.value*this.value;return u(t)?new l(t):new o(k(c(Math.abs(this.value))),!1)},h.prototype.square=function(t){return new h(this.value*this.value)},o.prototype.divmod=function(t){var e=B(this,t);return{quotient:e[0],remainder:e[1]}},h.prototype.divmod=l.prototype.divmod=o.prototype.divmod,o.prototype.divide=function(t){return B(this,t)[0]},h.prototype.over=h.prototype.divide=function(t){return new h(this.value/U(t).value)},l.prototype.over=l.prototype.divide=o.prototype.over=o.prototype.divide,o.prototype.mod=function(t){return B(this,t)[1]},h.prototype.mod=h.prototype.remainder=function(t){return new h(this.value%U(t).value)},l.prototype.remainder=l.prototype.mod=o.prototype.remainder=o.prototype.mod,o.prototype.pow=function(t){var e,i,r,n=U(t),s=this.value,o=n.value;if(0===o)return a[1];if(0===s)return a[0];if(1===s)return a[1];if(-1===s)return n.isEven()?a[1]:a[-1];if(n.sign)return a[0];if(!n.isSmall)throw new Error("The exponent "+n.toString()+" is too large.");if(this.isSmall&&u(e=Math.pow(s,o)))return new l(y(e));for(i=this,r=a[1];!0&o&&(r=r.times(i),--o),0!==o;)o/=2,i=i.square();return r},l.prototype.pow=o.prototype.pow,h.prototype.pow=function(t){var e=U(t),i=this.value,r=e.value,n=BigInt(0),s=BigInt(1),o=BigInt(2);if(r===n)return a[1];if(i===n)return a[0];if(i===s)return a[1];if(i===BigInt(-1))return e.isEven()?a[1]:a[-1];if(e.isNegative())return new h(n);for(var l=this,u=a[1];(r&s)===s&&(u=u.times(l),--r),r!==n;)r/=o,l=l.square();return u},o.prototype.modPow=function(t,e){if(t=U(t),(e=U(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var i=a[1],r=this.mod(e);for(t.isNegative()&&(t=t.multiply(a[-1]),r=r.modInv(e));t.isPositive();){if(r.isZero())return a[0];t.isOdd()&&(i=i.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return i},h.prototype.modPow=l.prototype.modPow=o.prototype.modPow,o.prototype.compareAbs=function(t){var e=U(t),i=this.value,r=e.value;return e.isSmall?1:M(i,r)},l.prototype.compareAbs=function(t){var e=U(t),i=Math.abs(this.value),r=e.value;return e.isSmall?i===(r=Math.abs(r))?0:i>r?1:-1:-1},h.prototype.compareAbs=function(t){var e=this.value,i=U(t).value;return(e=e>=0?e:-e)===(i=i>=0?i:-i)?0:e>i?1:-1},o.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=U(t),i=this.value,r=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:M(i,r)*(this.sign?-1:1)},o.prototype.compareTo=o.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=U(t),i=this.value,r=e.value;return e.isSmall?i==r?0:i>r?1:-1:i<0!==e.sign?i<0?-1:1:i<0?1:-1},l.prototype.compareTo=l.prototype.compare,h.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,i=U(t).value;return e===i?0:e>i?1:-1},h.prototype.compareTo=h.prototype.compare,o.prototype.equals=function(t){return 0===this.compare(t)},h.prototype.eq=h.prototype.equals=l.prototype.eq=l.prototype.equals=o.prototype.eq=o.prototype.equals,o.prototype.notEquals=function(t){return 0!==this.compare(t)},h.prototype.neq=h.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=o.prototype.neq=o.prototype.notEquals,o.prototype.greater=function(t){return this.compare(t)>0},h.prototype.gt=h.prototype.greater=l.prototype.gt=l.prototype.greater=o.prototype.gt=o.prototype.greater,o.prototype.lesser=function(t){return this.compare(t)<0},h.prototype.lt=h.prototype.lesser=l.prototype.lt=l.prototype.lesser=o.prototype.lt=o.prototype.lesser,o.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},h.prototype.geq=h.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=o.prototype.geq=o.prototype.greaterOrEquals,o.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},h.prototype.leq=h.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=o.prototype.leq=o.prototype.lesserOrEquals,o.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},h.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},o.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},h.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},o.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},h.prototype.isPositive=l.prototype.isPositive,o.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},h.prototype.isNegative=l.prototype.isNegative,o.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},h.prototype.isUnit=function(){return this.abs().value===BigInt(1)},o.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},h.prototype.isZero=function(){return this.value===BigInt(0)},o.prototype.isDivisibleBy=function(t){var e=U(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},h.prototype.isDivisibleBy=l.prototype.isDivisibleBy=o.prototype.isDivisibleBy,o.prototype.isPrime=function(t){var e=V(this);if(void 0!==e)return e;var i=this.abs(),r=i.bitLength();if(r<=64)return A(i,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var s=Math.log(2)*r.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(s,2):s),o=[],l=0;l<a;l++)o.push(n(l+2));return A(i,o)},h.prototype.isPrime=l.prototype.isPrime=o.prototype.isPrime,o.prototype.isProbablePrime=function(t,e){var i=V(this);if(void 0!==i)return i;for(var r=this.abs(),s=void 0===t?5:t,a=[],o=0;o<s;o++)a.push(n.randBetween(2,r.minus(2),e));return A(r,a)},h.prototype.isProbablePrime=l.prototype.isProbablePrime=o.prototype.isProbablePrime,o.prototype.modInv=function(t){for(var e,i,r,s=n.zero,a=n.one,o=U(t),l=this.abs();!l.isZero();)e=o.divide(l),i=s,r=o,s=a,o=l,a=i.subtract(e.multiply(a)),l=r.subtract(e.multiply(l));if(!o.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(t)),this.isNegative()?s.negate():s},h.prototype.modInv=l.prototype.modInv=o.prototype.modInv,o.prototype.next=function(){var t=this.value;return this.sign?x(t,1,this.sign):new o(v(t,1),this.sign)},l.prototype.next=function(){var t=this.value;return t+1<i?new l(t+1):new o(r,!1)},h.prototype.next=function(){return new h(this.value+BigInt(1))},o.prototype.prev=function(){var t=this.value;return this.sign?new o(v(t,1),!0):x(t,1,this.sign)},l.prototype.prev=function(){var t=this.value;return t-1>-i?new l(t-1):new o(r,!0)},h.prototype.prev=function(){return new h(this.value-BigInt(1))};for(var T=[1];2*T[T.length-1]<=e;)T.push(2*T[T.length-1]);var N=T.length,O=T[N-1];function D(t){return Math.abs(t)<=e}function z(t,e,i){e=U(e);for(var r=t.isNegative(),s=e.isNegative(),a=r?t.not():t,o=s?e.not():e,l=0,h=0,u=null,c=null,f=[];!a.isZero()||!o.isZero();)l=(u=B(a,O))[1].toJSNumber(),r&&(l=O-1-l),h=(c=B(o,O))[1].toJSNumber(),s&&(h=O-1-h),a=u[0],o=c[0],f.push(i(l,h));for(var p=0!==i(r?1:0,s?1:0)?n(-1):n(0),d=f.length-1;d>=0;d-=1)p=p.multiply(O).add(n(f[d]));return p}o.prototype.shiftLeft=function(t){var e=U(t).toJSNumber();if(!D(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var i=this;if(i.isZero())return i;for(;e>=N;)i=i.multiply(O),e-=N-1;return i.multiply(T[e])},h.prototype.shiftLeft=l.prototype.shiftLeft=o.prototype.shiftLeft,o.prototype.shiftRight=function(t){var e,i=U(t).toJSNumber();if(!D(i))throw new Error(String(i)+" is too large for shifting.");if(i<0)return this.shiftLeft(-i);for(var r=this;i>=N;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(e=B(r,O))[1].isNegative()?e[0].prev():e[0],i-=N-1}return(e=B(r,T[i]))[1].isNegative()?e[0].prev():e[0]},h.prototype.shiftRight=l.prototype.shiftRight=o.prototype.shiftRight,o.prototype.not=function(){return this.negate().prev()},h.prototype.not=l.prototype.not=o.prototype.not,o.prototype.and=function(t){return z(this,t,(function(t,e){return t&e}))},h.prototype.and=l.prototype.and=o.prototype.and,o.prototype.or=function(t){return z(this,t,(function(t,e){return t|e}))},h.prototype.or=l.prototype.or=o.prototype.or,o.prototype.xor=function(t){return z(this,t,(function(t,e){return t^e}))},h.prototype.xor=l.prototype.xor=o.prototype.xor;function I(t){var i=t.value,r="number"==typeof i?i|1<<30:"bigint"==typeof i?i|BigInt(1<<30):i[0]+i[1]*e|1073758208;return r&-r}function R(t,e){return t=U(t),e=U(e),t.greater(e)?t:e}function $(t,e){return t=U(t),e=U(e),t.lesser(e)?t:e}function L(t,e){if(t=U(t).abs(),e=U(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var i,r,n=a[1];t.isEven()&&e.isEven();)i=$(I(t),I(e)),t=t.divide(i),e=e.divide(i),n=n.multiply(i);for(;t.isEven();)t=t.divide(I(t));do{for(;e.isEven();)e=e.divide(I(e));t.greater(e)&&(r=e,e=t,t=r),e=e.subtract(t)}while(!e.isZero());return n.isUnit()?t:t.multiply(n)}o.prototype.bitLength=function(){var t=this;return t.compareTo(n(0))<0&&(t=t.negate().subtract(n(1))),0===t.compareTo(n(0))?n(0):n(function t(e,i){if(i.compareTo(e)<=0){var r=t(e,i.square(i)),s=r.p,a=r.e,o=s.multiply(i);return o.compareTo(e)<=0?{p:o,e:2*a+1}:{p:s,e:2*a}}return{p:n(1),e:0}}(t,n(2)).e).add(n(1))},h.prototype.bitLength=l.prototype.bitLength=o.prototype.bitLength;var F=function(t,e,i,r){i=i||"0123456789abcdefghijklmnopqrstuvwxyz",t=String(t),r||(t=t.toLowerCase(),i=i.toLowerCase());var n,s=t.length,a=Math.abs(e),o={};for(n=0;n<i.length;n++)o[i[n]]=n;for(n=0;n<s;n++){if("-"!==(u=t[n])&&(u in o&&o[u]>=a)){if("1"===u&&1===a)continue;throw new Error(u+" is not a valid digit in base "+e+".")}}e=U(e);var l=[],h="-"===t[0];for(n=h?1:0;n<t.length;n++){var u;if((u=t[n])in o)l.push(U(o[u]));else{if("<"!==u)throw new Error(u+" is not a valid character");var c=n;do{n++}while(">"!==t[n]&&n<t.length);l.push(U(t.slice(c+1,n)))}}return q(l,e,h)};function q(t,e,i){var r,n=a[0],s=a[1];for(r=t.length-1;r>=0;r--)n=n.add(t[r].times(s)),s=s.times(e);return i?n.negate():n}function j(t,e){if((e=n(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var i=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return i.unshift([1]),{value:[].concat.apply([],i),isNegative:!1}}var r=!1;if(t.isNegative()&&e.isPositive()&&(r=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:r};for(var s,a=[],o=t;o.isNegative()||o.compareAbs(e)>=0;){s=o.divmod(e),o=s.quotient;var l=s.remainder;l.isNegative()&&(l=e.minus(l).abs(),o=o.next()),a.push(l.toJSNumber())}return a.push(o.toJSNumber()),{value:a.reverse(),isNegative:r}}function X(t,e,i){var r=j(t,e);return(r.isNegative?"-":"")+r.value.map((function(t){return function(t,e){return t<(e=e||"0123456789abcdefghijklmnopqrstuvwxyz").length?e[t]:"<"+t+">"}(t,i)})).join("")}function W(t){if(u(+t)){var e=+t;if(e===y(e))return s?new h(BigInt(e)):new l(e);throw new Error("Invalid integer: "+t)}var i="-"===t[0];i&&(t=t.slice(1));var r=t.split(/e/i);if(r.length>2)throw new Error("Invalid integer: "+r.join("e"));if(2===r.length){var n=r[1];if("+"===n[0]&&(n=n.slice(1)),(n=+n)!==y(n)||!u(n))throw new Error("Invalid integer: "+n+" is not a valid exponent.");var a=r[0],c=a.indexOf(".");if(c>=0&&(n-=a.length-c-1,a=a.slice(0,c)+a.slice(c+1)),n<0)throw new Error("Cannot include negative exponent part for integers");t=a+=new Array(n+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(s)return new h(BigInt(i?"-"+t:t));for(var f=[],d=t.length,m=d-7;d>0;)f.push(+t.slice(m,d)),(m-=7)<0&&(m=0),d-=7;return p(f),new o(f,i)}function U(t){return"number"==typeof t?function(t){if(s)return new h(BigInt(t));if(u(t)){if(t!==y(t))throw new Error(t+" is not an integer.");return new l(t)}return W(t.toString())}(t):"string"==typeof t?W(t):"bigint"==typeof t?new h(t):t}o.prototype.toArray=function(t){return j(this,t)},l.prototype.toArray=function(t){return j(this,t)},h.prototype.toArray=function(t){return j(this,t)},o.prototype.toString=function(t,e){if(void 0===t&&(t=10),10!==t)return X(this,t,e);for(var i,r=this.value,n=r.length,s=String(r[--n]);--n>=0;)i=String(r[n]),s+="0000000".slice(i.length)+i;return(this.sign?"-":"")+s},l.prototype.toString=function(t,e){return void 0===t&&(t=10),10!=t?X(this,t,e):String(this.value)},h.prototype.toString=l.prototype.toString,h.prototype.toJSON=o.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},o.prototype.valueOf=function(){return parseInt(this.toString(),10)},o.prototype.toJSNumber=o.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,h.prototype.valueOf=h.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var H=0;H<1e3;H++)a[H]=U(H),H>0&&(a[-H]=U(-H));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=R,a.min=$,a.gcd=L,a.lcm=function(t,e){return t=U(t).abs(),e=U(e).abs(),t.divide(L(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof o||t instanceof l||t instanceof h},a.randBetween=function(t,i,r){t=U(t),i=U(i);var n=r||Math.random,s=$(t,i),o=R(t,i).subtract(s).add(1);if(o.isSmall)return s.add(Math.floor(n()*o));for(var l=j(o,e).value,h=[],u=!0,c=0;c<l.length;c++){var f=u?l[c]:e,p=y(n()*f);h.push(p),p<f&&(u=!1)}return s.add(a.fromArray(h,e,!1))},a.fromArray=function(t,e,i){return q(t.map(U),U(e||10),i)},a}();t.hasOwnProperty("exports")&&(t.exports=n),void 0===(r=function(){return n}.call(e,i,e,t))||(t.exports=r)}).call(this,i(6)(t))},function(t,e,i){t.exports=function(t,e){"use strict";var i;return t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,function(i){var r;function n(){return document.createElement("canvas")}i.exports,(r=window).DOMParser=window.DOMParser;var s,a=function(i,o,l){if(null!=i||null!=o||null!=l){var h=function(i){var a={opts:i,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,rootEmSize:12,emSize:12,log:function(t){}};1==a.opts.log&&"undefined"!=typeof console&&(a.log=function(t){console.log(t)}),a.init=function(t){var e=0;a.UniqueId=function(){return"canvg"+ ++e},a.Definitions={},a.Styles={},a.StylesSpecificity={},a.Animations=[],a.Images=[],a.ctx=t,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var t=0;t<a.Images.length;t++)if(!a.Images[t].loaded)return!1;return!0},a.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(t){return t.replace(/(?!\u3000)\s+/gm," ")},a.ajax=function(t){var e;return(e=r.XMLHttpRequest?new r.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(e.open("GET",t,!1),e.send(null),e.responseText):null},a.parseXml=function(t){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,n=new Windows.Data.Xml.Dom.XmlLoadSettings;return n.prohibitDtd=!1,e.loadXml(t,n),e}if(!r.DOMParser)return t=t.replace(/<!DOCTYPE svg[^>]*>/,""),(e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t),e;try{var s=i.xmldom?new r.DOMParser(i.xmldom):new r.DOMParser;return s.parseFromString(t,"image/svg+xml")}catch(e){return(s=i.xmldom?new r.DOMParser(i.xmldom):new r.DOMParser).parseFromString(t,"text/xml")}},a.Property=function(t,e){this.name=t,this.value=e},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},a.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},a.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},a.Property.prototype.addOpacity=function(e){var i=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var r=new t(this.value);r.ok&&(i="rgba("+r.r+", "+r.g+", "+r.b+", "+e.numValue()+")")}return new a.Property(this.name,i)},a.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),a.Definitions[t]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(t,e){var i=this.getDefinition();if(null!=i&&i.createGradient)return i.createGradient(a.ctx,t,e);if(null!=i&&i.createPattern){if(i.getHrefAttribute().hasValue()){var r=i.attribute("patternTransform");i=i.getHrefAttribute().getDefinition(),r.hasValue()&&(i.attribute("patternTransform",!0).value=r.value)}return i.createPattern(a.ctx,t)}return null},a.Property.prototype.getDPI=function(t){return 96},a.Property.prototype.getREM=function(t){return a.rootEmSize},a.Property.prototype.getEM=function(t){return a.emSize},a.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},a.Property.prototype.isPixels=function(){if(!this.hasValue())return!1;var t=this.value+"";return!!t.match(/px$/)||!!t.match(/^[0-9]+$/)},a.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var i=this.value+"";if(i.match(/rem$/))return this.numValue()*this.getREM(t);if(i.match(/em$/))return this.numValue()*this.getEM(t);if(i.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(i.match(/px$/))return this.numValue();if(i.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(i.match(/pc$/))return 15*this.numValue();if(i.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(i.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(i.match(/in$/))return this.numValue()*this.getDPI(t);if(i.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(t);var r=this.numValue();return e&&r<1?r*a.ViewPort.ComputeSize(t):r},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var o={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return a.Property.prototype.toTextBaseline=function(){return this.hasValue()?o[this.value]:null},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,i,r,n,s){var o=null!=s?this.Parse(s):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:n=n||o.fontFamily,fontSize:r||o.fontSize,fontStyle:t||o.fontStyle,fontWeight:i||o.fontWeight,fontVariant:e||o.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var i={},r=a.trim(a.compressSpaces(e||"")).split(" "),n={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},s="",o=0;o<r.length;o++)n.fontStyle||-1==t.Styles.indexOf(r[o])?n.fontVariant||-1==t.Variants.indexOf(r[o])?n.fontWeight||-1==t.Weights.indexOf(r[o])?n.fontSize?"inherit"!=r[o]&&(s+=r[o]):("inherit"!=r[o]&&(i.fontSize=r[o].split("/")[0]),n.fontStyle=n.fontVariant=n.fontWeight=n.fontSize=!0):("inherit"!=r[o]&&(i.fontWeight=r[o]),n.fontStyle=n.fontVariant=n.fontWeight=!0):("inherit"!=r[o]&&(i.fontVariant=r[o]),n.fontStyle=n.fontVariant=!0):("inherit"!=r[o]&&(i.fontStyle=r[o]),n.fontStyle=!0);return""!=s&&(i.fontFamily=s),i}},a.ToNumberArray=function(t){for(var e=a.trim(a.compressSpaces((t||"").replace(/,/g," "))).split(" "),i=0;i<e.length;i++)e[i]=parseFloat(e[i]);return e},a.Point=function(t,e){this.x=t,this.y=e},a.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},a.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],i=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=i},a.CreatePoint=function(t){var e=a.ToNumberArray(t);return new a.Point(e[0],e[1])},a.CreatePath=function(t){for(var e=a.ToNumberArray(t),i=[],r=0;r<e.length;r+=2)i.push(new a.Point(e[r],e[r+1]));return i},a.BoundingBox=function(t,e,i,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,i,r,n,s){var a=t+2/3*(i-t),o=e+2/3*(r-e),l=a+1/3*(n-t),h=o+1/3*(s-e);this.addBezierCurve(t,e,a,l,o,h,n,s)},this.addBezierCurve=function(t,e,i,r,n,s,a,o){var l=[t,e],h=[i,r],u=[n,s],c=[a,o];this.addPoint(l[0],l[1]),this.addPoint(c[0],c[1]);for(var f=0;f<=1;f++){var p=function(t){return Math.pow(1-t,3)*l[f]+3*Math.pow(1-t,2)*t*h[f]+3*(1-t)*Math.pow(t,2)*u[f]+Math.pow(t,3)*c[f]},d=6*l[f]-12*h[f]+6*u[f],y=-3*l[f]+9*h[f]-9*u[f]+3*c[f],m=3*h[f]-3*l[f];if(0!=y){var g=Math.pow(d,2)-4*m*y;if(!(g<0)){var v=(-d+Math.sqrt(g))/(2*y);0<v&&v<1&&(0==f&&this.addX(p(v)),1==f&&this.addY(p(v)));var b=(-d-Math.sqrt(g))/(2*y);0<b&&b<1&&(0==f&&this.addX(p(b)),1==f&&this.addY(p(b)))}}else{if(0==d)continue;var x=-m/d;0<x&&x<1&&(0==f&&this.addX(p(x)),1==f&&this.addY(p(x)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(i,r)},a.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=a.ToNumberArray(t);this.angle=new a.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=a.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],i=this.m[2],r=this.m[4],n=this.m[1],s=this.m[3],a=this.m[5],o=1/(e*(1*s-0*a)-i*(1*n-0*a)+r*(0*n-0*s));t.transform(o*(1*s-0*a),o*(0*a-1*n),o*(0*r-1*i),o*(1*e-0*r),o*(i*a-r*s),o*(r*n-e*a))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new a.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;0<=e;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var i=a.trim(a.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),r=0;r<i.length;r++)if("none"!==i[r]){var n=a.trim(i[r].split("(")[0]),s=i[r].split("(")[1].replace(")",""),o=this.Type[n];if(void 0!==o){var l=new o(s);l.type=n,this.transforms.push(l)}}},a.AspectRatio=function(t,e,i,r,n,s,o,l,h,u){var c=(e=(e=a.compressSpaces(e)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",f=e.split(" ")[1]||"meet",p=i/r,d=n/s,y=Math.min(p,d),m=Math.max(p,d);"meet"==f&&(r*=y,s*=y),"slice"==f&&(r*=m,s*=m),h=new a.Property("refX",h),u=new a.Property("refY",u),h.hasValue()&&u.hasValue()?t.translate(-y*h.toPixels("x"),-y*u.toPixels("y")):(c.match(/^xMid/)&&("meet"==f&&y==d||"slice"==f&&m==d)&&t.translate(i/2-r/2,0),c.match(/YMid$/)&&("meet"==f&&y==p||"slice"==f&&m==p)&&t.translate(0,n/2-s/2),c.match(/^xMax/)&&("meet"==f&&y==d||"slice"==f&&m==d)&&t.translate(i-r,0),c.match(/YMax$/)&&("meet"==f&&y==p||"slice"==f&&m==p)&&t.translate(0,n-s)),"none"==c?t.scale(p,d):"meet"==f?t.scale(y,y):"slice"==f&&t.scale(m,m),t.translate(null==o?0:-o,null==l?0:-l)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var i=this.attributes[t];return null!=i?i:(1==e&&(i=new a.Property(t,""),this.attributes[t]=i),i||a.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return a.EmptyProperty},this.style=function(t,e,i){var r=this.styles[t];if(null!=r)return r;var n=this.attribute(t);if(null!=n&&n.hasValue())return this.styles[t]=n;if(1!=i){var s=this.parent;if(null!=s){var o=s.style(t);if(null!=o&&o.hasValue())return o}}return 1==e&&(r=new a.Property(t,""),this.styles[t]=r),r||a.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var i=this.style("filter").getDefinition();null!=i&&i.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(t){},this.clearContext=function(t){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var i=t;e&&(i=a.CreateElement(t)),i.parent=this,"title"!=i.type&&this.children.push(i)},this.addStylesFromStyleDefinition=function(){for(var e in a.Styles)if("@"!=e[0]&&s(t,e)){var i=a.Styles[e],r=a.StylesSpecificity[e];if(null!=i)for(var n in i){var o=this.stylesSpecificity[n];void 0===o&&(o="000"),o<r&&(this.styles[n]=i[n],this.stylesSpecificity[n]=r)}}};var e,i=new RegExp("^[A-Z-]+$");if(null!=t&&1==t.nodeType){for(var r=0;r<t.attributes.length;r++){var n=t.attributes[r],o=(e=n.nodeName,i.test(e)?e.toLowerCase():e);this.attributes[o]=new a.Property(o,n.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var l=this.attribute("style").value.split(";");for(r=0;r<l.length;r++)if(""!=a.trim(l[r])){var h=l[r].split(":"),u=a.trim(h[0]),c=a.trim(h[1]);this.styles[u]=new a.Property(u,c)}}for(this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this),r=0;r<t.childNodes.length;r++){var f=t.childNodes[r];if(1==f.nodeType&&this.addChild(f,!0),this.captureTextNodes&&(3==f.nodeType||4==f.nodeType)){var p=f.value||f.text||f.textContent||"";""!=a.compressSpaces(p)&&this.addChild(new a.Element.tspan(f),!1)}}}},a.Element.RenderedElementBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.calculateOpacity=function(){for(var t=1,e=this;null!=e;){var i=e.style("opacity",!1,!0);i.hasValue()&&(t*=i.numValue()),e=e.parent}return t},this.setContext=function(t,e){if(!e){var i;if(this.style("fill").isUrlDefinition())null!=(i=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=i);else if(this.style("fill").hasValue()){var r;"currentColor"==(r=this.style("fill")).value&&(r.value=this.style("color").value),"inherit"!=r.value&&(t.fillStyle="none"==r.value?"rgba(0,0,0,0)":r.value)}if(this.style("fill-opacity").hasValue()&&(r=(r=new a.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=r.value),this.style("stroke").isUrlDefinition())null!=(i=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=i);else if(this.style("stroke").hasValue()){var n;"currentColor"==(n=this.style("stroke")).value&&(n.value=this.style("color").value),"inherit"!=n.value&&(t.strokeStyle="none"==n.value?"rgba(0,0,0,0)":n.value)}if(this.style("stroke-opacity").hasValue()&&(n=(n=new a.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=n.value),this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();t.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("paint-order").hasValue()&&(t.paintOrder=this.style("paint-order").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var o=a.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(o):void 0!==t.webkitLineDash?t.webkitLineDash=o:void 0===t.mozDash||1==o.length&&0==o[0]||(t.mozDash=o);var l=this.style("stroke-dashoffset").toPixels();void 0!==t.lineDashOffset?t.lineDashOffset=l:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=l:void 0!==t.mozDashOffset&&(t.mozDashOffset=l)}}if(void 0!==t.font){t.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString();var h=this.style("font-size",!1,!1);h.isPixels()&&(a.emSize=h.toPixels())}if(this.style("transform",!1,!0).hasValue()&&new a.Transform(this.style("transform",!1,!0).value).apply(t),this.style("clip-path",!1,!0).hasValue()){var u=this.style("clip-path",!1,!0).getDefinition();null!=u&&u.apply(t)}t.globalAlpha=this.calculateOpacity()}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new a.BoundingBox},this.renderChildren=function(t){this.path(t),a.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()&&(i=this.style("marker-start").getDefinition()).render(t,e[0][0],e[0][1]),this.style("marker-mid").isUrlDefinition())for(var i=this.style("marker-mid").getDefinition(),r=1;r<e.length-1;r++)i.render(t,e[r][0],e[r][1]);this.style("marker-end").isUrlDefinition()&&(i=this.style("marker-end").getDefinition()).render(t,e[e.length-1][0],e[e.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){if(t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,t.canvas.style&&void 0!==t.font&&void 0!==r.getComputedStyle){t.font=r.getComputedStyle(t.canvas).getPropertyValue("font");var e=new a.Property("fontSize",a.Font.Parse(t.font).fontSize);e.hasValue()&&(a.rootEmSize=a.emSize=e.toPixels("y"))}this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var i=a.ViewPort.width(),n=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){i=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y");var s=0,o=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(s=-this.attribute("refX").toPixels("x"),o=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(s,o),t.lineTo(i,o),t.lineTo(i,n),t.lineTo(s,n),t.closePath(),t.clip())}if(a.ViewPort.SetCurrent(i,n),this.attribute("viewBox").hasValue()){var l=a.ToNumberArray(this.attribute("viewBox").value),h=l[0],u=l[1];i=l[2],n=l[3],a.AspectRatio(t,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),i,a.ViewPort.height(),n,h,u,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(l[2],l[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y"),s=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(o=s),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(s=o),s=Math.min(s,r/2),o=Math.min(o,n/2),null!=t){var l=(Math.sqrt(2)-1)/3*4;t.beginPath(),t.moveTo(e+s,i),t.lineTo(e+r-s,i),t.bezierCurveTo(e+r-s+l*s,i,e+r,i+o-l*o,e+r,i+o),t.lineTo(e+r,i+n-o),t.bezierCurveTo(e+r,i+n-o+l*o,e+r-s+l*s,i+n,e+r-s,i+n),t.lineTo(e+s,i+n),t.bezierCurveTo(e+s-l*s,i+n,e,i+n-o+l*o,e,i+n-o),t.lineTo(e,i+o),t.bezierCurveTo(e,i+o-l*o,e+s-l*s,i,e+s,i),t.closePath()}return new a.BoundingBox(e,i,e+r,i+n)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),i=this.attribute("cy").toPixels("y"),r=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,i,r,0,2*Math.PI,!1),t.closePath()),new a.BoundingBox(e-r,i-r,e+r,i+r)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=(Math.sqrt(2)-1)/3*4,i=this.attribute("rx").toPixels("x"),r=this.attribute("ry").toPixels("y"),n=this.attribute("cx").toPixels("x"),s=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(n+i,s),t.bezierCurveTo(n+i,s+e*r,n+e*i,s+r,n,s+r),t.bezierCurveTo(n-e*i,s+r,n-i,s+e*r,n-i,s),t.bezierCurveTo(n-i,s-e*r,n-e*i,s-r,n,s-r),t.bezierCurveTo(n+e*i,s-r,n+i,s-e*r,n+i,s),t.closePath()),new a.BoundingBox(n-i,s-r,n+i,s+r)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(t){this.base=a.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new a.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(t){this.base=a.Element.PathElementBase,this.base(t),this.points=a.CreatePath(this.attribute("points").value),this.path=function(t){var e=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var i=1;i<this.points.length;i++)e.addPoint(this.points[i].x,this.points[i].y),null!=t&&t.lineTo(this.points[i].x,this.points[i].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return 0<t.length&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(t){this.base=a.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(t){this.base=a.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var i=0;i<2;i++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(e=(e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),i=0;i<2;i++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=a.compressSpaces(e),e=a.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,i){null!=i&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var i=new a.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var r=e.getAsCurrentPoint();for(e.addMarker(r),i.addPoint(r.x,r.y),null!=t&&t.moveTo(r.x,r.y),e.start=e.current;!e.isCommandOrEnd();)r=e.getAsCurrentPoint(),e.addMarker(r,e.start),i.addPoint(r.x,r.y),null!=t&&t.lineTo(r.x,r.y);break;case"L":case"l":for(;!e.isCommandOrEnd();){var n=e.current;r=e.getAsCurrentPoint(),e.addMarker(r,n),i.addPoint(r.x,r.y),null!=t&&t.lineTo(r.x,r.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var s=new a.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(s,e.current),e.current=s,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();)s=new a.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar()),e.addMarker(s,e.current),e.current=s,i.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y);break;case"C":case"c":for(;!e.isCommandOrEnd();){var o=e.current,l=e.getPoint(),h=e.getAsControlPoint(),u=e.getAsCurrentPoint();e.addMarker(u,h,l),i.addBezierCurve(o.x,o.y,l.x,l.y,h.x,h.y,u.x,u.y),null!=t&&t.bezierCurveTo(l.x,l.y,h.x,h.y,u.x,u.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();)o=e.current,l=e.getReflectedControlPoint(),h=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,h,l),i.addBezierCurve(o.x,o.y,l.x,l.y,h.x,h.y,u.x,u.y),null!=t&&t.bezierCurveTo(l.x,l.y,h.x,h.y,u.x,u.y);break;case"Q":case"q":for(;!e.isCommandOrEnd();)o=e.current,h=e.getAsControlPoint(),u=e.getAsCurrentPoint(),e.addMarker(u,h,h),i.addQuadraticCurve(o.x,o.y,h.x,h.y,u.x,u.y),null!=t&&t.quadraticCurveTo(h.x,h.y,u.x,u.y);break;case"T":case"t":for(;!e.isCommandOrEnd();)o=e.current,h=e.getReflectedControlPoint(),e.control=h,u=e.getAsCurrentPoint(),e.addMarker(u,h,h),i.addQuadraticCurve(o.x,o.y,h.x,h.y,u.x,u.y),null!=t&&t.quadraticCurveTo(h.x,h.y,u.x,u.y);break;case"A":case"a":for(;!e.isCommandOrEnd();){o=e.current;var c=e.getScalar(),f=e.getScalar(),p=e.getScalar()*(Math.PI/180),d=e.getScalar(),y=e.getScalar(),m=(u=e.getAsCurrentPoint(),new a.Point(Math.cos(p)*(o.x-u.x)/2+Math.sin(p)*(o.y-u.y)/2,-Math.sin(p)*(o.x-u.x)/2+Math.cos(p)*(o.y-u.y)/2)),g=Math.pow(m.x,2)/Math.pow(c,2)+Math.pow(m.y,2)/Math.pow(f,2);1<g&&(c*=Math.sqrt(g),f*=Math.sqrt(g));var v=(d==y?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(f,2)-Math.pow(c,2)*Math.pow(m.y,2)-Math.pow(f,2)*Math.pow(m.x,2))/(Math.pow(c,2)*Math.pow(m.y,2)+Math.pow(f,2)*Math.pow(m.x,2)));isNaN(v)&&(v=0);var b=new a.Point(v*c*m.y/f,v*-f*m.x/c),x=new a.Point((o.x+u.x)/2+Math.cos(p)*b.x-Math.sin(p)*b.y,(o.y+u.y)/2+Math.sin(p)*b.x+Math.cos(p)*b.y),w=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(w(t)*w(e))},P=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))},S=P([1,0],[(m.x-b.x)/c,(m.y-b.y)/f]),k=[(m.x-b.x)/c,(m.y-b.y)/f],C=[(-m.x-b.x)/c,(-m.y-b.y)/f],B=P(k,C);E(k,C)<=-1&&(B=Math.PI),1<=E(k,C)&&(B=0);var M=1-y?1:-1,V=S+M*(B/2),A=new a.Point(x.x+c*Math.cos(V),x.y+f*Math.sin(V));if(e.addMarkerAngle(A,V-M*Math.PI/2),e.addMarkerAngle(u,V-M*Math.PI),i.addPoint(u.x,u.y),null!=t){E=f<c?c:f;var T=f<c?1:c/f,N=f<c?f/c:1;t.translate(x.x,x.y),t.rotate(p),t.scale(T,N),t.arc(0,0,E,S,S+B,1-y),t.scale(1/T,1/N),t.rotate(-p),t.translate(-x.x,-x.y)}}break;case"Z":case"z":null!=t&&i.x1!==i.x2&&i.y1!==i.y2&&t.closePath(),e.current=e.start}return i},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),i=[],r=0;r<t.length;r++)i.push([t[r],e[r]]);return i}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(t){this.base=a.Element.ElementBase,this.base(t),this.createPattern=function(t,e){var i=this.attribute("width").toPixels("x",!0),r=this.attribute("height").toPixels("y",!0),s=new a.Element.svg;s.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),s.attributes.width=new a.Property("width",i+"px"),s.attributes.height=new a.Property("height",r+"px"),s.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),s.children=this.children;var o=n();o.width=i,o.height=r;var l=o.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&l.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var h=-1;h<=1;h++)for(var u=-1;u<=1;u++)l.save(),s.attributes.x=new a.Property("x",h*o.width),s.attributes.y=new a.Property("y",u*o.height),s.render(l),l.restore();return t.createPattern(o,"repeat")}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(t){this.base=a.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,i){if(e){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(i),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var r=new a.Element.svg;r.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),r.attributes.refX=new a.Property("refX",this.attribute("refX").value),r.attributes.refY=new a.Property("refY",this.attribute("refY").value),r.attributes.width=new a.Property("width",this.attribute("markerWidth").value),r.attributes.height=new a.Property("height",this.attribute("markerHeight").value),r.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),r.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),r.children=this.children,r.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-i),t.translate(-e.x,-e.y)}}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(t){this.base=a.Element.ElementBase,this.base(t),this.render=function(t){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"stop"==i.type&&this.stops.push(i)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var i=this.attributesToInherit[e];!this.attribute(i).hasValue()&&t.attribute(i).hasValue()&&(this.attribute(i,!0).value=t.attribute(i).value)}},this.createGradient=function(t,e,i){var r=this;this.getHrefAttribute().hasValue()&&(r=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(r));var s=function(t){return i.hasValue()?new a.Property("color",t).addOpacity(i).value:t},o=this.getGradient(t,e);if(null==o)return s(r.stops[r.stops.length-1].color);for(var l=0;l<r.stops.length;l++)o.addColorStop(r.stops[l].offset,s(r.stops[l].color));if(this.attribute("gradientTransform").hasValue()){var h=a.ViewPort.viewPorts[0],u=new a.Element.rect;u.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),u.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),u.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),u.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var c=new a.Element.g;c.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),c.children=[u];var f=new a.Element.svg;f.attributes.x=new a.Property("x",0),f.attributes.y=new a.Property("y",0),f.attributes.width=new a.Property("width",h.width),f.attributes.height=new a.Property("height",h.height),f.children=[c];var p=n();p.width=h.width,p.height=h.height;var d=p.getContext("2d");return d.fillStyle=o,f.render(d),d.createPattern(p,"no-repeat")}return o}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var i="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox(t):null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),n="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),s="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),a="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==s&&n==a?null:t.createLinearGradient(r,n,s,a)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var i=e.getBoundingBox(t);this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),n="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),s=r,a=n;this.attribute("fx").hasValue()&&(s="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var o="objectBoundingBox"==this.gradientUnits()?(i.width()+i.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(s,a,0,r,n,o)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(t){this.base=a.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(t){this.base=a.Element.ElementBase,this.base(t),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var i=this.calcValue();this.attribute("type").hasValue()&&(i=this.attribute("type").value+"("+i+")"),this.getProperty().value=i,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),i=Math.floor(e),r=Math.ceil(e);t.from=new a.Property("from",parseFloat(this.values.value[i])),t.to=new a.Property("to",parseFloat(this.values.value[r])),t.progress=(e-i)/(r-i)}else t.from=this.from,t.to=this.to;return t}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress();return t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),i=new t(e.from.value),r=new t(e.to.value);if(i.ok&&r.ok){var n=i.r+(r.r-i.r)*e.progress,s=i.g+(r.g-i.g)*e.progress,a=i.b+(r.b-i.b)*e.progress;return"rgb("+parseInt(n,10)+","+parseInt(s,10)+","+parseInt(a,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=a.ToNumberArray(t.from.value),i=a.ToNumberArray(t.to.value),r="",n=0;n<e.length;n++)r+=e[n]+(i[n]-e[n])*t.progress+" ";return r}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(t){this.base=a.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var i=this.children[e];"font-face"==i.type?(this.fontFace=i).style("font-family").hasValue()&&(a.Definitions[i.style("font-family").value]=this):"missing-glyph"==i.type?this.missingGlyph=i:"glyph"==i.type&&(""!=i.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[i.unicode]&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(t){this.base=a.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(t){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.initializeCoordinates=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0)},this.getBoundingBox=function(t){this.initializeCoordinates(t);for(var e=null,i=0;i<this.children.length;i++){var r=this.getChildBoundingBox(t,this,this,i);null==e?e=r:e.addBoundingBox(r)}return e},this.renderChildren=function(t){this.initializeCoordinates(t);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,i){var r=this.style("text-anchor").valueOrDefault("start");if("start"!=r){for(var n=0,s=i;s<e.children.length;s++){var a=e.children[s];if(i<s&&a.attribute("x").hasValue())break;n+=a.measureTextRecursive(t)}return-1*("end"==r?n:n/2)}return 0},this.adjustChildCoordinates=function(t,e,i,r){var n=i.children[r];return n.attribute("x").hasValue()?(n.x=n.attribute("x").toPixels("x")+e.getAnchorDelta(t,i,r),n.attribute("dx").hasValue()&&(n.x+=n.attribute("dx").toPixels("x"))):(n.attribute("dx").hasValue()&&(e.x+=n.attribute("dx").toPixels("x")),n.x=e.x),e.x=n.x+n.measureText(t),n.attribute("y").hasValue()?(n.y=n.attribute("y").toPixels("y"),n.attribute("dy").hasValue()&&(n.y+=n.attribute("dy").toPixels("y"))):(n.attribute("dy").hasValue()&&(e.y+=n.attribute("dy").toPixels("y")),n.y=e.y),e.y=n.y,n},this.getChildBoundingBox=function(t,e,i,r){var n=this.adjustChildCoordinates(t,e,i,r),s=n.getBoundingBox(t);for(r=0;r<n.children.length;r++){var a=e.getChildBoundingBox(t,e,n,r);s.addBoundingBox(a)}return s},this.renderChild=function(t,e,i,r){var n=this.adjustChildCoordinates(t,e,i,r);for(n.render(t),r=0;r<n.children.length;r++)e.renderChild(t,e,n,r)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,i){var r=e[i],n=null;if(t.isArabic){var s="isolated";(0==i||" "==e[i-1])&&i<e.length-2&&" "!=e[i+1]&&(s="terminal"),0<i&&" "!=e[i-1]&&i<e.length-2&&" "!=e[i+1]&&(s="medial"),0<i&&" "!=e[i-1]&&(i==e.length-1||" "==e[i+1])&&(s="initial"),void 0!==t.glyphs[r]&&null==(n=t.glyphs[r][s])&&"glyph"==t.glyphs[r].type&&(n=t.glyphs[r])}else n=t.glyphs[r];return null==n&&(n=t.missingGlyph),n},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)"stroke"==t.paintOrder?(""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y)):(""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y));else{var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),r=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),n=this.getText();e.isRTL&&(n=n.split("").reverse().join(""));for(var s=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<n.length;o++){var l=this.getGlyph(e,n,o),h=i/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(h,-h);var u=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/i,"italic"==r&&t.transform(1,0,.4,1,0,0),l.render(t),"italic"==r&&t.transform(1,0,-.4,1,0,0),t.lineWidth=u,t.scale(1/h,-1/h),t.translate(-this.x,-this.y),this.x+=i*(l.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,void 0===s[o]||isNaN(s[o])||(this.x+=s[o])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),i=0;i<this.children.length;i++)e+=this.children[i].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),r=0,n=this.getText();e.isRTL&&(n=n.split("").reverse().join(""));for(var s=a.ToNumberArray(this.parent.attribute("dx").value),o=0;o<n.length;o++)r+=(this.getGlyph(e,n,o).horizAdvX||e.horizAdvX)*i/e.fontFace.unitsPerEm,void 0===s[o]||isNaN(s[o])||(r+=s[o]);return r}var l=a.compressSpaces(this.getText());if(!t.measureText)return 10*l.length;t.save(),this.setContext(t,!0);var h=t.measureText(l).width;return t.restore(),h},this.getBoundingBox=function(t){var e=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(this.x,this.y-e,this.x+this.measureText(t),this.y)}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(t){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(t),this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(t){this.base=a.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(t){this.base=a.Element.TextElementBase,this.base(t),this.hasText=0<t.childNodes.length;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value||t.childNodes[0].data:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(0<this.children.length){var i=new a.Element.g;i.children=this.children,i.parent=this,i.render(t)}},this.onclick=function(){r.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.image=function(t){this.base=a.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var i=e.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,i)this.img=a.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var r=this;this.img.onload=function(){r.loaded=!0},this.img.onerror=function(){a.log('ERROR: image "'+e+'" not found'),r.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");0!=s&&0!=o&&(t.save(),i?t.drawSvg(this.img,e,n,s,o):(t.translate(e,n),a.AspectRatio(t,this.attribute("preserveAspectRatio").value,s,this.img.width,o,this.img.height,0,0),r.loaded&&(void 0===this.img.complete||this.img.complete)&&t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");return new a.BoundingBox(t,e,t+i,e+r)}}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(t){for(var e=new a.BoundingBox,i=0;i<this.children.length;i++)e.addBoundingBox(this.children[i].getBoundingBox(t));return e}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.render=function(t){}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(t){this.base=a.Element.ElementBase,this.base(t);for(var e="",i=0;i<t.childNodes.length;i++)e+=t.childNodes[i].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var r=(e=a.compressSpaces(e)).split("}");for(i=0;i<r.length;i++)if(""!=a.trim(r[i]))for(var n=r[i].split("{"),s=n[0].split(","),o=n[1].split(";"),l=0;l<s.length;l++){var h=a.trim(s[l]);if(""!=h){for(var u=a.Styles[h]||{},c=0;c<o.length;c++){var f=o[c].indexOf(":"),p=o[c].substr(0,f),y=o[c].substr(f+1,o[c].length-f);null!=p&&null!=y&&(u[a.trim(p)]=new a.Property(a.trim(p),a.trim(y)))}if(a.Styles[h]=u,a.StylesSpecificity[h]=d(h),"@font-face"==h)for(var m=u["font-family"].value.replace(/"/g,""),g=u.src.value.split(","),v=0;v<g.length;v++)if(0<g[v].indexOf('format("svg")'))for(var b=g[v].indexOf("url"),x=g[v].indexOf(")",b),w=g[v].substr(b+5,x-b-6),E=a.parseXml(a.ajax(w)).getElementsByTagName("font"),P=0;P<E.length;P++){var S=a.CreateElement(E[P]);a.Definitions[m]=S}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.elementTransform=function(){if(null!=e&&e.style("transform",!1,!0).hasValue())return new a.Transform(e.style("transform",!1,!0).value)},this.getBoundingBox=function(t){if(null!=e)return e.getBoundingBox(t)},this.renderChildren=function(t){if(null!=e){var i=e;"symbol"==e.type&&((i=new a.Element.svg).type="svg",i.attributes.viewBox=new a.Property("viewBox",e.attribute("viewBox").value),i.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),i.attributes.overflow=new a.Property("overflow",e.attribute("overflow").value),i.children=e.children),"svg"==i.type&&(this.attribute("width").hasValue()&&(i.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(i.attributes.height=new a.Property("height",this.attribute("height").value)));var r=i.parent;i.parent=null,i.render(t),i.parent=r}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");if(0==s&&0==o){for(var l=new a.BoundingBox,h=0;h<this.children.length;h++)l.addBoundingBox(this.children[h].getBoundingBox(t));i=Math.floor(l.x1),r=Math.floor(l.y1),s=Math.floor(l.width()),o=Math.floor(l.height())}var u=e.attribute("mask").value;e.attribute("mask").value="";var c=n();c.width=i+s,c.height=r+o;var f=c.getContext("2d");this.renderChildren(f);var p=n();p.width=i+s,p.height=r+o;var d=p.getContext("2d");e.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=f.createPattern(c,"no-repeat"),d.fillRect(0,0,i+s,r+o),t.fillStyle=d.createPattern(p,"no-repeat"),t.fillRect(0,0,i+s,r+o),e.attribute("mask").value=u},this.render=function(t){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t){var e="undefined"!=typeof CanvasRenderingContext2D,i=t.beginPath,r=t.closePath;e&&(CanvasRenderingContext2D.prototype.beginPath=function(){},CanvasRenderingContext2D.prototype.closePath=function(){}),i.call(t);for(var n=0;n<this.children.length;n++){var s=this.children[n];if(void 0!==s.path){var o=void 0!==s.elementTransform&&s.elementTransform();!o&&s.style("transform",!1,!0).hasValue()&&(o=new a.Transform(s.style("transform",!1,!0).value)),o&&o.apply(t),s.path(t),e&&(CanvasRenderingContext2D.prototype.closePath=r),o&&o.unapply(t)}}r.call(t),t.clip(),e&&(CanvasRenderingContext2D.prototype.beginPath=i,CanvasRenderingContext2D.prototype.closePath=r)},this.render=function(t){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var i=e.getBoundingBox(t),r=Math.floor(i.x1),s=Math.floor(i.y1),a=Math.floor(i.width()),o=Math.floor(i.height()),l=e.style("filter").value;e.style("filter").value="";for(var h=0,u=0,c=0;c<this.children.length;c++){var f=this.children[c].extraFilterDistance||0;h=Math.max(h,f),u=Math.max(u,f)}var p=n();p.width=a+2*h,p.height=o+2*u;var d=p.getContext("2d");for(d.translate(-r+h,-s+u),e.render(d),c=0;c<this.children.length;c++)"function"==typeof this.children[c].apply&&this.children[c].apply(d,0,0,a+2*h,o+2*u);t.drawImage(p,0,0,a+2*h,o+2*u,r-h,s-u,a+2*h,o+2*u),e.style("filter",!0).value=l},this.render=function(t){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,i,r,n){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feComposite=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,i,r,n){}},a.Element.feComposite.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(t){this.base=a.Element.ElementBase,this.base(t);var e=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var i=e[0];e=[.213+.787*i,.715-.715*i,.072-.072*i,0,0,.213-.213*i,.715+.285*i,.072-.072*i,0,0,.213-.213*i,.715-.715*i,.072+.928*i,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var r=e[0]*Math.PI/180,n=function(t,e,i){return t+Math.cos(r)*e+Math.sin(r)*i};e=[n(.213,.787,-.213),n(.715,-.715,-.715),n(.072,-.072,.928),0,0,n(.213,-.213,.143),n(.715,.285,.14),n(.072,-.072,-.283),0,0,n(.213,-.213,-.787),n(.715,-.715,.715),n(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function s(t,e,i,r,n,s){return t[i*r*4+4*e+s]}function o(t,e,i,r,n,s,a){t[i*r*4+4*e+s]=a}function l(t,i){var r=e[t];return r*(r<0?i-255:i)}this.apply=function(t,e,i,r,n){var a=t.getImageData(0,0,r,n);for(i=0;i<n;i++)for(e=0;e<r;e++){var h=s(a.data,e,i,r,0,0),u=s(a.data,e,i,r,0,1),c=s(a.data,e,i,r,0,2),f=s(a.data,e,i,r,0,3);o(a.data,e,i,r,0,0,l(0,h)+l(1,u)+l(2,c)+l(3,f)+l(4,1)),o(a.data,e,i,r,0,1,l(5,h)+l(6,u)+l(7,c)+l(8,f)+l(9,1)),o(a.data,e,i,r,0,2,l(10,h)+l(11,u)+l(12,c)+l(13,f)+l(14,1)),o(a.data,e,i,r,0,3,l(15,h)+l(16,u)+l(17,c)+l(18,f)+l(19,1))}t.clearRect(0,0,r,n),t.putImageData(a,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(t){this.base=a.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,i,r,n,s){e&&void 0!==e.canvasRGBA?(t.canvas.id=a.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas,i,r,n,s,this.blurRadius),document.body.removeChild(t.canvas)):a.log("ERROR: StackBlur.js must be included for blur to work")}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(t){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(t){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(t){a.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var i=null;return(i=void 0!==a.Element[e]?new a.Element[e](t):new a.Element.MISSING(t)).type=t.nodeName,i},a.load=function(t,e){a.loadXml(t,a.ajax(e))},a.loadXml=function(t,e){a.loadXmlDoc(t,a.parseXml(e))},a.loadXmlDoc=function(t,e){a.init(t);var i=function(e){for(var i=t.canvas;i;)e.x-=i.offsetLeft,e.y-=i.offsetTop,i=i.offsetParent;return r.scrollX&&(e.x+=r.scrollX),r.scrollY&&(e.y+=r.scrollY),e};1!=a.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=i(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=i(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onmousemove(e.x,e.y)});var n=a.CreateElement(e.documentElement);n.root=!0,n.addStylesFromStyleDefinition();var s=!0,o=function(){a.ViewPort.Clear(),t.canvas.parentNode?a.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight):a.ViewPort.SetCurrent(800,600),1!=a.opts.ignoreDimensions&&(n.style("width").hasValue()&&(t.canvas.width=n.style("width").toPixels("x"),t.canvas.style&&(t.canvas.style.width=t.canvas.width+"px")),n.style("height").hasValue()&&(t.canvas.height=n.style("height").toPixels("y"),t.canvas.style&&(t.canvas.style.height=t.canvas.height+"px")));var i=t.canvas.clientWidth||t.canvas.width,r=t.canvas.clientHeight||t.canvas.height;if(1==a.opts.ignoreDimensions&&n.style("width").hasValue()&&n.style("height").hasValue()&&(i=n.style("width").toPixels("x"),r=n.style("height").toPixels("y")),a.ViewPort.SetCurrent(i,r),null!=a.opts.offsetX&&(n.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(n.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var o=null,l=null,h=a.ToNumberArray(n.attribute("viewBox").value);null!=a.opts.scaleWidth&&(n.attribute("width").hasValue()?o=n.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(h[2])||(o=h[2]/a.opts.scaleWidth)),null!=a.opts.scaleHeight&&(n.attribute("height").hasValue()?l=n.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(h[3])||(l=h[3]/a.opts.scaleHeight)),null==o&&(o=l),null==l&&(l=o),n.attribute("width",!0).value=a.opts.scaleWidth,n.attribute("height",!0).value=a.opts.scaleHeight,n.style("transform",!0,!0).value+=" scale("+1/o+","+1/l+")"}1!=a.opts.ignoreClear&&t.clearRect(0,0,i,r),n.render(t),s&&(s=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(e))},l=!0;a.ImagesLoaded()&&(l=!1,o()),a.intervalID=setInterval((function(){var t=!1;if(l&&a.ImagesLoaded()&&(t=!(l=!1)),1!=a.opts.ignoreMouse&&(t|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var e=0;e<a.Animations.length;e++)t|=a.Animations[e].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(t=!0),t&&(o(),a.Mouse.runEvents())}),1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var i=0;i<this.events.length;i++){var r=this.events[i];e.isPointInPath&&e.isPointInPath(r.x,r.y)&&(this.eventElements[i]=t)}},this.checkBoundingBox=function(t,e){for(var i=0;i<this.events.length;i++){var r=this.events[i];e.isPointInBox(r.x,r.y)&&(this.eventElements[i]=t)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],i=this.eventElements[t];i;)e.run(i),i=i.parent;this.events=[],this.eventElements=[]}},a}(l||{});"string"==typeof i&&(i=document.getElementById(i)),null!=i.svg&&i.svg.stop(),i.childNodes&&1==i.childNodes.length&&"OBJECT"==i.childNodes[0].nodeName||(i.svg=h);var u=i.getContext("2d");void 0!==o.documentElement?h.loadXmlDoc(u,o):"<"==o.substr(0,1)?h.loadXml(u,o):h.load(u,o)}else for(var c=document.querySelectorAll("svg"),f=0;f<c.length;f++){var p=c[f],y=document.createElement("canvas");y.width=p.clientWidth,y.height=p.clientHeight,p.parentNode.insertBefore(y,p),p.parentNode.removeChild(p);var m=document.createElement("div");m.appendChild(p),a(y,m.innerHTML)}};"undefined"==typeof Element||(void 0!==Element.prototype.matches?s=function(t,e){return t.matches(e)}:void 0!==Element.prototype.webkitMatchesSelector?s=function(t,e){return t.webkitMatchesSelector(e)}:void 0!==Element.prototype.mozMatchesSelector?s=function(t,e){return t.mozMatchesSelector(e)}:void 0!==Element.prototype.msMatchesSelector?s=function(t,e){return t.msMatchesSelector(e)}:void 0!==Element.prototype.oMatchesSelector?s=function(t,e){return t.oMatchesSelector(e)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(s=function(t,e){return $(t).is(e)}),void 0===s&&"undefined"!=typeof Sizzle&&(s=Sizzle.matchesSelector)));var o=/(\[[^\]]+\])/g,l=/(#[^\s\+>~\.\[:]+)/g,h=/(\.[^\s\+>~\.\[:]+)/g,u=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,c=/(:[\w-]+\([^\)]*\))/gi,f=/(:[^\s\+>~\.\[:]+)/g,p=/([^\s\+>~\.\[:]+)/g;function d(t){var e=[0,0,0],i=function(i,r){var n=t.match(i);null!=n&&(e[r]+=n.length,t=t.replace(i," "))};return t=(t=t.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),i(o,1),i(l,0),i(h,1),i(u,2),i(c,1),i(f,1),t=(t=t.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),i(p,2),e.join("")}"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,i,r,n,s){var o={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:i,scaleWidth:r,scaleHeight:n};for(var l in s)s.hasOwnProperty(l)&&(o[l]=s[l]);a(this.canvas,t,o)}),i.exports=a}(i={exports:{}}),i.exports}(i(4),i(5))},function(t,e,i){var r;window,t.exports=(r=i(0),function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){t.exports=r},function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return n}));var r=i(0);function n(){var t,e,i,n,s,a,o,l,h,u=[];function c(t){return t.eachAfter(f),t.eachBefore(p),t.eachBefore(d),t}function f(n){var c=h(n).width,f=h(n).height;if(t(n)){if(c=f=0,n.children){for(var p=function(t){var r=[],n=0,s=!1,o=0,h=!0;return t.children.forEach((function(u,c){e(u)&&!s&&(s=!0),n+=u.x1-u.x0,n+=h?i(u)?a(u).left:0:Math.max(a(u).left,a(t.children[c-1]).right);var f=i(u)?a(u).right:0;(n+f>l(t)||c===t.children.length-1)&&(n+=f),n>l(t)||c===t.children.length-1?(r.push({from:o,to:c,width:n,flexHeight:s}),c<t.children.length-1&&(o=c+1,n=0,s=!1,h=!0)):h=!1})),r}(n),d=0;d<p.length;d++)p[d].height=y(n,p,d);u.push({box:n,lines:p}),c+=r.max(p,(function(t){return t.width})),f+=r.sum(p,(function(t){return t.height}))}c+=s(n).left+s(n).right,f+=s(n).top+s(n).bottom,c=Math.max(c,o(n).width),f=Math.max(f,o(n).height)}n.x0=n.y0=0,n.x1=c,n.y1=f}function p(r){var n=r.y1;if(r.parent&&e(r)){n=v(r).height;var s=m(r.parent),o=g(r,s);n-=i(r)||0!==o?a(r).top:0;var l=(n-=i(r)||o!==s.length-1?a(r).bottom:0)-r.y1;if(t(r)&&r.children&&l>0){var h=m(r),u=l/h.length,c=!0,f=!1,p=void 0;try{for(var d,y=h[Symbol.iterator]();!(c=(d=y.next()).done);c=!0)d.value.height+=u}catch(t){f=!0,p=t}finally{try{c||null==y.return||y.return()}finally{if(f)throw p}}}}r.y1=n}function d(t){var e=t.x1-t.x0,r=t.y1-t.y0;if(t.parent){t.y0=t.parent.y0+s(t.parent).top;var o=t.parent.children.indexOf(t);if(0===o||function(t){if(t.parent){var e=t.parent.children.indexOf(t),i=m(t.parent);return i[g(t,i)].from===e}return null}(t))t.x0+=t.parent.x0+s(t.parent).left,i(t)&&(t.x0+=a(t).left);else{var l=t.parent.children[o-1];t.x0=l.x1,t.x0+=Math.max(a(l).right,a(t).left)}}else switch(n){case"top":t.y0=0;break;case"middle":t.y0=r/2;break;case"bottom":t.y0=r}switch(n){case"top":if(t.parent){var h=g(t);t.y0+=i(t)||0!==h?a(t).top:0,t.y0+=b(t)}break;case"middle":t.parent&&(t.y0+=b(t)+v(t).height/2),t.y0-=r/2;break;case"bottom":if(t.parent){var u=m(t.parent),c=g(t,u);t.y0-=i(t)||c!==u.length-1?a(t).bottom:0,t.y0+=b(t,!0)}t.y0-=r}t.x1=t.x0+e,t.y1=t.y0+r}function y(t,e,r){for(var n=e[r],s=0,l=n.from;l<=n.to;l++){var h=t.children[l],u=h.y1-h.y0,c=(i(h)||0!==r?a(h).top:0)+(i(h)||r!==e.length-1?a(h).bottom:0);u+c>s&&(s=u+c)}return Math.max(s,o(t).height)}function m(t){return u[u.findIndex((function(e){return e.box===t}))].lines}function g(t,e){if(t.parent){var i=arguments.length>1?e:m(t.parent),r=t.parent.children.indexOf(t);return i.findIndex((function(t){return r>=t.from&&r<=t.to}))}return null}function v(t){var e=m(t.parent);return e[g(t,e)]}function b(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.parent){var i=m(t.parent),n=g(t,i),s=e?n:n-1;return r.sum(i.filter((function(t,e){return e<=s})),(function(t){return t.height}))}return null}function x(t){return function(){return t}}return c.vAlign=function(t){return arguments.length?(n=t,c):n},c.edgeMargins=function(t){return arguments.length?(i="function"==typeof t?t:x(+t),c):i},c.isContainer=function(e){return arguments.length?(t="function"==typeof e?e:x(+e),c):t},c.spanHeight=function(t){return arguments.length?(e="function"==typeof t?t:x(+t),c):e},c.padding=function(t){return arguments.length?(s="function"==typeof t?t:x(+t),c):s},c.margin=function(t){return arguments.length?(a="function"==typeof t?t:x(+t),c):a},c.nodeSize=function(t){return arguments.length?(h="function"==typeof t?t:x(+t),c):h},c.minContainerSize=function(t){return arguments.length?(o="function"==typeof t?t:x(+t),c):o},c.maxLineWidth=function(t){return arguments.length?(l="function"==typeof t?t:x(+t),c):l},c}}]).default)},function(t,e){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var i=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],r=0;r<i.length;r++){var n=i[r].re,s=i[r].process,a=n.exec(t);if(a){var o=s(a);this.r=o[0],this.g=o[1],this.b=o[2],o.length>3&&(this.alpha=o[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==i.length&&(i="0"+i),"#"+t+e+i},this.getHelpXML=function(){for(var t=new Array,r=0;r<i.length;r++)for(var n=i[r].example,s=0;s<n.length;s++)t[t.length]=n[s];for(var a in e)t[t.length]=a;var o=document.createElement("ul");o.setAttribute("id","rgbcolor-examples");for(r=0;r<t.length;r++)try{var l=document.createElement("li"),h=new RGBColor(t[r]),u=document.createElement("div");u.style.cssText="margin: 3px; border: 1px solid black; background:"+h.toHex()+"; color:"+h.toHex(),u.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+t[r]+" -> "+h.toRGB()+" -> "+h.toHex());l.appendChild(u),l.appendChild(c),o.appendChild(l)}catch(t){}return o}}},function(t,e){var i=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function n(t,e,i,r,n){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLCanvasElement&&!t instanceof HTMLCanvasElement)return;var s,a=t.getContext("2d");try{try{s=a.getImageData(e,i,r,n)}catch(t){throw new Error("unable to access local image data: "+t)}}catch(t){throw new Error("unable to access image data: "+t)}return s}function s(t,e,i,r,s,o){if(!(isNaN(o)||o<1)){o|=0;var l=n(t,e,i,r,s);l=a(l,e,i,r,s,o),t.getContext("2d").putImageData(l,e,i)}}function a(t,e,n,s,a,o){var l,u,c,f,p,d,y,m,g,v,b,x,w,E,P,S,k,C,B,M,V,A,T,N,O=t.data,D=o+o+1,z=s-1,I=a-1,R=o+1,$=R*(R+1)/2,L=new h,F=L;for(c=1;c<D;c++)if(F=F.next=new h,c==R)var q=F;F.next=L;var j=null,X=null;y=d=0;var W=i[o],U=r[o];for(u=0;u<a;u++){for(S=k=C=B=m=g=v=b=0,x=R*(M=O[d]),w=R*(V=O[d+1]),E=R*(A=O[d+2]),P=R*(T=O[d+3]),m+=$*M,g+=$*V,v+=$*A,b+=$*T,F=L,c=0;c<R;c++)F.r=M,F.g=V,F.b=A,F.a=T,F=F.next;for(c=1;c<R;c++)f=d+((z<c?z:c)<<2),m+=(F.r=M=O[f])*(N=R-c),g+=(F.g=V=O[f+1])*N,v+=(F.b=A=O[f+2])*N,b+=(F.a=T=O[f+3])*N,S+=M,k+=V,C+=A,B+=T,F=F.next;for(j=L,X=q,l=0;l<s;l++)O[d+3]=T=b*W>>U,0!=T?(T=255/T,O[d]=(m*W>>U)*T,O[d+1]=(g*W>>U)*T,O[d+2]=(v*W>>U)*T):O[d]=O[d+1]=O[d+2]=0,m-=x,g-=w,v-=E,b-=P,x-=j.r,w-=j.g,E-=j.b,P-=j.a,f=y+((f=l+o+1)<z?f:z)<<2,m+=S+=j.r=O[f],g+=k+=j.g=O[f+1],v+=C+=j.b=O[f+2],b+=B+=j.a=O[f+3],j=j.next,x+=M=X.r,w+=V=X.g,E+=A=X.b,P+=T=X.a,S-=M,k-=V,C-=A,B-=T,X=X.next,d+=4;y+=s}for(l=0;l<s;l++){for(k=C=B=S=g=v=b=m=0,x=R*(M=O[d=l<<2]),w=R*(V=O[d+1]),E=R*(A=O[d+2]),P=R*(T=O[d+3]),m+=$*M,g+=$*V,v+=$*A,b+=$*T,F=L,c=0;c<R;c++)F.r=M,F.g=V,F.b=A,F.a=T,F=F.next;for(p=s,c=1;c<=o;c++)d=p+l<<2,m+=(F.r=M=O[d])*(N=R-c),g+=(F.g=V=O[d+1])*N,v+=(F.b=A=O[d+2])*N,b+=(F.a=T=O[d+3])*N,S+=M,k+=V,C+=A,B+=T,F=F.next,c<I&&(p+=s);for(d=l,j=L,X=q,u=0;u<a;u++)O[(f=d<<2)+3]=T=b*W>>U,T>0?(T=255/T,O[f]=(m*W>>U)*T,O[f+1]=(g*W>>U)*T,O[f+2]=(v*W>>U)*T):O[f]=O[f+1]=O[f+2]=0,m-=x,g-=w,v-=E,b-=P,x-=j.r,w-=j.g,E-=j.b,P-=j.a,f=l+((f=u+R)<I?f:I)*s<<2,m+=S+=j.r=O[f],g+=k+=j.g=O[f+1],v+=C+=j.b=O[f+2],b+=B+=j.a=O[f+3],j=j.next,x+=M=X.r,w+=V=X.g,E+=A=X.b,P+=T=X.a,S-=M,k-=V,C-=A,B-=T,X=X.next,d+=s}return t}function o(t,e,i,r,s,a){if(!(isNaN(a)||a<1)){a|=0;var o=n(t,e,i,r,s);o=l(o,e,i,r,s,a),t.getContext("2d").putImageData(o,e,i)}}function l(t,e,n,s,a,o){var l,u,c,f,p,d,y,m,g,v,b,x,w,E,P,S,k,C,B,M,V=t.data,A=o+o+1,T=s-1,N=a-1,O=o+1,D=O*(O+1)/2,z=new h,I=z;for(c=1;c<A;c++)if(I=I.next=new h,c==O)var R=I;I.next=z;var $=null,L=null;y=d=0;var F=i[o],q=r[o];for(u=0;u<a;u++){for(E=P=S=m=g=v=0,b=O*(k=V[d]),x=O*(C=V[d+1]),w=O*(B=V[d+2]),m+=D*k,g+=D*C,v+=D*B,I=z,c=0;c<O;c++)I.r=k,I.g=C,I.b=B,I=I.next;for(c=1;c<O;c++)f=d+((T<c?T:c)<<2),m+=(I.r=k=V[f])*(M=O-c),g+=(I.g=C=V[f+1])*M,v+=(I.b=B=V[f+2])*M,E+=k,P+=C,S+=B,I=I.next;for($=z,L=R,l=0;l<s;l++)V[d]=m*F>>q,V[d+1]=g*F>>q,V[d+2]=v*F>>q,m-=b,g-=x,v-=w,b-=$.r,x-=$.g,w-=$.b,f=y+((f=l+o+1)<T?f:T)<<2,m+=E+=$.r=V[f],g+=P+=$.g=V[f+1],v+=S+=$.b=V[f+2],$=$.next,b+=k=L.r,x+=C=L.g,w+=B=L.b,E-=k,P-=C,S-=B,L=L.next,d+=4;y+=s}for(l=0;l<s;l++){for(P=S=E=g=v=m=0,b=O*(k=V[d=l<<2]),x=O*(C=V[d+1]),w=O*(B=V[d+2]),m+=D*k,g+=D*C,v+=D*B,I=z,c=0;c<O;c++)I.r=k,I.g=C,I.b=B,I=I.next;for(p=s,c=1;c<=o;c++)d=p+l<<2,m+=(I.r=k=V[d])*(M=O-c),g+=(I.g=C=V[d+1])*M,v+=(I.b=B=V[d+2])*M,E+=k,P+=C,S+=B,I=I.next,c<N&&(p+=s);for(d=l,$=z,L=R,u=0;u<a;u++)V[f=d<<2]=m*F>>q,V[f+1]=g*F>>q,V[f+2]=v*F>>q,m-=b,g-=x,v-=w,b-=$.r,x-=$.g,w-=$.b,f=l+((f=u+O)<N?f:N)*s<<2,m+=E+=$.r=V[f],g+=P+=$.g=V[f+1],v+=S+=$.b=V[f+2],$=$.next,b+=k=L.r,x+=C=L.g,w+=B=L.b,E-=k,P-=C,S-=B,L=L.next,d+=s}return t}function h(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}t.exports={image:function(t,e,i,r){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLImageElement&&!t instanceof HTMLImageElement)return;var n=t.naturalWidth,a=t.naturalHeight;if("string"==typeof e)e=document.getElementById(e);else if("undefined"!=typeof HTMLCanvasElement&&!e instanceof HTMLCanvasElement)return;e.style.width=n+"px",e.style.height=a+"px",e.width=n,e.height=a;var l=e.getContext("2d");l.clearRect(0,0,n,a),l.drawImage(t,0,0),isNaN(i)||i<1||(r?s(e,0,0,n,a,i):o(e,0,0,n,a,i))},canvasRGBA:s,canvasRGB:o,imageDataRGBA:a,imageDataRGB:l}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";i.r(e);class r{constructor(){}static rel_logic(t,e){return t>3||t<0||e>3||e<0?-98:0===t||1===e?e:0===e||1===t||t===e?t:2===t&&3===e||3===t&&2===e?1:-99}static rel(...t){if(t.length>1){let e=0;for(let i in t)e=this.rel_logic(e,t[i]);return e}return-97}static inv_logic(t){switch(t){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}return-99}static inv(t,e){if(e>0){let i=t;for(let t=0;t<e;t++)i=this.inv_logic(i);return i}return this.inv_logic(t)}static uForm2(t,e,i=!1){return this.reEntry(void 0,!1,i,t,e)}static iForm2(t,e,i=!1){return this.reEntry(void 0,!0,i,t,e)}static uForm3(t,e,i,r,n=!1){return this.reEntry(!0,t,n,e,i,r)}static iForm3(t,e,i,r,n=!1){return this.reEntry(!1,t,n,e,i,r)}static uForm4(t,e,i,r,n=!1){return this.reEntry(void 0,!1,n,t,e,i,r)}static iForm4(t,e,i,r,n=!1){return this.reEntry(void 0,!0,n,t,e,i,r)}static uForm5(t,e,i,r,n,s,a=!1){return this.reEntry(!0,t,a,e,i,r,n,s)}static iForm5(t,e,i,r,n,s,a=!1){return this.reEntry(!1,t,a,e,i,r,n,s)}static reEntry(t,e,i,...r){void 0===t&&(t=!1),void 0===e&&(e=!1);const n=r.length%2==0;let s=0,a=-1,o=!1,l=!1;n?e?l=!0:o=!0:t?o=!0:l=!0;let h=-1;for(let t=0;t<r.length;t++){const e=r[t];if(1==e){h=t;break}if(0==e)s++;else if(2==e||3==e)if(-1==a)a=t;else if(e!=r[a]){h=a;break}}if(s==r.length)return l?3:2;if(h>=0){let t=1;for(let i=h;i<r.length;i++)t=e&&i==r.length-1?this.rel(t,r[i]):this.inv(this.rel(t,r[i]));return t}const u=!t||n||e?1:2;for(let s=r.length*u-1;s>=0;s--){const a=s%r.length;if(2==r[a]||3==r[a]){const o=r.length*u-1-s;if(i&&(e&&o%2==0||!e&&o%2==1))return l?this.rel(3,r[a]):this.rel(2,r[a]);{let i=2;!e||n||t||(i=this.inv(i));for(let t=0;t<r.length*u;t++){let n=0;t==s&&(n=2==r[a]?0:this.inv(0)),i=e&&t==r.length-1?this.rel(i,n):this.inv(this.rel(i,n))}let o=2;!e||n||t||(o=this.inv(o));for(let t=0;t<r.length*u;t++){let i=0;t==s&&(i=2==r[a]?1:this.inv(1)),o=e&&t==r.length-1?this.rel(o,i):this.inv(this.rel(o,i))}return this.cont(i,o)}}}return-99}static implL(t,e){return this.rel(this.inv(t),e)}static implR(t,e){return this.rel(t,this.inv(e))}static pre(t,e){return this.inv(this.implL(t,e))}static post(t,e){return this.inv(this.implR(t,e))}static cont(t,e){return this.rel(this.pre(t,e),this.post(t,e))}static equiv(t,e){return this.inv(this.cont(t,e))}}var n=i(0),s=i(2);function a(t,e){for(var i=t+"";i.length<e;)i="0"+i;return i}String.prototype.replaceAll=function(t,e,i){return i&&(t=t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")),this.replace(new RegExp(t,"g"),e)},String.prototype.addBefore=function(t,e){return this.substr(0,t)+e+this.substr(t)},String.prototype.replaceAt=function(t,e){return this.substr(0,t)+e+this.substr(t+e.length)};const o=(t,e,i="")=>t.length>e?t.substr(0,e)+i:t,l={a:"ᴬ",b:"ᴮ",c:"ᵓ",d:"ᴰ",e:"ᴱ",f:"ᵎ",g:"ᴳ",h:"ᴴ",i:"ᴵ",j:"ᴶ",k:"ᴷ",l:"ᴸ",m:"ᴹ",n:"ᴺ",o:"ᴼ",p:"ᴾ",q:"ᴽ",r:"ᴿ",s:"ᵕ",t:"ᵀ",u:"ᵁ",v:"ᵛ",w:"ᵂ",x:"ᵡ",y:"ᵞ",z:"ᵜ",alt:"ᵽ","2r":"ᵳ","2r+1":"ᵲ"},h=((t,e=!1)=>Object.keys(t).reduce((i,r)=>Object.assign(i,{[t[r]]:e?r:(i[t[r]]||[]).concat(r)}),{}))(l,!0),u=(t,e)=>(...i)=>{const r=t(...i);return{cata:t=>r?t.success(r):t.error(e)}},c=(t,e='"',i="‽")=>{if(!f(t,e))return null;return t.split(e).filter((t,e,i)=>e%2==0||e===i.length-1).join(i)},f=(t,e='"')=>t.split(e).length%2==1,p=(t,e={open:"{",close:"}"},i=[])=>{const r=t.match(new RegExp(`\\${e.open}[^${e.open}${e.close}]*?\\${e.close}`,"g"));if(!r)return i;const n=r.reduce((t,e)=>t.replace(e,"•"),t);return p(n,e,[...i,...r])},d=(t,e="(",i=")")=>0===t.length||0===t.split("").reduce((t,r,n,s)=>{if(r===e)t++;else if(r===i){if(null===t)return NaN;t--}return n===s.length-1&&null===t?0:t},null);class y extends r{constructor(){}static calc(t){let e=0;const i=this.getValidForm(t);for(let t in i.space)if("form"===i.space[t].type)e=this.rel(e,this.calc(i.space[t]));else if("const"===i.space[t].type)e=this.rel(e,i.space[t].value);else if("var"===i.space[t].type)isNaN(i.space[t].value)||(e=this.rel(e,i.space[t].value));else if("unclear"===i.space[t].type)e=this.rel(e,i.space[t].value);else if("reEntry"===i.space[t].type){let r=[];const n=i.space[t];for(let t in n.nested)r=[...r,this.calc(n.nested[t])];const s=n.nested.length%2==0?void 0:n.reEven;e=this.rel(e,this.reEntry(s,n.lastOpen,n.altInterpretation,...r))}return i.unmarked?e:this.inv(e)}static calcAll(t){const e=this.getValidForm(t),i=this.getVariables(e),r=i.length,n={};if(r<1)return n.Result=this.calc(e),n;const s=i.join()+";";for(let t=0;t<4**r;t++){const o=a(t.toString(4),r),l=o.split("").map((t,e)=>({var:i[e],value:parseInt(t)}));n[s+o]=this.interCalc(e,l)}return n}static interCalc(t,e){return this.calc(this.interpret(t,e))}static interpret(t,e){const i=this.getValidForm(t),r=JSON.parse(JSON.stringify(i));return this.traverseForm(r,(function(t){const i=t.space;for(let t in i)if("var"===i[t].type)for(let r in e)if(i[t].symbol===e[r].var){i[t].value=e[r].value;break}})),r}static rel_logic(t,e){return typeof t===Array||typeof e===Array?null:super.rel_logic(t,e)}static rel(...t){return super.rel(...t)}static inv_logic(t){return typeof t===Array?null:super.inv_logic(t)}static inv(t,e){return super.inv(t,e)}static parseLinear(t){const e=this.convFromLinear(t);let i=null;try{i=JSON.parse(e)}catch(t){console.log(t)}return i}static convFromLinear(t){const e=this.cleanLinear(t);return function t(e){return e.reduce((function(e,i){return e.concat(Array.isArray(i)?t(i):i)}),[])}(this.constructFromLinear(e)).join("")}static cleanLinear(t){let e="",i=!1,r=!1;for(let n in t){const s=t[n];if("string"!=typeof s)break;'"'!==s||r||(i=!i),"/"!==s||i||(r=!r)," "===s?(i||r)&&(e+=s):e+=s}return e}static constructFromLinear(t){let e=[],i=!0,r=0,n=!1,s=!1;for(let e in t){const a=t[e];if("string"!=typeof a)break;if(!n&&!s)if("("===a){if(0==r&&0!=e)break;r++}else if(")"===a&&(r--,0==r)){if(e==t.length-1){i=!1;break}break}'"'!==a||s||(n=!n),"/"!==a||n||(s=!s)}e=[...e,"  {"],e=[...e,'"type":"form",'],i?e=[...e,'"unmarked":true,']:t=t.slice(1,t.length-1),e=[...e,'"space":['];let a=[""];r=0,n=!1,s=!1;for(let e in t){let i=t[e];const o=t[e-1];if("string"!=typeof i)break;n||s||(")"!==i&&"}"!==i||r--,"("===i||"{"===i?(0===r&&e>0&&(a=[...a,""]),r++):")"!==o&&"}"!==o||")"===i||"}"===i||0===r&&(a=[...a,""]),1===r&&","===i?i="⤵":1===r&&"|"===i&&(i="⤴")),'"'!==i||s||(n=!n),"/"!==i||n||(s=!s),a[a.length-1]+=i}for(let t in a){if("("===a[t][0]){let e=[this.constructFromLinear(a[t])];a[t]=e.slice()}else if("{"===a[t][0]){let e=["  {"];e=[...e,'"type":"reEntry",'];const i=a[t].slice(1,a[t].length-1).split("⤴"),r=i[i.length-1].split("⤵");e=r.length%2==0?[...e,'"reEven":"undefined",']:"2r"===i[0]||"2r"===i[1]||"2r"===i[2]?[...e,'"reEven":true,']:[...e,'"reEven":false,'],e="open"===i[0]||"open"===i[1]||"open"===i[2]?[...e,'"lastOpen":true,']:[...e,'"lastOpen":false,'],e="alt"===i[0]||"alt"===i[1]||"alt"===i[2]?[...e,'"altInterpretation":true,']:[...e,'"altInterpretation":false,'],e=[...e,'"nested":['];for(let t in r)e=[...e,this.constructFromLinear(r[t])],t<r.length-1&&(e=[...e,","]);e=[...e,"]}  "],a[t]=e.slice()}else{let e=[],i=[],r=!1,n=!1;for(let e in a[t]){const s=a[t][e];if("string"!=typeof s)break;'"'!==s||n?"/"!==s||r?(r||n||(i=[...i,""]),i[i.length-1]+='"'===s&&n?"\\"+s:s):(n=!n,n&&(i=[...i,"‽"])):(r=!r,r&&(i=[...i,"‖"]))}for(let t in i){if("string"!=typeof i[t])break;e=[...e,"  {"],!isNaN(i[t])&&i[t].length>0&&"‽"!==i[t][0]&&"‖"!==i[t][0]?(e=[...e,'"type":"const",'],e=[...e,'"value":'],e=[...e,i[t]]):"‽"===i[t][0]?(e=[...e,'"type":"unclear",'],e=[...e,'"value":2,'],e=[...e,'"symbol":'],e=[...e,'"'+i[t].slice(1)+'"']):(e=[...e,'"type":"var",'],e=[...e,'"value":"*",'],e=[...e,'"symbol":'],e="‖"===i[t][0]?[...e,'"'+i[t].slice(1)+'"']:[...e,'"'+i[t]+'"']),e=[...e,"}  "],t<i.length-1&&(e=[...e,","])}a[t]=e.slice()}e=[...e,a[t]],t<a.length-1&&(e=[...e,","])}return e=[...e,"]}  "],e}static jsonString(t){const e=this.getValidForm(t);return JSON.stringify(e,void 0,2)}static getVariables(t){const e=this.getValidForm(t);let i=[];return this.traverseForm(e,(function(t){const e=t.space;for(let t in e)"var"===e[t].type&&(r=i,n=e[t].symbol,-1==r.indexOf(n)&&(i=[...i,e[t].symbol]));var r,n})),i.sort()}static traverseForm(t,e){const i=e.apply(this,[t]);if(t.space){if(t.space.length>0)for(let i in t.space)if("form"===t.space[i].type||"reEntry"===t.space[i].type){if(this.traverseForm(t.space[i],e))break}}else if(t.nested){if(t.nested.length>0)for(let i in t.nested){if(this.traverseForm(t.nested[i],e))break}}else console.log("ERROR: Not a form!");return i}static getTotalVars(t){return this.getVariables(t.substr()).length}static reOrderVars(t,e){return this.decodeVars(this.encodeVars(t,e))}static decodeVars(t,e){let i=h;if(e){const t=Object.keys(h),r=t.slice(0,e.length),n=t.slice(-3);i=r.concat(n).reduce((t,i,r)=>({...t,[i]:r<e.length?e[r]:h[i]}),{})}return t.split("").map(t=>Object.keys(i).indexOf(t)>-1?i[t]:t).join("")}static encodeVars(t,e){function i(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}e||(e=this.getVariables(t));const r="alt(?=|)",n="2r(?=|)",s="2r+1(?=|)";return e.reduce((t,e,a)=>t.replace(new RegExp(r,"g"),l.alt).replace(new RegExp(n,"g"),l["2r"]).replace(new RegExp(s,"g"),l["2r+1"]).replace(new RegExp((t=>t.length>1?`"${i(t)}"`:""+i(t))(e),"g"),Object.keys(h)[a]),t)}static matchDefaultVarOrder(t){return"ELR"===t.join("")?["L","E","R"]:"+-LR"===t.join("")?["-","L","R","+"]:"+-ELR"===t.join("")?["-","L","E","R","+"]:t}static isValidForm(t,e){return"string"==typeof t?isValidFormula(t,e):isValidJSONForm(t,e)}static isValidFormula(t,e){let i=[u(()=>"string"==typeof t,"Formula input is not of type ‘string’")];if(t.length>0&&(i=[...i,u(()=>!!c(t,'"')&&!!c(t,"/"),'Number of quotes for literal variables (e.g.: "x") or number of slashes for unclear FORMs (e.g.: /x/) don\'t match')]),i.every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})),t.length>0){const e=c(c(t,'"'),"/");[u(()=>d(e,"(",")"),"Number or opening/closing order of parantheses in formula don't match"),u(()=>d(e,"{","}"),"Number or opening/closing order of curly brackets in formula don't match")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}));const i=p(e,{open:"(",close:")"}),r=p(e,{open:"{",close:"}"});[u(()=>i.every(t=>d(t,"{","}"))&&r.every(t=>d(t,"(",")")),"Opening/closing of parantheses overlaps with opening/closing of curly brackets in formula (e.g.: ({a)b})"),u(()=>r.every(t=>this.isValidReEntry(t)),"Option part of one or more re-entry constructions is not well-formed")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}return!0}static isValidReEntry(t,e){const i=t.slice(1,-1).split("|");if(i.length>1){const t=i.filter((t,e,i)=>e<i.length-1),e=["alt","open","2r","2r+1"],r=t.reduce((t,i)=>[...t,e.filter(t=>i===t)[0]],[]).filter(t=>t),n=[...new Set(r)];return[u(()=>n.length===t.length,"One or more re-entry constructions have invalid or duplicate options"),u(()=>n.filter(t=>t===e[2]||t===e[3]).length<2,"One or more re-entry constructions have both options ‘2r’ and ‘2r+1’ set at the same time")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}return!0}static isValidJSONForm(t,e){return[u(()=>!0,"")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}static formMatchesVarList(t,e){const i=this.getVariables(t);if(!(e.length===i.length&&i.every(t=>e.some(e=>t===e))))throw new Error("FORM doesn't match the given variable list");return!0}static getValidForm(t){if("string"==typeof t){if(!this.isValidFormula(t))throw new Error("Input is not a valid formula");return this.parseLinear(t)}return t}}var m=i(3),g=i.n(m);const v={width:window.innerWidth,height:window.innerHeight,margin:{left:10,right:10,top:10,bottom:10}};function b(t,e){n.select(t.node().parentElement).attr("width",t.node().getBBox().width+e.left+e.right).attr("height",t.node().getBBox().height+e.top+e.bottom)}function x(t){const e=t.ancestors().filter(t=>"form"===t.data.type&&t.data.unmarked||"reEntry"===t.data.type&&t.data.lastOpen).length;return t.depth-e}function w(t){return e=>{e.each((function(e){const i="string"==typeof t(e)?t(e).split("_"):"";2===i.length?(n.select(this).append("tspan").text(t=>i[0]),n.select(this).append("tspan").text(t=>i[1]).attr("dx",1).attr("dy",6).style("font-size",".8em")):n.select(this).text(t(e))}))}}function E(t,e="inherit",i="inherit",r="normal"){if(n){var s=n.select("body").append("svg");s.append("text").style("font-size",e).style("font-style",r).style("font-family",i).attr("x","-9999").attr("y","-9999").call(w(()=>t));var a=s.node().getBBox();return s.remove(),{width:a.width,height:a.height}}}function P(t,e,i){return function(t,e){let i=0,r=1,n=Math.round(e),s=n;for(;t%n>.3&&(s+=.001*r,t%s<t%n&&(n=s),i>=5e3&&(s=Math.round(e),r=-1),!(i>=1e4));)i++;return n}(2*Math.PI*t,e)*i}function S(t,e,i){let r="";for(let n in i)r=r.concat(P(t,e,i[n])+"px ");return r}const k={common:{font:{family:"sans-serif",size:"14px",style:"normal"},fontVar:{family:"sans-serif",size:"14px",style:"italic"},fontConst:{family:"courier, monospace",size:"14px",style:"normal"},fontContext:{family:"sans-serif",size:"10px",style:"normal"},strokeWidth:1,labels:{reEven:"2|r|",reOdd:"2|r|+1"},color:{base:n.color("black"),ground:n.color("white"),indef:n.color("red"),light:n.color("#ddd")}}};k.basic={...k.common,font:{...k.common.font,family:"georgia, serif"},fontVar:{...k.common.fontVar,family:"georgia, serif",style:"italic"},fontConst:{...k.common.fontConst,family:"georgia, serif"},fontContext:{...k.common.fontContext,family:"courier, monospace"}},k.gestalt={...k.common,font:{...k.common.font,family:"arial, sans-serif"},fontVar:{...k.common.fontVar,family:"arial, sans-serif"},fontConst:{...k.common.fontConst,family:"arial, sans-serif"},fontContext:{...k.common.fontContext,family:"georgia, serif"},color:{...k.common.color,pos:n.color("white"),neg:n.color("black")}};const[C,B]=[k.basic,k.gestalt];function M(t){t.attr("stroke","none").attr("fill","none")}const V={common:{nodeSize:{w:10,h:10},nodeSeparation:{hz:20,vt:40},dashes:{link:"4px 6px"}}};V.basic={...C,...V.common},V.basic.applyAxisStyles=function(t){t.selectAll(".tick").select("line").style("stroke-width",1.5*this.nodeSize.w).style("stroke","rgba(0,0,0,.05").style("stroke-linecap","round"),t.selectAll(".tick").select("text").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("fill",this.color.base.toString()).attr("text-anchor","start")},V.basic.applyNodeStyles=function(t,e){const[i,r,n,s,a,o,l,h,u,c]=e;n.selectAll("circle").style("stroke",this.color.base.toString()).style("fill",this.color.ground.toString()),l.selectAll("circle").style("fill",this.color.base.toString()),s.selectAll("circle").style("stroke",this.color.indef.toString()).style("fill",this.color.indef.toString()).filter(t=>t.data.lastOpen).style("fill",this.color.ground.toString()),a.selectAll("circle").style("stroke",this.color.indef.toString()).style("stroke-dasharray",t=>S(t.r,3,[1])),o.selectAll("circle").style("fill",this.color.indef.toString()),t.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("fill",this.color.base.toString()),h.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),u.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),r.selectAll("circle.inner").style("stroke","none").style("fill",this.color.base.toString())},V.basic.applyLinkStyles=function(t,e){const[i,r]=e;t.selectAll("path").style("stroke",this.color.base.toString()),i.selectAll("path").style("stroke",this.color.indef.toString()).style("stroke-dasharray",this.dashes.link),r.selectAll("path").style("stroke",this.color.indef.toString()).style("stroke-dasharray",this.dashes.link)};const A={common:{radius:14,padding:14}};A.basic={...C,...A.common},A.basic.applyNodeStyles=function(t,e){const[i,r,n,s,a,o,l,h,u,c]=e;n.select("circle").style("stroke",this.color.base.toString()).filter(t=>t.data.unmarked).style("stroke","none"),s.select("circle").style("stroke",this.color.indef.toString()).filter(t=>t.data.lastOpen).style("stroke-dasharray",t=>S(t.r,14,[.4,.6])),l.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("text-anchor","middle").style("fill",this.color.base.toString()),h.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),u.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),c.select("rect").style("fill",this.color.light.toString()),o.select("circle").style("fill",this.color.indef.toString()).style("stroke","none");s.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",this.color.indef.toString())},A.gestalt={...B,...A.common},A.gestalt.invertFill=function(t){return x(t)%2?this.color.pos.toString():this.color.neg.toString()},A.gestalt.applyNodeStyles=function(t,e,i){const[r,s,a,o,l,h,u,c,f,p]=e,d=n.select(i.node().parentNode).append("defs"),y=d.append("radialGradient").attr("id","grad-indef-outin").attr("fx","20%");y.append("stop").attr("offset","40%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.3),y.append("stop").attr("offset","90%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.8),y.append("stop").attr("offset","100%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",1);const m=d.append("radialGradient").attr("id","grad-indef-inout").attr("fx","20%");m.append("stop").attr("offset","10%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",1),m.append("stop").attr("offset","50%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.6),m.append("stop").attr("offset","60%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.4),m.append("stop").attr("offset","100%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",0),a.select("circle").filter(t=>!t.data.unmarked).style("stroke","none").style("fill",t=>this.invertFill(t)),o.select("circle").style("stroke",t=>"reEntry"===t.parent.data.type?this.color.pos.toString():"none").style("fill","url(#grad-indef-outin)");const g=o.select("circle").filter(t=>t.data.lastOpen).style("fill","url(#grad-indef-inout)").style("stroke-dasharray",t=>S(t.r,8,[.4,.6]));g.filter(t=>"reEntry"!==t.parent.data.type||!x(t)%2).style("stroke",t=>this.color.indef.toString()),g.filter(t=>"reEntry"===t.parent.data.type&&!t.parent.data.lastOpen).style("stroke",t=>this.color.pos.toString()),u.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("text-anchor","middle").style("stroke","none").style("fill",t=>this.invertFill(t)),c.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),f.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),p.select("rect").style("fill",this.color.light.toString()),p.select("text").style("fill",this.color.base.toString()),h.select("circle").style("fill",this.color.indef.toString()).style("stroke","none").filter(t=>"reEntry"===t.parent.data.type).style("stroke",this.color.indef.toString()).style("fill",this.color.pos.toString()).attr("transform","scale(1.5)");o.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",t=>"reEntry"!==t.parent.data.type||t.parent.data.lastOpen?this.color.indef.toString():this.color.pos.toString());o.select(".label.inside").style("fill",t=>"reEntry"!==t.parent.data.type&&t.data.lastOpen?this.color.indef.toString():this.color.pos.toString())};const T={common:{elemMargin:{hz:12,vt:8},formMargin:{top:10,right:10},formPadding:{hz:0},minFormSize:{width:34,height:34},maxLineWidth:1e4,strokeWidth:1.1}};T.basic={...C,...T.common},T.basic.applyNodeStyles=function(t,e){const[i,r,n,s,a,o,l,h,u,c]=e;r.select("polyline").style("fill","none").style("stroke",this.color.base.toString()).style("stroke-width",this.strokeWidth),n.select("polyline").filter(t=>t.data.unmarked).style("stroke","none"),l.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("fill",this.color.base.toString()),h.select("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),u.select("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),s.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",this.color.base.toString()),c.select(".unclearMark").style("fill",this.color.light.toString()),c.select("text").style("font-size",this.fontVar.size).style("font-style","normal").style("font-family",this.fontVar.family).style("stroke","none").style("fill",this.color.base.toString())};class N{constructor(t,e,i,...r){const s=function(t,e=v){const i=Object.assign({},e,t);return t.parentId?i.parent=n.select("#"+t.parentId):n.select("body"),i.svg=i.parent.append("svg").lower().attr("id",i.id||"chart").attr("width",i.width-i.margin.right).attr("height",i.height-i.margin.bottom),t.styleClass&&i.svg.attr("class",t.styleClass),t.drawBackground&&i.svg.append("rect").attr("id","background").attr("width","100%").attr("height","100%").attr("fill","#ffffff"),i.container=i.svg.append("g").attr("id","container").attr("transform",`translate(${i.margin.left}, ${i.margin.top})`),i}({margin:{left:50,right:50,top:50,bottom:50},padding:{left:10,right:10,top:10,bottom:10},styleClass:"basic",...i});Object.assign(this,s),this.innerHeight=this.height-this.margin.top-this.margin.bottom-this.padding.top-this.padding.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right-this.padding.left-this.padding.right,this.constructor[t].call(this,e,...r)}static tree(t){const e=this.container,i=n.hierarchy(t,t=>t.space),r=V[this.styleClass],[s,a]=[r.nodeSize,r.nodeSeparation],[o,l]=[r.font.size,r.font.family];this.padding={left:10,right:10,top:10,bottom:10},i.dx=s.w+a.hz,i.dy=this.width/(i.height+1);const h=n.tree().nodeSize([i.dx,i.dy]).separation((t,e)=>t.parent==e.parent?1:2)(i);let u=1/0,c=-u;h.each(t=>{t.x>c&&(c=t.x),t.x<u&&(u=t.x)});const f=i.data.unmarked,p=1.8*s.h,d=p;this.height=c-u+2*this.padding.top+s.h+2+d,this.svg.attr("width",this.width).attr("height",this.height),M(this.svg),e.classed("graph-tree",!0).attr("transform",`translate(${this.padding.left+s.w/2+(i.data.unmarked?-i.dy:0)},${this.padding.top-u+s.h/2})`);const y=n.range(i.height+(f?0:1));this.depthScale=n.scaleOrdinal().domain(y).range(y.map(t=>(t+(f?1:0))*i.dy));const m=n.axisBottom().scale(this.depthScale).tickSizeInner(-(c-u)).tickSizeOuter(0).tickPadding(p).tickValues(this.depthScale.domain().map(t=>this.depthScale.domain().length<15?"Depth "+t:t)),g=e.append("g").classed("depthAxis",!0).attr("transform",`translate(0, ${c})`).call(m);g.select(".domain").remove();const v=e.selectAll(".link").data(h.links()).enter().append("g").classed("link",!0),x=e.selectAll(".node").data(h.descendants()).enter().append("g").classed("node",!0).attr("transform",t=>`translate(${t.y},${t.x})`);f&&(v.filter(t=>0===t.source.depth).remove(),x.filter(t=>0===t.depth).remove());const E=function(t,e){const i=e.filter(t=>t.target.data.reChild).classed("reChildLink",!0),r=e.filter(t=>"reEntryPoint"===t.target.data.type).classed("rePointLink",!0);return[i,r]}(0,v),[P,S]=E,k=O(h,x),[C,B,A,T,N,D,z,I,R,$]=k;n.line().curve(n.curveBasis);v.append("path").attr("d",n.linkHorizontal().x(t=>t.y).y(t=>t.x)),x.filter(t=>!t.data.unmarked).append("circle").attr("r",s.w/2),D.append("text").attr("x",s.w/2+2).text(t=>{let e=t.parent,i=0;for(;"reEntry"!==e.data.type;){if(e=e.parent,i>1e3)return null;i++}return"undefined"!==e.data.reEven?e.data.reEven?"2|r|":"2|r|+1":""}),z.selectAll("circle").attr("r",s.w/2/2),x.append("text").attr("x",s.w/2+2),I.selectAll("text").call(w(t=>t.data.symbol)),R.selectAll("text").text(t=>"= "+t.data.value),$.selectAll("text").text(t=>`/${t.data.symbol}/`),B.filter(t=>t.children).append("circle").classed("inner",!0).attr("r",s.w/2/2),r.applyAxisStyles(g),r.applyLinkStyles(v,E),r.applyNodeStyles(x,k),b(e,this.padding)}static pack(t){const e=this.container;M(this.svg);const i=n.hierarchy(t,t=>t.space).sum(t=>t.children?0:1),r=A[this.styleClass],[s,a]=[r.radius,r.padding],[o,l]=[r.font.size,r.font.family],h=n.pack().padding(t=>{let e=a;return"form"===t.data.type&&1===t.children.length&&"form"===t.children[0].data.type&&(e*=.4),t.data.unmarked&&1===t.children.length&&(e=0),e}).radius(t=>{let e=s;return"string"==typeof t.data.symbol?(e=E(t.data.symbol,o,l).width/2,"unclear"===t.data.type&&(e+=2*a)):t.data.value?e=E(t.data.value+"",o,l).width/2:(t.data.children||"reEntryPoint"===t.data.type||"space"===t.data.type)&&(e=0),e})(i);e.attr("class","graph-pack").attr("transform",`translate(${h.r+this.padding.left},${h.r+this.padding.top})`);const u=e.selectAll(".node").data(h.descendants()).enter().append("g").classed("node",!0).attr("transform",t=>`translate(${t.x},${t.y})`),c=O(h,u),[f,p,d,y,m,g,v,x,P,S]=c;p.append("circle").attr("r",t=>t.r),x.append("text").call(w(t=>t.data.symbol)),P.append("text").text(t=>t.data.value),S.append("rect").attr("transform",t=>`skewX(-30) translate(${-(t.r-a)},\n            ${-(E("x",o,l).height+2*a)/2})`).attr("width",t=>2*t.r-2*a).attr("height",t=>E("x",o,l).height+2*a),S.append("text").call(w(t=>t.data.symbol)),g.append("circle").attr("r",1.5),y.filter(t=>"undefined"!==t.data.reEven).call(function(t,e="inherit",i="inherit",r="normal"){return s=>{s.each((function(s){const a=E(t(s),e,i);n.select(this).append("text").style("font-size",e).style("font-style",r).style("font-family",i).style("text-anchor","middle").raise().text(e=>t(e)),n.select(this).filter(t=>2*t.r>=a.width+50).select("text").classed("label inside",!0).attr("y",t=>t.r-.5*a.height).attr("dominant-baseline","baseline"),n.select(this).filter(t=>2*t.r<a.width+50).select("text").classed("label outside",!0).attr("y",t=>t.r+4).attr("dominant-baseline","hanging")}))}}(t=>t.data.reEven?"2|r|":"2|r|+1",r.fontContext.size,r.fontContext.family)),r.applyNodeStyles(u,c,e),b(e,this.padding)}static gsbhooks(t){const e=this.container;M(this.svg);const i=n.hierarchy(t,t=>t.space).sum(t=>t.space?0:1);this.styleClass="basic";const r=null===this.compactChecked||this.compactChecked,s=T[this.styleClass],{elemMargin:a,formMargin:o,formPadding:l,minFormSize:h,maxLineWidth:u,fontVar:c,fontConst:f,fontContext:p,labels:d}={...s},y=a.hz/2,m=a.vt,v=g()().vAlign("bottom").edgeMargins(t=>!(D(t)&&!t.parent.parent&&t.parent.data.unmarked)).isContainer(t=>D(t)).padding(t=>{let e={left:0,right:0,top:0,bottom:0};if(D(t)&&(e.left=e.right=l.hz,"reEntry"===t.data.type)){const i=E(t.data.reEven?d.reEven:d.reOdd,p.size,p.family,p.style);e.bottom=i.height+a.vt/2}return e}).margin(t=>{let e={left:0,right:0,top:0,bottom:0};return D(t)?(e.top=o.top,e.right=o.right,0===t.depth&&(e.top=0),t.data.reChild&&(1===t.parent.children.length&&(e.right=h.width),t.parent.data.lastOpen&&(e.top=0),r&&t.parent.data.reChild&&("reEntryPoint"===t.children[0].data.type&&z(t)||(e.top=0)))):"reEntryPoint"!==t.data.type?(e.top=e.bottom=a.vt,e.left=e.right=a.hz,"italic"==c.style&&(e.right+=1),"unclear"===t.data.type&&(e.bottom=0)):"reEntryPoint"===t.data.type&&(e.right=o.right),e}).spanHeight(t=>{let e=!1;return r&&t.data.reChild&&(e=!0),e}).minContainerSize(t=>{let e=h.width,i=h.height;if(t.data.reChild&&1===t.children.length&&"reEntryPoint"===t.children[0].data.type&&z(t)&&(e=h.width/2),"reEntry"===t.data.type&&t.children.length<=2&&"reEntryPoint"===t.children[0].data.type){e=E(t.data.reEven?d.reEven:d.reOdd,p.size,p.family,p.style).width+8,e=e<h.width?h.width:e}return{width:e,height:i}}).maxLineWidth(t=>u).nodeSize(t=>{let e=0,i=0;if("var"===(r=t).data.type||"const"===r.data.type||"unclear"===r.data.type){let r=void 0;switch(t.data.type){case"var":r=E(t.data.symbol,c.size,c.family,c.style),e=r.width,i=.7*r.height;break;case"unclear":r=E(t.data.symbol,c.size,c.family,"normal"),e=r.width,i=.7*r.height,e+=2*R(i+2*m)+2*y,i+=2*m;break;case"const":r=E(t.data.value,f.size,f.family,f.style),e=r.width,i=.7*r.height}}var r;return{width:e,height:i}})(i);e.attr("class","graph-boxmodel").attr("transform",`translate(${this.padding.left},${this.padding.top})`);const x=e.selectAll(".node").data(v.descendants()).enter().append("g").classed("node",!0).attr("transform",t=>`translate(${t.x0},${t.y0})`),P=O(v,x),[S,k,C,B,V,A,N,I,$,L]=P;C.append("polyline").attr("points",t=>`0,0 ${t.x1-t.x0},0 ${t.x1-t.x0},${t.y1-t.y0}`),B.append("polyline").attr("points",t=>{const e=t.x1-t.x0,i=t.y1-t.y0;return`0,0 ${e},0 ${e},${i} 0,${i} 0,${i-h.height}`}).filter(t=>t.data.lastOpen).attr("points",t=>{const e=t.x1-t.x0,i=t.y1-t.y0,r=h.height;return`${e},${i-r} ${e},${i} 0,${i} 0,${i-r}`}),B.filter(t=>"undefined"!==t.data.reEven).append("text").classed("label",!0).attr("transform",t=>`translate(0,${t.y1-t.y0})`).attr("x",t=>4).attr("y",t=>-5).text(t=>t.data.reEven?d.reEven:d.reOdd);const F=t=>R(.7*(t=>E(t.data.symbol,c.size,c.family,"normal"))(t).height+2*m);L.append("rect").classed("unclearMark",!0).attr("transform",t=>`skewX(-30) translate(${F(t)},0)`).attr("width",t=>t.x1-t.x0-F(t)).attr("height",t=>t.y1-t.y0),L.append("text").attr("x",t=>F(t)+y).attr("y",t=>t.y1-t.y0-m-(t.data.symbol.split("_").length>1?6:0)).call(w(t=>t.data.symbol)),$.append("text").attr("y",t=>t.y1-t.y0).text(t=>t.data.value),I.append("text").attr("y",t=>t.y1-t.y0).call(w(t=>t.data.symbol)),s.applyNodeStyles(x,P,e),b(e,this.padding)}static force(t){}}function O(t,e){const i=e.filter(e=>t.leaves().filter(t=>t===e).pop()).classed("leaf",!0),r=e.filter(t=>"form"===t.data.type||"reEntry"===t.data.type).classed("form",!0),n=r.filter(t=>"form"===t.data.type).classed("form",!0),s=r.filter(t=>"reEntry"===t.data.type).classed("reEntry",!0),a=e.filter(t=>!("form"===t.data.type||"reEntry"===t.data.type)).classed("element",!0),o=a.filter(t=>"var"===t.data.type).classed("var",!0);let l=a.filter(t=>"const"===t.data.type).classed("const",!0);l.unmarked=a.filter(t=>0==t.data.value).classed("unmarked",!0),l.marked=a.filter(t=>1==t.data.value).classed("marked",!0),l.indef=a.filter(t=>2==t.data.value).classed("indef",!0),l.imag=a.filter(t=>3==t.data.value).classed("imag",!0);const h=a.filter(t=>"unclear"===t.data.type).classed("unclear",!0),u=n.filter(t=>t.data.reChild).classed("reChild",!0);return[i,r,n,s,u,a.filter(t=>"reEntryPoint"===t.data.type).classed("reEntryPoint",!0),a,o,l,h]}function D(t){return"form"===t.data.type||"reEntry"===t.data.type}function z(t){return t.ancestors().filter(t=>"reEntry"===t.data.type).shift().data.lastOpen}const I=function(t,e,i,r){i=i||n.select(e.parentNode).attr("id");const o=function(){const t=new Date;return(""+t.getUTCFullYear()).substr(2)+a(t.getUTCMonth()+1,2)+a(t.getUTCDate(),2)+"-"+a(t.getHours(),2)+a(t.getMinutes(),2)+a(t.getSeconds(),2)}();try{switch(t){case"svg":!function(t,e){t.setAttribute("xmlns","http://www.w3.org/2000/svg");var i=t.outerHTML,r=new Blob(['<?xml version="1.0" standalone="no"?>\r\n',i],{type:"image/svg+xml;charset=utf-8"}),n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)}(e,o+"_"+i+".svg");break;case"img":!function(t,e,i=1){const r=t.getBBox().width,n=t.getBBox().height,a=document.createElement("canvas");a.setAttribute("id","drawingArea"),document.body.appendChild(a),a.width=r*i,a.height=n*i,s(document.getElementById("drawingArea"),t.outerHTML,{ignoreDimensions:!0,ignoreMouse:!0,ignoreAnimation:!0,scaleWidth:r*i,scaleHeight:n*i});const o=a.toDataURL("image/png");var l=document.createElement("a");l.href=o,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),document.body.removeChild(a)}(e,o+"_"+i+".png",r)}}catch(t){console.log(t)}};function R(t,e=30){return Math.tan(e*(Math.PI/180))*t}const $=(t,e,i,r,n=0,s="")=>{const a=j(e,r),o=4**e,l=Math.sqrt(o);t=t.substr(n*o,o),s+=`<g transform="translate(${F(n,l*i.w)+F(n,a)+F(n,r[e])},\n${q(n,l*i.h)+q(n,a)+q(n,r[e])})">`;for(let n=0;e>0&&n<4||0===e&&n<1;n++)if(e>1)s=$(t,e-1,i,r,n,s);else{const e=t.substr(n,1);s+=`<rect x=${F(n,i.w)} y=${q(n,i.h)} width=${i.w} height=${i.h} fill=${W(e)}></rect>`}return s+="</g>"},L=t=>t.split("").reduce((t,e,i,r)=>t+((i+1)%4==1?'<span class="dna-quart1">':"")+e+((i+1)%4==0?"</span>":""),""),F=(t,e)=>t%2*(void 0!==e?e:0),q=(t,e)=>+(t>0&&t<3)*(void 0!==e?e:0),j=(t,e)=>e.slice(1,t).reverse().reduce((t,e,i)=>t+2**i*e,0),X=t=>`align-items: ${"top"===t?"flex-start":"center"===t?"center":"flex-end"};`,W=t=>0==t?"#000000":1==t?"#4757ff":2==t?"#ff0044":3==t?"#00ff5f":NaN,U=i(1);const H=i(1);e.default={calc:r,form:y,graph:class extends y{constructor(){}static jsonString(t){const e=this.expand_reEntry(t);return super.jsonString(e)}static createGraph(t,e,i){const r="pack"===t,n=this.expand_reEntry(e,{addEmptyReChildSpace:r}),s=new N(t,n,i);return s.formula=e,s}static saveGraph(t,e,i,r){I(t,e,i,r)}static constructNested(t,e={}){let i=t.space=[];t.nested.reverse();for(let r in t.nested){if(r>0){i.unshift({type:"form",reChild:!0,space:[]});const e=i[0];t.nested[r].unmarked?e.space.push(...t.nested[r].space):e.space.push(t.nested[r]),i=e.space}else t.nested[r].unmarked?i.push(...t.nested[r].space):i.push(t.nested[r]);e.addEmptyReChildSpace&&0===i.length&&i.push({type:"space"})}let r=t;if(t.space.length>0)for(;r.space[0].hasOwnProperty("reChild")&&(r=r.space[0],!(r.space.length<1)););return t.lastOpen?(r.space.unshift({type:"form",reChild:!0,space:[]}),r.space[0].space.unshift({type:"reEntryPoint"})):r.space.unshift({type:"reEntryPoint"}),delete t.nested,t}static expand_reEntry(t,e={}){const i=this.getValidForm(t),r=JSON.parse(JSON.stringify(i));let n=0;return this.traverseForm(i,(function(t){t.runningIndex=n,n++})),n=0,this.traverseForm(r,(function(t){t.runningIndex=n,n++})),this.traverseForm(i,(function(t){"reEntry"===t.type&&this.traverseForm(r,(function(i){if(JSON.stringify(t)===JSON.stringify(i)&&t.runningIndex===(i.hasOwnProperty("runningIndex")?i.runningIndex:null))return i=this.constructNested(i,e),!0}))})),this.traverseForm(r,(function(t){delete t.runningIndex})),r}},dna:class extends y{constructor(){}static calcAll(t){if(t.includes("::")&&this.isValidDNA(t)){const e=t.split(":").pop(),i=e.split("").reverse(),r=this.totalVarsFromDNA(e),n=Array.from({length:r},(t,e)=>`"x_${e}"`),s={};if(r<1)return s.Result=parseInt(i[0]),s;const o=n.join()+";";for(let t=0;t<i.length;t++){const e=a(t.toString(4),r);e.split("").map((t,e)=>({var:n[e],value:parseInt(t)}));s[o+e]=i[t]}return s}return super.calcAll(t)}static getVariables(t){if("string"==typeof t&&t.includes("::")){const{dna:e,formula:i,varList:r}=this.getDNAparts(t);if(void 0!==r)return r;if(void 0!==i)return super.getVariables(i);const n=this.totalVarsFromDNA(e);return Array.from({length:n},(t,e)=>"x_"+e)}return super.getVariables(t)}static encode(t,e){const i=e?this.reOrderVars(t,e):t;return Object.values(this.calcAll(i)).reverse().join("")}static decode(t){return null}static intToDNA(t,e){const i=t.toString(4);if("-"===i.substr(0,1))throw new Error("Negative integers cannot be converted to formDNA.");if(i.includes("."))throw new Error("Fractional numbers cannot be converted to formDNA.");const r=e?4**e:function t(e,i=0){return 4**i>=e?4**i:t(e,i+1)}(i.length);if(i.length>r)throw new Error("Integer size exceeds desired DNA length.");return a(i,r)}static formToDNA(t,e,i){const{output:r}={output:"text",...i};let n=void 0,s=void 0,a=void 0;if(t.includes("::")){if(!this.isValidDNA(t))throw new Error("Input is not valid formDNA");const e=this.getDNAparts(t);n=e.dna,s=e.formula,a=e.varList}else n=this.encode(t,e||void 0),s=t,a=e||this.getVariables(s);switch(r){case"html":return function(t,e,i){return`<div id="dna"><code>${(void 0!==t?`<span class="dna-form" title="FORM">${t}</span>`:"")+(i&&e.length>1?'.<span class="dna-varorder" title="Variable interpretation order">['+i.join(",")+"]</span>":"")}::<span class="dna-code">${L(e)}</span></code></div>`}(s,n,a);case"text":return(void 0!==s?s:"")+(a&&n.length>1?`.[${a.join(",")}]`:"")+"::"+n;case"num":return n;default:return[s,a,n]}}static dnaToFORM(t,e,i){return this.decode(t,e)}static genRandomDNA(t){const e=H(4).pow(H(4).pow(t)),i=(r=e.subtract(1),U.randBetween(0,r));var r;return this.intToDNA(i,t)}static vmap(t,e,i){const{limitSize:r,convDefaultVarorder:n}={limitSize:!0,convDefaultVarorder:!0,...i};let s=void 0,a=t;if(t.includes("::")&&this.isValidDNA(t)){const i=this.getDNAparts(t);s=i.dna,a=i.formula;const r=i.varList?i.varList:this.getVariables(t);if(void 0!==e&&void 0!==r&&(h=r,void 0===(l=e)||void 0===h||l.length!==h.length||!l.every(t=>h.some(e=>t===e))))throw new Error("Variable order is specified in the formDNA input and as an argument for the vmap function and they are different. Please select only one specification to avoid conflicting results.");r?e=r:a&&(e=this.getVariables(a))}else e||(e=this.getVariables(a),n&&(e=this.matchDefaultVarOrder(e)));var l,h;s||(s=this.encode(a,e));const u=this.totalVarsFromDNA(s);if(NaN===u)throw new Error("Invalid variable number for vmaps.");if(r&&u>8)throw new Error('vmaps with more than 8 variables are too computationally intensive to be rendered with this implementation. If you still want to proceed, add the option "limitSize: false" to your vmap function call (using the formform library).');return function(t,e,i,r,n){const s=Math.sqrt(i.length),a=t.includes("::"),{size:l,gapGrow:h,svgPad:u,strokeW:c,strokeC:f,bgC:p,hideInputLabel:d,hideOrderLabel:y,customLabel:m,fullInputLabel:g,inputLabelMax:v,filter:b}={size:(t=>{const e=14-(t-1);return Math.max(2,e)})(r),gapGrow:1.5,svgPad:"0",strokeW:.5,strokeC:"#fff",bgC:"none",hideInputLabel:!1,hideOrderLabel:!1,fullInputLabel:!1,inputLabelMax:200,customLabel:void 0,...n},x=[c,...Array.from({length:r-1},(t,e)=>(e+1)*h)],w={w:l,h:l},E=j(r,x),P=w.w*s+x[0]+E,S=w.h*s+x[0]+E,k=Math.sqrt(2*P**2),C=Math.sqrt(2*S**2),B=i.split("").reverse().join("");return`<figure class="vmap" style="margin: 0;">\n\t\t<svg style="background: ${p}; padding: ${u};" width=${w.w*s+E} height=${w.h*s+E}\n\t\tfill="white" stroke="${f}" stroke-width="${x[0]}"\n\t\tviewBox="-${x[0]/2} -${x[0]/2} ${k} ${C}">\n\t\t<g transform="translate(0,${C/2}) rotate(-45,0,0)">${$(B,r,w,x)}</g>\n\t\t</svg>\n\t\t${(()=>{if(void 0!==m)return`<figcaption style="word-wrap: break-word;">${m}</figcaption>`;if(!d||!y){let i="";return y||(i+=`${e.reduce((t,e,i)=>t+(i>0?" > ":"")+(t=>{if(t.length>1){const e=t.split("_");return e.length>1?`${e[0]}<sub>${e[1]}</sub>`:`"${t}"`}return t})(e),"")}${d||r<1?"":"<br/>"}`),d||(i+=a?`<code style="font-size:0.8em;">${g?t:o(t,t.split("::")[0].length+256,`…(${4**r})`)}</code>`:"ƒ = "+(g?t:o(t,v,"… <i>+more</i>"))),`<figcaption style="word-wrap: break-word;">${i}</figcaption>`}return""})()}\n\t\t</figure>`}(t,e,s,u,i)}static vmapPerspectives(t,e,i){const{limitSize:r}={limitSize:!0,...i};if("string"==typeof t&&t.includes("::"))throw new Error("formDNA input is not yet supported for vmap perspectives.");void 0===e&&(e=this.matchDefaultVarOrder(this.getVariables(t)));const n=e.length;if(r&&n>5)throw new Error('Rendering all the perspectives for vmaps with more than 5 variables is too computationally intensive with this implementation. You can, however, still compute single permutations by changing the variable order of your FORM. If you still want to proceed, add the option "limitSize: false" to your vmapPerspectives function call (using the formform library).');const s=t;var a;return function(t,e,i){const{margin:r,customLabel:n}={margin:20,customLabel:void 0,...i},s=t.map(t=>`<div class="vmap-item" style="padding: ${Math.floor(r/4)}px ${Math.floor(r/2)}px"> \n\t\t\t\t${t}</div>`).reduce((t,e)=>t+e,""),a=void 0!==n?n:"ƒ = "+e;return`<figure class="vmap-perspectives" style="max-width: none;">\n\t\t\t<div class="vmap-list" style="display: flex; flex-wrap: wrap; margin: 0 -${Math.floor(r/2)}px">\n\t\t\t${s}\n\t\t\t</div>\n\t\t\t<figcaption style="border-top: 1px solid; padding-top: ${Math.floor(r/4)}px; margin-top: ${Math.floor(r/2)}px; word-wrap: break-word;">${a}</figcaption>\n\t\t\t</figure>`}((a=e,a.reduce((function t(e,i,r,n){return e.concat(n.length>1&&n.slice(0,r).concat(n.slice(r+1)).reduce(t,[]).map((function(t){return[i].concat(t)}))||[[i]])}),[])).map(t=>this.vmap(s,t,{hideInputLabel:!0,customLabel:void 0,...i})),s,i)}static vmapList(t,e){return function(t,e){const{margin:i,vAlign:r}={margin:20,vAlign:"bottom",...e};return`<div class="vmap-list" style="display: flex; flex-wrap: wrap; ${X(r)} margin: 0 -${Math.floor(i/2)}px">\n\t\t\t${t.reduce((t,e)=>`${t}<div class="vmap-item" style="padding: ${Math.floor(i/4)}px ${Math.floor(i/2)}px">${e}</div>`,"")}\n\t\t\t</div>`}(t.map(t=>this.vmap(t[0],t[1],{...t[2],...e})),e)}static dnaMatchesForm(t,e,i,r){const n=i||super.getVariables(e);return(i?[u(()=>this.formMatchesVarList(e,n),"FORM doesn't match the given variable list"),u(()=>n.length===this.totalVarsFromDNA(t),"Number of variables in given variable list doesn't match formDNA code length"),u(()=>this.encode(e,n)===t,"formDNA code is inconsistent with FORM interpretation results (respecting specified variable order)")]:[u(()=>n&&n.length===this.totalVarsFromDNA(t),"Number of FORM variables doesn't match formDNA code length"),u(()=>this.encode(e)===t,"formDNA code is inconsistent with FORM interpretation results")]).every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))}static isValidDNA(t,e){const{compareForm:i,requireMark:r}={compareForm:!0,requireMark:!0,...e},n=r?t:"::"+t;[u(()=>"string"==typeof n,"formDNA input is not of type ‘string’"),u(()=>n.includes("::"),"Input does not include the mark ‘::’ for formDNA"),u(()=>n.length>=3,"formDNA input is too short")].every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}));const{dna:s,formula:a,varList:o}=this.getDNAparts(n);return[u(()=>this.totalVarsFromDNA(s)>=0,"formDNA code length is not in the range 4^x"),u(()=>!s.split("").some(t=>isNaN(parseInt(t))||parseInt(t)<0||parseInt(t)>3),"formDNA code is not in quaternion format (consisting only of the numbers 0/1/2/3)"),i&&void 0!==a?u(()=>this.dnaMatchesForm(s,a,o),"formDNA code part doesn't match formula part or formula part doesn't match its specified variable order"):null].filter(t=>t).every(t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})),!0}static totalVarsFromDNA(t){const e=t.split(":").pop(),i=Math.log(e.length)/Math.log(4);return i%1==0?i:NaN}static repairDNA(t){if(t.includes("::")){const e=this.getDNAparts(t);if(e.formula){let t=void 0;try{e.varList&&this.formMatchesVarList(e.formula,e.varList)&&(t=e.varList)}catch(t){console.error(t.message)}return this.formToDNA(e.formula,t)}return this.isValidDNA(t)?t:null}return this.formToDNA(t)}static getDNAparts(t){let e=void 0,i=void 0,r=void 0;const n=t.split(":");if(e=n.pop(),n[0].length>0){const t=n[0].split(".");i=t[0],r=t.length>1?t[1].slice(1,-1).split(","):r}return{dna:e,formula:i,varList:r}}}}}]).default}));
//# sourceMappingURL=formform.min.js.map