!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.formform=e(require("d3")):t.formform=e(t.d3)}(window,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(e,n){e.exports=t},function(t,e,n){t.exports=function(t,e){"use strict";var n;return t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e,function(n){var r;function i(){return document.createElement("canvas")}n.exports,(r=window).DOMParser=window.DOMParser;var o,a=function(n,s,l){if(null!=n||null!=s||null!=l){var u=function(n){var a={opts:n,FRAMERATE:30,MAX_VIRTUAL_PIXELS:3e4,rootEmSize:12,emSize:12,log:function(t){}};1==a.opts.log&&"undefined"!=typeof console&&(a.log=function(t){console.log(t)}),a.init=function(t){var e=0;a.UniqueId=function(){return"canvg"+ ++e},a.Definitions={},a.Styles={},a.StylesSpecificity={},a.Animations=[],a.Images=[],a.ctx=t,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(t,e){this.viewPorts.push({width:t,height:e})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(t){return null!=t&&"number"==typeof t?t:"x"==t?this.width():"y"==t?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var t=0;t<a.Images.length;t++)if(!a.Images[t].loaded)return!1;return!0},a.trim=function(t){return t.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(t){return t.replace(/(?!\u3000)\s+/gm," ")},a.ajax=function(t){var e;return(e=r.XMLHttpRequest?new r.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"))?(e.open("GET",t,!1),e.send(null),e.responseText):null},a.parseXml=function(t){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var e=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings;return i.prohibitDtd=!1,e.loadXml(t,i),e}if(!r.DOMParser)return t=t.replace(/<!DOCTYPE svg[^>]*>/,""),(e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t),e;try{var o=n.xmldom?new r.DOMParser(n.xmldom):new r.DOMParser;return o.parseFromString(t,"image/svg+xml")}catch(e){return(o=n.xmldom?new r.DOMParser(n.xmldom):new r.DOMParser).parseFromString(t,"text/xml")}},a.Property=function(t,e){this.name=t,this.value=e},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var t=parseFloat(this.value);return(this.value+"").match(/%$/)&&(t/=100),t},a.Property.prototype.valueOrDefault=function(t){return this.hasValue()?this.value:t},a.Property.prototype.numValueOrDefault=function(t){return this.hasValue()?this.numValue():t},a.Property.prototype.addOpacity=function(e){var n=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var r=new t(this.value);r.ok&&(n="rgba("+r.r+", "+r.g+", "+r.b+", "+e.numValue()+")")}return new a.Property(this.name,n)},a.Property.prototype.getDefinition=function(){var t=this.value.match(/#([^\)'"]+)/);return t&&(t=t[1]),t||(t=this.value),a.Definitions[t]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(t,e){var n=this.getDefinition();if(null!=n&&n.createGradient)return n.createGradient(a.ctx,t,e);if(null!=n&&n.createPattern){if(n.getHrefAttribute().hasValue()){var r=n.attribute("patternTransform");n=n.getHrefAttribute().getDefinition(),r.hasValue()&&(n.attribute("patternTransform",!0).value=r.value)}return n.createPattern(a.ctx,t)}return null},a.Property.prototype.getDPI=function(t){return 96},a.Property.prototype.getREM=function(t){return a.rootEmSize},a.Property.prototype.getEM=function(t){return a.emSize},a.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},a.Property.prototype.isPixels=function(){if(!this.hasValue())return!1;var t=this.value+"";return!!t.match(/px$/)||!!t.match(/^[0-9]+$/)},a.Property.prototype.toPixels=function(t,e){if(!this.hasValue())return 0;var n=this.value+"";if(n.match(/rem$/))return this.numValue()*this.getREM(t);if(n.match(/em$/))return this.numValue()*this.getEM(t);if(n.match(/ex$/))return this.numValue()*this.getEM(t)/2;if(n.match(/px$/))return this.numValue();if(n.match(/pt$/))return this.numValue()*this.getDPI(t)*(1/72);if(n.match(/pc$/))return 15*this.numValue();if(n.match(/cm$/))return this.numValue()*this.getDPI(t)/2.54;if(n.match(/mm$/))return this.numValue()*this.getDPI(t)/25.4;if(n.match(/in$/))return this.numValue()*this.getDPI(t);if(n.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(t);var r=this.numValue();return e&&r<1?r*a.ViewPort.ComputeSize(t):r},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/s$/)?1e3*this.numValue():(t.match(/ms$/),this.numValue())},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var t=this.value+"";return t.match(/deg$/)?this.numValue()*(Math.PI/180):t.match(/grad$/)?this.numValue()*(Math.PI/200):t.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var s={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return a.Property.prototype.toTextBaseline=function(){return this.hasValue()?s[this.value]:null},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(t,e,n,r,i,o){var s=null!=o?this.Parse(o):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:i=i||s.fontFamily,fontSize:r||s.fontSize,fontStyle:t||s.fontStyle,fontWeight:n||s.fontWeight,fontVariant:e||s.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var t=this;this.Parse=function(e){for(var n={},r=a.trim(a.compressSpaces(e||"")).split(" "),i={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},o="",s=0;s<r.length;s++)i.fontStyle||-1==t.Styles.indexOf(r[s])?i.fontVariant||-1==t.Variants.indexOf(r[s])?i.fontWeight||-1==t.Weights.indexOf(r[s])?i.fontSize?"inherit"!=r[s]&&(o+=r[s]):("inherit"!=r[s]&&(n.fontSize=r[s].split("/")[0]),i.fontStyle=i.fontVariant=i.fontWeight=i.fontSize=!0):("inherit"!=r[s]&&(n.fontWeight=r[s]),i.fontStyle=i.fontVariant=i.fontWeight=!0):("inherit"!=r[s]&&(n.fontVariant=r[s]),i.fontStyle=i.fontVariant=!0):("inherit"!=r[s]&&(n.fontStyle=r[s]),i.fontStyle=!0);return""!=o&&(n.fontFamily=o),n}},a.ToNumberArray=function(t){for(var e=a.trim(a.compressSpaces((t||"").replace(/,/g," "))).split(" "),n=0;n<e.length;n++)e[n]=parseFloat(e[n]);return e},a.Point=function(t,e){this.x=t,this.y=e},a.Point.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},a.Point.prototype.applyTransform=function(t){var e=this.x*t[0]+this.y*t[2]+t[4],n=this.x*t[1]+this.y*t[3]+t[5];this.x=e,this.y=n},a.CreatePoint=function(t){var e=a.ToNumberArray(t);return new a.Point(e[0],e[1])},a.CreatePath=function(t){for(var e=a.ToNumberArray(t),n=[],r=0;r<e.length;r+=2)n.push(new a.Point(e[r],e[r+1]));return n},a.BoundingBox=function(t,e,n,r){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(t,e){null!=t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),null!=e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},this.addX=function(t){this.addPoint(t,null)},this.addY=function(t){this.addPoint(null,t)},this.addBoundingBox=function(t){this.addPoint(t.x1,t.y1),this.addPoint(t.x2,t.y2)},this.addQuadraticCurve=function(t,e,n,r,i,o){var a=t+2/3*(n-t),s=e+2/3*(r-e),l=a+1/3*(i-t),u=s+1/3*(o-e);this.addBezierCurve(t,e,a,l,s,u,i,o)},this.addBezierCurve=function(t,e,n,r,i,o,a,s){var l=[t,e],u=[n,r],h=[i,o],c=[a,s];this.addPoint(l[0],l[1]),this.addPoint(c[0],c[1]);for(var f=0;f<=1;f++){var p=function(t){return Math.pow(1-t,3)*l[f]+3*Math.pow(1-t,2)*t*u[f]+3*(1-t)*Math.pow(t,2)*h[f]+Math.pow(t,3)*c[f]},d=6*l[f]-12*u[f]+6*h[f],y=-3*l[f]+9*u[f]-9*h[f]+3*c[f],v=3*u[f]-3*l[f];if(0!=y){var m=Math.pow(d,2)-4*v*y;if(!(m<0)){var g=(-d+Math.sqrt(m))/(2*y);0<g&&g<1&&(0==f&&this.addX(p(g)),1==f&&this.addY(p(g)));var b=(-d-Math.sqrt(m))/(2*y);0<b&&b<1&&(0==f&&this.addX(p(b)),1==f&&this.addY(p(b)))}}else{if(0==d)continue;var x=-v/d;0<x&&x<1&&(0==f&&this.addX(p(x)),1==f&&this.addY(p(x)))}}},this.isPointInBox=function(t,e){return this.x1<=t&&t<=this.x2&&this.y1<=e&&e<=this.y2},this.addPoint(t,e),this.addPoint(n,r)},a.Transform=function(t){var e=this;this.Type={},this.Type.translate=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.translate(this.p.x||0,this.p.y||0)},this.unapply=function(t){t.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(t){t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(t){var e=a.ToNumberArray(t);this.angle=new a.Property("angle",e[0]),this.cx=e[1]||0,this.cy=e[2]||0,this.apply=function(t){t.translate(this.cx,this.cy),t.rotate(this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.unapply=function(t){t.translate(this.cx,this.cy),t.rotate(-1*this.angle.toRadians()),t.translate(-this.cx,-this.cy)},this.applyToPoint=function(t){var e=this.angle.toRadians();t.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),t.applyTransform([Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0]),t.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(t){this.p=a.CreatePoint(t),this.apply=function(t){t.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(t){t.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(t){t.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(t){this.m=a.ToNumberArray(t),this.apply=function(t){t.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(t){var e=this.m[0],n=this.m[2],r=this.m[4],i=this.m[1],o=this.m[3],a=this.m[5],s=1/(e*(1*o-0*a)-n*(1*i-0*a)+r*(0*i-0*o));t.transform(s*(1*o-0*a),s*(0*a-1*i),s*(0*r-1*n),s*(1*e-0*r),s*(n*a-r*o),s*(r*i-e*a))},this.applyToPoint=function(t){t.applyTransform(this.m)}},this.Type.SkewBase=function(t){this.base=e.Type.matrix,this.base(t),this.angle=new a.Property("angle",t)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(t){this.base=e.Type.SkewBase,this.base(t),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].apply(t)},this.unapply=function(t){for(var e=this.transforms.length-1;0<=e;e--)this.transforms[e].unapply(t)},this.applyToPoint=function(t){for(var e=0;e<this.transforms.length;e++)this.transforms[e].applyToPoint(t)};for(var n=a.trim(a.compressSpaces(t)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),r=0;r<n.length;r++)if("none"!==n[r]){var i=a.trim(n[r].split("(")[0]),o=n[r].split("(")[1].replace(")",""),s=this.Type[i];if(void 0!==s){var l=new s(o);l.type=i,this.transforms.push(l)}}},a.AspectRatio=function(t,e,n,r,i,o,s,l,u,h){var c=(e=(e=a.compressSpaces(e)).replace(/^defer\s/,"")).split(" ")[0]||"xMidYMid",f=e.split(" ")[1]||"meet",p=n/r,d=i/o,y=Math.min(p,d),v=Math.max(p,d);"meet"==f&&(r*=y,o*=y),"slice"==f&&(r*=v,o*=v),u=new a.Property("refX",u),h=new a.Property("refY",h),u.hasValue()&&h.hasValue()?t.translate(-y*u.toPixels("x"),-y*h.toPixels("y")):(c.match(/^xMid/)&&("meet"==f&&y==d||"slice"==f&&v==d)&&t.translate(n/2-r/2,0),c.match(/YMid$/)&&("meet"==f&&y==p||"slice"==f&&v==p)&&t.translate(0,i/2-o/2),c.match(/^xMax/)&&("meet"==f&&y==d||"slice"==f&&v==d)&&t.translate(n-r,0),c.match(/YMax$/)&&("meet"==f&&y==p||"slice"==f&&v==p)&&t.translate(0,i-o)),"none"==c?t.scale(p,d):"meet"==f?t.scale(y,y):"slice"==f&&t.scale(v,v),t.translate(null==s?0:-s,null==l?0:-l)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(t){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(t,e){var n=this.attributes[t];return null!=n?n:(1==e&&(n=new a.Property(t,""),this.attributes[t]=n),n||a.EmptyProperty)},this.getHrefAttribute=function(){for(var t in this.attributes)if("href"==t||t.match(/:href$/))return this.attributes[t];return a.EmptyProperty},this.style=function(t,e,n){var r=this.styles[t];if(null!=r)return r;var i=this.attribute(t);if(null!=i&&i.hasValue())return this.styles[t]=i;if(1!=n){var o=this.parent;if(null!=o){var s=o.style(t);if(null!=s&&s.hasValue())return s}}return 1==e&&(r=new a.Property(t,""),this.styles[t]=r),r||a.EmptyProperty},this.render=function(t){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(t.save(),this.style("mask").hasValue()){var e=this.style("mask").getDefinition();null!=e&&e.apply(t,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(t,this)}else this.setContext(t),this.renderChildren(t),this.clearContext(t);t.restore()}},this.setContext=function(t){},this.clearContext=function(t){},this.renderChildren=function(t){for(var e=0;e<this.children.length;e++)this.children[e].render(t)},this.addChild=function(t,e){var n=t;e&&(n=a.CreateElement(t)),n.parent=this,"title"!=n.type&&this.children.push(n)},this.addStylesFromStyleDefinition=function(){for(var e in a.Styles)if("@"!=e[0]&&o(t,e)){var n=a.Styles[e],r=a.StylesSpecificity[e];if(null!=n)for(var i in n){var s=this.stylesSpecificity[i];void 0===s&&(s="000"),s<r&&(this.styles[i]=n[i],this.stylesSpecificity[i]=r)}}};var e,n=new RegExp("^[A-Z-]+$");if(null!=t&&1==t.nodeType){for(var r=0;r<t.attributes.length;r++){var i=t.attributes[r],s=(e=i.nodeName,n.test(e)?e.toLowerCase():e);this.attributes[s]=new a.Property(s,i.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue()){var l=this.attribute("style").value.split(";");for(r=0;r<l.length;r++)if(""!=a.trim(l[r])){var u=l[r].split(":"),h=a.trim(u[0]),c=a.trim(u[1]);this.styles[h]=new a.Property(h,c)}}for(this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this),r=0;r<t.childNodes.length;r++){var f=t.childNodes[r];if(1==f.nodeType&&this.addChild(f,!0),this.captureTextNodes&&(3==f.nodeType||4==f.nodeType)){var p=f.value||f.text||f.textContent||"";""!=a.compressSpaces(p)&&this.addChild(new a.Element.tspan(f),!1)}}}},a.Element.RenderedElementBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.calculateOpacity=function(){for(var t=1,e=this;null!=e;){var n=e.style("opacity",!1,!0);n.hasValue()&&(t*=n.numValue()),e=e.parent}return t},this.setContext=function(t,e){if(!e){var n;if(this.style("fill").isUrlDefinition())null!=(n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity")))&&(t.fillStyle=n);else if(this.style("fill").hasValue()){var r;"currentColor"==(r=this.style("fill")).value&&(r.value=this.style("color").value),"inherit"!=r.value&&(t.fillStyle="none"==r.value?"rgba(0,0,0,0)":r.value)}if(this.style("fill-opacity").hasValue()&&(r=(r=new a.Property("fill",t.fillStyle)).addOpacity(this.style("fill-opacity")),t.fillStyle=r.value),this.style("stroke").isUrlDefinition())null!=(n=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity")))&&(t.strokeStyle=n);else if(this.style("stroke").hasValue()){var i;"currentColor"==(i=this.style("stroke")).value&&(i.value=this.style("color").value),"inherit"!=i.value&&(t.strokeStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("stroke-opacity").hasValue()&&(i=(i=new a.Property("stroke",t.strokeStyle)).addOpacity(this.style("stroke-opacity")),t.strokeStyle=i.value),this.style("stroke-width").hasValue()){var o=this.style("stroke-width").toPixels();t.lineWidth=0==o?.001:o}if(this.style("stroke-linecap").hasValue()&&(t.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(t.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(t.miterLimit=this.style("stroke-miterlimit").value),this.style("paint-order").hasValue()&&(t.paintOrder=this.style("paint-order").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var s=a.ToNumberArray(this.style("stroke-dasharray").value);void 0!==t.setLineDash?t.setLineDash(s):void 0!==t.webkitLineDash?t.webkitLineDash=s:void 0===t.mozDash||1==s.length&&0==s[0]||(t.mozDash=s);var l=this.style("stroke-dashoffset").toPixels();void 0!==t.lineDashOffset?t.lineDashOffset=l:void 0!==t.webkitLineDashOffset?t.webkitLineDashOffset=l:void 0!==t.mozDashOffset&&(t.mozDashOffset=l)}}if(void 0!==t.font){t.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString();var u=this.style("font-size",!1,!1);u.isPixels()&&(a.emSize=u.toPixels())}if(this.style("transform",!1,!0).hasValue()&&new a.Transform(this.style("transform",!1,!0).value).apply(t),this.style("clip-path",!1,!0).hasValue()){var h=this.style("clip-path",!1,!0).getDefinition();null!=h&&h.apply(t)}t.globalAlpha=this.calculateOpacity()}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.path=function(t){return null!=t&&t.beginPath(),new a.BoundingBox},this.renderChildren=function(t){this.path(t),a.Mouse.checkPath(this,t),""!=t.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?t.fill(this.style("fill-rule").value):t.fill()),""!=t.strokeStyle&&t.stroke();var e=this.getMarkers();if(null!=e){if(this.style("marker-start").isUrlDefinition()&&(n=this.style("marker-start").getDefinition()).render(t,e[0][0],e[0][1]),this.style("marker-mid").isUrlDefinition())for(var n=this.style("marker-mid").getDefinition(),r=1;r<e.length-1;r++)n.render(t,e[r][0],e[r][1]);this.style("marker-end").isUrlDefinition()&&(n=this.style("marker-end").getDefinition()).render(t,e[e.length-1][0],e[e.length-1][1])}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseClearContext=this.clearContext,this.clearContext=function(t){this.baseClearContext(t),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(t){if(t.strokeStyle="rgba(0,0,0,0)",t.lineCap="butt",t.lineJoin="miter",t.miterLimit=4,t.canvas.style&&void 0!==t.font&&void 0!==r.getComputedStyle){t.font=r.getComputedStyle(t.canvas).getPropertyValue("font");var e=new a.Property("fontSize",a.Font.Parse(t.font).fontSize);e.hasValue()&&(a.rootEmSize=a.emSize=e.toPixels("y"))}this.baseSetContext(t),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),t.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=a.ViewPort.width(),i=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root){n=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var o=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(o=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(t.beginPath(),t.moveTo(o,s),t.lineTo(n,s),t.lineTo(n,i),t.lineTo(o,i),t.closePath(),t.clip())}if(a.ViewPort.SetCurrent(n,i),this.attribute("viewBox").hasValue()){var l=a.ToNumberArray(this.attribute("viewBox").value),u=l[0],h=l[1];n=l[2],i=l[3],a.AspectRatio(t,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),n,a.ViewPort.height(),i,u,h,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(l[2],l[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),r=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y"),o=this.attribute("rx").toPixels("x"),s=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(s=o),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(o=s),o=Math.min(o,r/2),s=Math.min(s,i/2),null!=t){var l=(Math.sqrt(2)-1)/3*4;t.beginPath(),t.moveTo(e+o,n),t.lineTo(e+r-o,n),t.bezierCurveTo(e+r-o+l*o,n,e+r,n+s-l*s,e+r,n+s),t.lineTo(e+r,n+i-s),t.bezierCurveTo(e+r,n+i-s+l*s,e+r-o+l*o,n+i,e+r-o,n+i),t.lineTo(e+o,n+i),t.bezierCurveTo(e+o-l*o,n+i,e,n+i-s+l*s,e,n+i-s),t.lineTo(e,n+s),t.bezierCurveTo(e,n+s-l*s,e+o-l*o,n,e+o,n),t.closePath()}return new a.BoundingBox(e,n,e+r,n+i)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=this.attribute("cx").toPixels("x"),n=this.attribute("cy").toPixels("y"),r=this.attribute("r").toPixels();return null!=t&&(t.beginPath(),t.arc(e,n,r,0,2*Math.PI,!1),t.closePath()),new a.BoundingBox(e-r,n-r,e+r,n+r)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(t){this.base=a.Element.PathElementBase,this.base(t),this.path=function(t){var e=(Math.sqrt(2)-1)/3*4,n=this.attribute("rx").toPixels("x"),r=this.attribute("ry").toPixels("y"),i=this.attribute("cx").toPixels("x"),o=this.attribute("cy").toPixels("y");return null!=t&&(t.beginPath(),t.moveTo(i+n,o),t.bezierCurveTo(i+n,o+e*r,i+e*n,o+r,i,o+r),t.bezierCurveTo(i-e*n,o+r,i-n,o+e*r,i-n,o),t.bezierCurveTo(i-n,o-e*r,i-e*n,o-r,i,o-r),t.bezierCurveTo(i+e*n,o-r,i+n,o-e*r,i+n,o),t.closePath()),new a.BoundingBox(i-n,o-r,i+n,o+r)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(t){this.base=a.Element.PathElementBase,this.base(t),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(t){var e=this.getPoints();return null!=t&&(t.beginPath(),t.moveTo(e[0].x,e[0].y),t.lineTo(e[1].x,e[1].y)),new a.BoundingBox(e[0].x,e[0].y,e[1].x,e[1].y)},this.getMarkers=function(){var t=this.getPoints(),e=t[0].angleTo(t[1]);return[[t[0],e],[t[1],e]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(t){this.base=a.Element.PathElementBase,this.base(t),this.points=a.CreatePath(this.attribute("points").value),this.path=function(t){var e=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=t&&(t.beginPath(),t.moveTo(this.points[0].x,this.points[0].y));for(var n=1;n<this.points.length;n++)e.addPoint(this.points[n].x,this.points[n].y),null!=t&&t.lineTo(this.points[n].x,this.points[n].y);return e},this.getMarkers=function(){for(var t=[],e=0;e<this.points.length-1;e++)t.push([this.points[e],this.points[e].angleTo(this.points[e+1])]);return 0<t.length&&t.push([this.points[this.points.length-1],t[t.length-1][1]]),t}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(t){this.base=a.Element.polyline,this.base(t),this.basePath=this.path,this.path=function(t){var e=this.basePath(t);return null!=t&&(t.lineTo(this.points[0].x,this.points[0].y),t.closePath()),e}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(t){this.base=a.Element.PathElementBase,this.base(t);var e=this.attribute("d").value;e=e.replace(/,/gm," ");for(var n=0;n<2;n++)e=e.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");for(e=(e=e.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2"),n=0;n<2;n++)e=e.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");e=e.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),e=a.compressSpaces(e),e=a.trim(e),this.PathParser=new function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(t){return this.isRelativeCommand()&&(t.x+=this.current.x,t.y+=this.current.y),t},this.addMarker=function(t,e,n){null!=n&&0<this.angles.length&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(t,null==e?null:e.angleTo(t))},this.addMarkerAngle=function(t,e){this.points.push(t),this.angles.push(e)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var t=0;t<this.angles.length;t++)if(null==this.angles[t])for(var e=t+1;e<this.angles.length;e++)if(null!=this.angles[e]){this.angles[t]=this.angles[e];break}return this.angles}}(e),this.path=function(t){var e=this.PathParser;e.reset();var n=new a.BoundingBox;for(null!=t&&t.beginPath();!e.isEnd();)switch(e.nextCommand(),e.command){case"M":case"m":var r=e.getAsCurrentPoint();for(e.addMarker(r),n.addPoint(r.x,r.y),null!=t&&t.moveTo(r.x,r.y),e.start=e.current;!e.isCommandOrEnd();)r=e.getAsCurrentPoint(),e.addMarker(r,e.start),n.addPoint(r.x,r.y),null!=t&&t.lineTo(r.x,r.y);break;case"L":case"l":for(;!e.isCommandOrEnd();){var i=e.current;r=e.getAsCurrentPoint(),e.addMarker(r,i),n.addPoint(r.x,r.y),null!=t&&t.lineTo(r.x,r.y)}break;case"H":case"h":for(;!e.isCommandOrEnd();){var o=new a.Point((e.isRelativeCommand()?e.current.x:0)+e.getScalar(),e.current.y);e.addMarker(o,e.current),e.current=o,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y)}break;case"V":case"v":for(;!e.isCommandOrEnd();)o=new a.Point(e.current.x,(e.isRelativeCommand()?e.current.y:0)+e.getScalar()),e.addMarker(o,e.current),e.current=o,n.addPoint(e.current.x,e.current.y),null!=t&&t.lineTo(e.current.x,e.current.y);break;case"C":case"c":for(;!e.isCommandOrEnd();){var s=e.current,l=e.getPoint(),u=e.getAsControlPoint(),h=e.getAsCurrentPoint();e.addMarker(h,u,l),n.addBezierCurve(s.x,s.y,l.x,l.y,u.x,u.y,h.x,h.y),null!=t&&t.bezierCurveTo(l.x,l.y,u.x,u.y,h.x,h.y)}break;case"S":case"s":for(;!e.isCommandOrEnd();)s=e.current,l=e.getReflectedControlPoint(),u=e.getAsControlPoint(),h=e.getAsCurrentPoint(),e.addMarker(h,u,l),n.addBezierCurve(s.x,s.y,l.x,l.y,u.x,u.y,h.x,h.y),null!=t&&t.bezierCurveTo(l.x,l.y,u.x,u.y,h.x,h.y);break;case"Q":case"q":for(;!e.isCommandOrEnd();)s=e.current,u=e.getAsControlPoint(),h=e.getAsCurrentPoint(),e.addMarker(h,u,u),n.addQuadraticCurve(s.x,s.y,u.x,u.y,h.x,h.y),null!=t&&t.quadraticCurveTo(u.x,u.y,h.x,h.y);break;case"T":case"t":for(;!e.isCommandOrEnd();)s=e.current,u=e.getReflectedControlPoint(),e.control=u,h=e.getAsCurrentPoint(),e.addMarker(h,u,u),n.addQuadraticCurve(s.x,s.y,u.x,u.y,h.x,h.y),null!=t&&t.quadraticCurveTo(u.x,u.y,h.x,h.y);break;case"A":case"a":for(;!e.isCommandOrEnd();){s=e.current;var c=e.getScalar(),f=e.getScalar(),p=e.getScalar()*(Math.PI/180),d=e.getScalar(),y=e.getScalar(),v=(h=e.getAsCurrentPoint(),new a.Point(Math.cos(p)*(s.x-h.x)/2+Math.sin(p)*(s.y-h.y)/2,-Math.sin(p)*(s.x-h.x)/2+Math.cos(p)*(s.y-h.y)/2)),m=Math.pow(v.x,2)/Math.pow(c,2)+Math.pow(v.y,2)/Math.pow(f,2);1<m&&(c*=Math.sqrt(m),f*=Math.sqrt(m));var g=(d==y?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(f,2)-Math.pow(c,2)*Math.pow(v.y,2)-Math.pow(f,2)*Math.pow(v.x,2))/(Math.pow(c,2)*Math.pow(v.y,2)+Math.pow(f,2)*Math.pow(v.x,2)));isNaN(g)&&(g=0);var b=new a.Point(g*c*v.y/f,g*-f*v.x/c),x=new a.Point((s.x+h.x)/2+Math.cos(p)*b.x-Math.sin(p)*b.y,(s.y+h.y)/2+Math.sin(p)*b.x+Math.cos(p)*b.y),w=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2))},E=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(w(t)*w(e))},P=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(E(t,e))},S=P([1,0],[(v.x-b.x)/c,(v.y-b.y)/f]),k=[(v.x-b.x)/c,(v.y-b.y)/f],O=[(-v.x-b.x)/c,(-v.y-b.y)/f],C=P(k,O);E(k,O)<=-1&&(C=Math.PI),1<=E(k,O)&&(C=0);var M=1-y?1:-1,A=S+M*(C/2),B=new a.Point(x.x+c*Math.cos(A),x.y+f*Math.sin(A));if(e.addMarkerAngle(B,A-M*Math.PI/2),e.addMarkerAngle(h,A-M*Math.PI),n.addPoint(h.x,h.y),null!=t){E=f<c?c:f;var V=f<c?1:c/f,T=f<c?f/c:1;t.translate(x.x,x.y),t.rotate(p),t.scale(V,T),t.arc(0,0,E,S,S+C,1-y),t.scale(1/V,1/T),t.rotate(-p),t.translate(-x.x,-x.y)}}break;case"Z":case"z":null!=t&&n.x1!==n.x2&&n.y1!==n.y2&&t.closePath(),e.current=e.start}return n},this.getMarkers=function(){for(var t=this.PathParser.getMarkerPoints(),e=this.PathParser.getMarkerAngles(),n=[],r=0;r<t.length;r++)n.push([t[r],e[r]]);return n}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(t){this.base=a.Element.ElementBase,this.base(t),this.createPattern=function(t,e){var n=this.attribute("width").toPixels("x",!0),r=this.attribute("height").toPixels("y",!0),o=new a.Element.svg;o.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),o.attributes.width=new a.Property("width",n+"px"),o.attributes.height=new a.Property("height",r+"px"),o.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),o.children=this.children;var s=i();s.width=n,s.height=r;var l=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&l.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var u=-1;u<=1;u++)for(var h=-1;h<=1;h++)l.save(),o.attributes.x=new a.Property("x",u*s.width),o.attributes.y=new a.Property("y",h*s.height),o.render(l),l.restore();return t.createPattern(s,"repeat")}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(t){this.base=a.Element.ElementBase,this.base(t),this.baseRender=this.render,this.render=function(t,e,n){if(e){t.translate(e.x,e.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(n),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(t.lineWidth,t.lineWidth),t.save();var r=new a.Element.svg;r.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),r.attributes.refX=new a.Property("refX",this.attribute("refX").value),r.attributes.refY=new a.Property("refY",this.attribute("refY").value),r.attributes.width=new a.Property("width",this.attribute("markerWidth").value),r.attributes.height=new a.Property("height",this.attribute("markerHeight").value),r.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),r.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),r.children=this.children,r.render(t),t.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&t.scale(1/t.lineWidth,1/t.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&t.rotate(-n),t.translate(-e.x,-e.y)}}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(t){this.base=a.Element.ElementBase,this.base(t),this.render=function(t){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(t){this.base=a.Element.ElementBase,this.base(t),this.stops=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"stop"==n.type&&this.stops.push(n)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(t){for(var e=0;e<this.attributesToInherit.length;e++){var n=this.attributesToInherit[e];!this.attribute(n).hasValue()&&t.attribute(n).hasValue()&&(this.attribute(n,!0).value=t.attribute(n).value)}},this.createGradient=function(t,e,n){var r=this;this.getHrefAttribute().hasValue()&&(r=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(r));var o=function(t){return n.hasValue()?new a.Property("color",t).addOpacity(n).value:t},s=this.getGradient(t,e);if(null==s)return o(r.stops[r.stops.length-1].color);for(var l=0;l<r.stops.length;l++)s.addColorStop(r.stops[l].offset,o(r.stops[l].color));if(this.attribute("gradientTransform").hasValue()){var u=a.ViewPort.viewPorts[0],h=new a.Element.rect;h.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),h.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),h.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),h.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var c=new a.Element.g;c.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),c.children=[h];var f=new a.Element.svg;f.attributes.x=new a.Property("x",0),f.attributes.y=new a.Property("y",0),f.attributes.width=new a.Property("width",u.width),f.attributes.height=new a.Property("height",u.height),f.children=[c];var p=i();p.width=u.width,p.height=u.height;var d=p.getContext("2d");return d.fillStyle=s,f.render(d),d.createPattern(p,"no-repeat")}return s}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(t,e){var n="objectBoundingBox"==this.gradientUnits()?e.getBoundingBox(t):null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var r="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),i="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),o="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),a="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return r==o&&i==a?null:t.createLinearGradient(r,i,o,a)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(t){this.base=a.Element.GradientBase,this.base(t),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(t,e){var n=e.getBoundingBox(t);this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var r="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),i="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),o=r,a=i;this.attribute("fx").hasValue()&&(o="objectBoundingBox"==this.gradientUnits()?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(a="objectBoundingBox"==this.gradientUnits()?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var s="objectBoundingBox"==this.gradientUnits()?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return t.createRadialGradient(o,a,0,r,i,s)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(t){this.base=a.Element.ElementBase,this.base(t),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),1<this.offset&&(this.offset=1);var e=this.style("stop-color",!0);""===e.value&&(e.value="#000"),this.style("stop-opacity").hasValue()&&(e=e.addOpacity(this.style("stop-opacity"))),this.color=e.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(t){this.base=a.Element.ElementBase,this.base(t),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var t=this.attribute("attributeType").value,e=this.attribute("attributeName").value;return"CSS"==t?this.parent.style(e,!0):this.parent.attribute(e,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(t){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+t;var e=!1;if(this.begin<this.duration){var n=this.calcValue();this.attribute("type").hasValue()&&(n=this.attribute("type").value+"("+n+")"),this.getProperty().value=n,e=!0}return e},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var t={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var e=t.progress*(this.values.value.length-1),n=Math.floor(e),r=Math.ceil(e);t.from=new a.Property("from",parseFloat(this.values.value[n])),t.to=new a.Property("to",parseFloat(this.values.value[r])),t.progress=(e-n)/(r-n)}else t.from=this.from,t.to=this.to;return t}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){var t=this.progress();return t.from.numValue()+(t.to.numValue()-t.from.numValue())*t.progress+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),n=new t(e.from.value),r=new t(e.to.value);if(n.ok&&r.ok){var i=n.r+(r.r-n.r)*e.progress,o=n.g+(r.g-n.g)*e.progress,a=n.b+(r.b-n.b)*e.progress;return"rgb("+parseInt(i,10)+","+parseInt(o,10)+","+parseInt(a,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(t){this.base=a.Element.AnimateBase,this.base(t),this.calcValue=function(){for(var t=this.progress(),e=a.ToNumberArray(t.from.value),n=a.ToNumberArray(t.to.value),r="",i=0;i<e.length;i++)r+=e[i]+(n[i]-e[i])*t.progress+" ";return r}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(t){this.base=a.Element.ElementBase,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var e=0;e<this.children.length;e++){var n=this.children[e];"font-face"==n.type?(this.fontFace=n).style("font-family").hasValue()&&(a.Definitions[n.style("font-family").value]=this):"missing-glyph"==n.type?this.missingGlyph=n:"glyph"==n.type&&(""!=n.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[n.unicode]&&(this.glyphs[n.unicode]=[]),this.glyphs[n.unicode][n.arabicForm]=n):this.glyphs[n.unicode]=n)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(t){this.base=a.Element.ElementBase,this.base(t),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(t){this.base=a.Element.path,this.base(t),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(t){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t);var e=this.style("dominant-baseline").toTextBaseline();null==e&&(e=this.style("alignment-baseline").toTextBaseline()),null!=e&&(t.textBaseline=e)},this.initializeCoordinates=function(t){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(t,this,0)},this.getBoundingBox=function(t){this.initializeCoordinates(t);for(var e=null,n=0;n<this.children.length;n++){var r=this.getChildBoundingBox(t,this,this,n);null==e?e=r:e.addBoundingBox(r)}return e},this.renderChildren=function(t){this.initializeCoordinates(t);for(var e=0;e<this.children.length;e++)this.renderChild(t,this,this,e)},this.getAnchorDelta=function(t,e,n){var r=this.style("text-anchor").valueOrDefault("start");if("start"!=r){for(var i=0,o=n;o<e.children.length;o++){var a=e.children[o];if(n<o&&a.attribute("x").hasValue())break;i+=a.measureTextRecursive(t)}return-1*("end"==r?i:i/2)}return 0},this.adjustChildCoordinates=function(t,e,n,r){var i=n.children[r];return i.attribute("x").hasValue()?(i.x=i.attribute("x").toPixels("x")+e.getAnchorDelta(t,n,r),i.attribute("dx").hasValue()&&(i.x+=i.attribute("dx").toPixels("x"))):(i.attribute("dx").hasValue()&&(e.x+=i.attribute("dx").toPixels("x")),i.x=e.x),e.x=i.x+i.measureText(t),i.attribute("y").hasValue()?(i.y=i.attribute("y").toPixels("y"),i.attribute("dy").hasValue()&&(i.y+=i.attribute("dy").toPixels("y"))):(i.attribute("dy").hasValue()&&(e.y+=i.attribute("dy").toPixels("y")),i.y=e.y),e.y=i.y,i},this.getChildBoundingBox=function(t,e,n,r){var i=this.adjustChildCoordinates(t,e,n,r),o=i.getBoundingBox(t);for(r=0;r<i.children.length;r++){var a=e.getChildBoundingBox(t,e,i,r);o.addBoundingBox(a)}return o},this.renderChild=function(t,e,n,r){var i=this.adjustChildCoordinates(t,e,n,r);for(i.render(t),r=0;r<i.children.length;r++)e.renderChild(t,e,i,r)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getGlyph=function(t,e,n){var r=e[n],i=null;if(t.isArabic){var o="isolated";(0==n||" "==e[n-1])&&n<e.length-2&&" "!=e[n+1]&&(o="terminal"),0<n&&" "!=e[n-1]&&n<e.length-2&&" "!=e[n+1]&&(o="medial"),0<n&&" "!=e[n-1]&&(n==e.length-1||" "==e[n+1])&&(o="initial"),void 0!==t.glyphs[r]&&null==(i=t.glyphs[r][o])&&"glyph"==t.glyphs[r].type&&(i=t.glyphs[r])}else i=t.glyphs[r];return null==i&&(i=t.missingGlyph),i},this.renderChildren=function(t){var e=this.parent.style("font-family").getDefinition();if(null==e)"stroke"==t.paintOrder?(""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y)):(""!=t.fillStyle&&t.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=t.strokeStyle&&t.strokeText(a.compressSpaces(this.getText()),this.x,this.y));else{var n=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),r=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),i=this.getText();e.isRTL&&(i=i.split("").reverse().join(""));for(var o=a.ToNumberArray(this.parent.attribute("dx").value),s=0;s<i.length;s++){var l=this.getGlyph(e,i,s),u=n/e.fontFace.unitsPerEm;t.translate(this.x,this.y),t.scale(u,-u);var h=t.lineWidth;t.lineWidth=t.lineWidth*e.fontFace.unitsPerEm/n,"italic"==r&&t.transform(1,0,.4,1,0,0),l.render(t),"italic"==r&&t.transform(1,0,-.4,1,0,0),t.lineWidth=h,t.scale(1/u,-1/u),t.translate(-this.x,-this.y),this.x+=n*(l.horizAdvX||e.horizAdvX)/e.fontFace.unitsPerEm,void 0===o[s]||isNaN(o[s])||(this.x+=o[s])}}},this.getText=function(){},this.measureTextRecursive=function(t){for(var e=this.measureText(t),n=0;n<this.children.length;n++)e+=this.children[n].measureTextRecursive(t);return e},this.measureText=function(t){var e=this.parent.style("font-family").getDefinition();if(null!=e){var n=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),r=0,i=this.getText();e.isRTL&&(i=i.split("").reverse().join(""));for(var o=a.ToNumberArray(this.parent.attribute("dx").value),s=0;s<i.length;s++)r+=(this.getGlyph(e,i,s).horizAdvX||e.horizAdvX)*n/e.fontFace.unitsPerEm,void 0===o[s]||isNaN(o[s])||(r+=o[s]);return r}var l=a.compressSpaces(this.getText());if(!t.measureText)return 10*l.length;t.save(),this.setContext(t,!0);var u=t.measureText(l).width;return t.restore(),u},this.getBoundingBox=function(t){var e=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(this.x,this.y-e,this.x+this.measureText(t),this.y)}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(t){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(t),this.text=a.compressSpaces(t.value||t.text||t.textContent||""),this.getText=function(){return 0<this.children.length?"":this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(t){this.base=a.Element.TextElementBase,this.base(t),this.getText=function(){var t=this.getHrefAttribute().getDefinition();if(null!=t)return t.children[0].getText()}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(t){this.base=a.Element.TextElementBase,this.base(t),this.hasText=0<t.childNodes.length;for(var e=0;e<t.childNodes.length;e++)3!=t.childNodes[e].nodeType&&(this.hasText=!1);this.text=this.hasText?t.childNodes[0].value||t.childNodes[0].data:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(t){if(this.hasText){this.baseRenderChildren(t);var e=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-e.toPixels("y"),this.x+this.measureText(t),this.y))}else if(0<this.children.length){var n=new a.Element.g;n.children=this.children,n.parent=this,n.render(t)}},this.onclick=function(){r.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.image=function(t){this.base=a.Element.RenderedElementBase,this.base(t);var e=this.getHrefAttribute().value;if(""!=e){var n=e.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,n)this.img=a.ajax(e),this.loaded=!0;else{this.img=document.createElement("img"),1==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var r=this;this.img.onload=function(){r.loaded=!0},this.img.onerror=function(){a.log('ERROR: image "'+e+'" not found'),r.loaded=!0},this.img.src=e}this.renderChildren=function(t){var e=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");0!=o&&0!=s&&(t.save(),n?t.drawSvg(this.img,e,i,o,s):(t.translate(e,i),a.AspectRatio(t,this.attribute("preserveAspectRatio").value,o,this.img.width,s,this.img.height,0,0),r.loaded&&(void 0===this.img.complete||this.img.complete)&&t.drawImage(this.img,0,0)),t.restore())},this.getBoundingBox=function(){var t=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");return new a.BoundingBox(t,e,t+n,e+r)}}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.getBoundingBox=function(t){for(var e=new a.BoundingBox,n=0;n<this.children.length;n++)e.addBoundingBox(this.children[n].getBoundingBox(t));return e}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.render=function(t){}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(t){this.base=a.Element.ElementBase,this.base(t);for(var e="",n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].data;e=e.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");var r=(e=a.compressSpaces(e)).split("}");for(n=0;n<r.length;n++)if(""!=a.trim(r[n]))for(var i=r[n].split("{"),o=i[0].split(","),s=i[1].split(";"),l=0;l<o.length;l++){var u=a.trim(o[l]);if(""!=u){for(var h=a.Styles[u]||{},c=0;c<s.length;c++){var f=s[c].indexOf(":"),p=s[c].substr(0,f),y=s[c].substr(f+1,s[c].length-f);null!=p&&null!=y&&(h[a.trim(p)]=new a.Property(a.trim(p),a.trim(y)))}if(a.Styles[u]=h,a.StylesSpecificity[u]=d(u),"@font-face"==u)for(var v=h["font-family"].value.replace(/"/g,""),m=h.src.value.split(","),g=0;g<m.length;g++)if(0<m[g].indexOf('format("svg")'))for(var b=m[g].indexOf("url"),x=m[g].indexOf(")",b),w=m[g].substr(b+5,x-b-6),E=a.parseXml(a.ajax(w)).getElementsByTagName("font"),P=0;P<E.length;P++){var S=a.CreateElement(E[P]);a.Definitions[v]=S}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(t){this.base=a.Element.RenderedElementBase,this.base(t),this.baseSetContext=this.setContext,this.setContext=function(t){this.baseSetContext(t),this.attribute("x").hasValue()&&t.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&t.translate(0,this.attribute("y").toPixels("y"))};var e=this.getHrefAttribute().getDefinition();this.path=function(t){null!=e&&e.path(t)},this.elementTransform=function(){if(null!=e&&e.style("transform",!1,!0).hasValue())return new a.Transform(e.style("transform",!1,!0).value)},this.getBoundingBox=function(t){if(null!=e)return e.getBoundingBox(t)},this.renderChildren=function(t){if(null!=e){var n=e;"symbol"==e.type&&((n=new a.Element.svg).type="svg",n.attributes.viewBox=new a.Property("viewBox",e.attribute("viewBox").value),n.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",e.attribute("preserveAspectRatio").value),n.attributes.overflow=new a.Property("overflow",e.attribute("overflow").value),n.children=e.children),"svg"==n.type&&(this.attribute("width").hasValue()&&(n.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(n.attributes.height=new a.Property("height",this.attribute("height").value)));var r=n.parent;n.parent=null,n.render(t),n.parent=r}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=this.attribute("x").toPixels("x"),r=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y");if(0==o&&0==s){for(var l=new a.BoundingBox,u=0;u<this.children.length;u++)l.addBoundingBox(this.children[u].getBoundingBox(t));n=Math.floor(l.x1),r=Math.floor(l.y1),o=Math.floor(l.width()),s=Math.floor(l.height())}var h=e.attribute("mask").value;e.attribute("mask").value="";var c=i();c.width=n+o,c.height=r+s;var f=c.getContext("2d");this.renderChildren(f);var p=i();p.width=n+o,p.height=r+s;var d=p.getContext("2d");e.render(d),d.globalCompositeOperation="destination-in",d.fillStyle=f.createPattern(c,"no-repeat"),d.fillRect(0,0,n+o,r+s),t.fillStyle=d.createPattern(p,"no-repeat"),t.fillRect(0,0,n+o,r+s),e.attribute("mask").value=h},this.render=function(t){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t){var e="undefined"!=typeof CanvasRenderingContext2D,n=t.beginPath,r=t.closePath;e&&(CanvasRenderingContext2D.prototype.beginPath=function(){},CanvasRenderingContext2D.prototype.closePath=function(){}),n.call(t);for(var i=0;i<this.children.length;i++){var o=this.children[i];if(void 0!==o.path){var s=void 0!==o.elementTransform&&o.elementTransform();!s&&o.style("transform",!1,!0).hasValue()&&(s=new a.Transform(o.style("transform",!1,!0).value)),s&&s.apply(t),o.path(t),e&&(CanvasRenderingContext2D.prototype.closePath=r),s&&s.unapply(t)}}r.call(t),t.clip(),e&&(CanvasRenderingContext2D.prototype.beginPath=n,CanvasRenderingContext2D.prototype.closePath=r)},this.render=function(t){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e){var n=e.getBoundingBox(t),r=Math.floor(n.x1),o=Math.floor(n.y1),a=Math.floor(n.width()),s=Math.floor(n.height()),l=e.style("filter").value;e.style("filter").value="";for(var u=0,h=0,c=0;c<this.children.length;c++){var f=this.children[c].extraFilterDistance||0;u=Math.max(u,f),h=Math.max(h,f)}var p=i();p.width=a+2*u,p.height=s+2*h;var d=p.getContext("2d");for(d.translate(-r+u,-o+h),e.render(d),c=0;c<this.children.length;c++)"function"==typeof this.children[c].apply&&this.children[c].apply(d,0,0,a+2*u,s+2*h);t.drawImage(p,0,0,a+2*u,s+2*h,r-u,o-h,a+2*u,s+2*h),e.style("filter",!0).value=l},this.render=function(t){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,n,r,i){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feComposite=function(t){this.base=a.Element.ElementBase,this.base(t),this.apply=function(t,e,n,r,i){}},a.Element.feComposite.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(t){this.base=a.Element.ElementBase,this.base(t);var e=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var n=e[0];e=[.213+.787*n,.715-.715*n,.072-.072*n,0,0,.213-.213*n,.715+.285*n,.072-.072*n,0,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var r=e[0]*Math.PI/180,i=function(t,e,n){return t+Math.cos(r)*e+Math.sin(r)*n};e=[i(.213,.787,-.213),i(.715,-.715,-.715),i(.072,-.072,.928),0,0,i(.213,-.213,.143),i(.715,.285,.14),i(.072,-.072,-.283),0,0,i(.213,-.213,-.787),i(.715,-.715,.715),i(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}function o(t,e,n,r,i,o){return t[n*r*4+4*e+o]}function s(t,e,n,r,i,o,a){t[n*r*4+4*e+o]=a}function l(t,n){var r=e[t];return r*(r<0?n-255:n)}this.apply=function(t,e,n,r,i){var a=t.getImageData(0,0,r,i);for(n=0;n<i;n++)for(e=0;e<r;e++){var u=o(a.data,e,n,r,0,0),h=o(a.data,e,n,r,0,1),c=o(a.data,e,n,r,0,2),f=o(a.data,e,n,r,0,3);s(a.data,e,n,r,0,0,l(0,u)+l(1,h)+l(2,c)+l(3,f)+l(4,1)),s(a.data,e,n,r,0,1,l(5,u)+l(6,h)+l(7,c)+l(8,f)+l(9,1)),s(a.data,e,n,r,0,2,l(10,u)+l(11,h)+l(12,c)+l(13,f)+l(14,1)),s(a.data,e,n,r,0,3,l(15,u)+l(16,h)+l(17,c)+l(18,f)+l(19,1))}t.clearRect(0,0,r,i),t.putImageData(a,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(t){this.base=a.Element.ElementBase,this.base(t),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(t,n,r,i,o){e&&void 0!==e.canvasRGBA?(t.canvas.id=a.UniqueId(),t.canvas.style.display="none",document.body.appendChild(t.canvas),e.canvasRGBA(t.canvas,n,r,i,o,this.blurRadius),document.body.removeChild(t.canvas)):a.log("ERROR: StackBlur.js must be included for blur to work")}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(t){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(t){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(t){a.log("ERROR: Element '"+t.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(t){var e=t.nodeName.replace(/^[^:]+:/,"");e=e.replace(/\-/g,"");var n=null;return(n=void 0!==a.Element[e]?new a.Element[e](t):new a.Element.MISSING(t)).type=t.nodeName,n},a.load=function(t,e){a.loadXml(t,a.ajax(e))},a.loadXml=function(t,e){a.loadXmlDoc(t,a.parseXml(e))},a.loadXmlDoc=function(t,e){a.init(t);var n=function(e){for(var n=t.canvas;n;)e.x-=n.offsetLeft,e.y-=n.offsetTop,n=n.offsetParent;return r.scrollX&&(e.x+=r.scrollX),r.scrollY&&(e.y+=r.scrollY),e};1!=a.opts.ignoreMouse&&(t.canvas.onclick=function(t){var e=n(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onclick(e.x,e.y)},t.canvas.onmousemove=function(t){var e=n(new a.Point(null!=t?t.clientX:event.clientX,null!=t?t.clientY:event.clientY));a.Mouse.onmousemove(e.x,e.y)});var i=a.CreateElement(e.documentElement);i.root=!0,i.addStylesFromStyleDefinition();var o=!0,s=function(){a.ViewPort.Clear(),t.canvas.parentNode?a.ViewPort.SetCurrent(t.canvas.parentNode.clientWidth,t.canvas.parentNode.clientHeight):a.ViewPort.SetCurrent(800,600),1!=a.opts.ignoreDimensions&&(i.style("width").hasValue()&&(t.canvas.width=i.style("width").toPixels("x"),t.canvas.style&&(t.canvas.style.width=t.canvas.width+"px")),i.style("height").hasValue()&&(t.canvas.height=i.style("height").toPixels("y"),t.canvas.style&&(t.canvas.style.height=t.canvas.height+"px")));var n=t.canvas.clientWidth||t.canvas.width,r=t.canvas.clientHeight||t.canvas.height;if(1==a.opts.ignoreDimensions&&i.style("width").hasValue()&&i.style("height").hasValue()&&(n=i.style("width").toPixels("x"),r=i.style("height").toPixels("y")),a.ViewPort.SetCurrent(n,r),null!=a.opts.offsetX&&(i.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(i.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var s=null,l=null,u=a.ToNumberArray(i.attribute("viewBox").value);null!=a.opts.scaleWidth&&(i.attribute("width").hasValue()?s=i.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(u[2])||(s=u[2]/a.opts.scaleWidth)),null!=a.opts.scaleHeight&&(i.attribute("height").hasValue()?l=i.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(u[3])||(l=u[3]/a.opts.scaleHeight)),null==s&&(s=l),null==l&&(l=s),i.attribute("width",!0).value=a.opts.scaleWidth,i.attribute("height",!0).value=a.opts.scaleHeight,i.style("transform",!0,!0).value+=" scale("+1/s+","+1/l+")"}1!=a.opts.ignoreClear&&t.clearRect(0,0,n,r),i.render(t),o&&(o=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(e))},l=!0;a.ImagesLoaded()&&(l=!1,s()),a.intervalID=setInterval((function(){var t=!1;if(l&&a.ImagesLoaded()&&(t=!(l=!1)),1!=a.opts.ignoreMouse&&(t|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var e=0;e<a.Animations.length;e++)t|=a.Animations[e].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(t=!0),t&&(s(),a.Mouse.runEvents())}),1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(t,e){this.events.push({type:"onclick",x:t,y:e,run:function(t){t.onclick&&t.onclick()}})},this.onmousemove=function(t,e){this.events.push({type:"onmousemove",x:t,y:e,run:function(t){t.onmousemove&&t.onmousemove()}})},this.eventElements=[],this.checkPath=function(t,e){for(var n=0;n<this.events.length;n++){var r=this.events[n];e.isPointInPath&&e.isPointInPath(r.x,r.y)&&(this.eventElements[n]=t)}},this.checkBoundingBox=function(t,e){for(var n=0;n<this.events.length;n++){var r=this.events[n];e.isPointInBox(r.x,r.y)&&(this.eventElements[n]=t)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var t=0;t<this.events.length;t++)for(var e=this.events[t],n=this.eventElements[t];n;)e.run(n),n=n.parent;this.events=[],this.eventElements=[]}},a}(l||{});"string"==typeof n&&(n=document.getElementById(n)),null!=n.svg&&n.svg.stop(),n.childNodes&&1==n.childNodes.length&&"OBJECT"==n.childNodes[0].nodeName||(n.svg=u);var h=n.getContext("2d");void 0!==s.documentElement?u.loadXmlDoc(h,s):"<"==s.substr(0,1)?u.loadXml(h,s):u.load(h,s)}else for(var c=document.querySelectorAll("svg"),f=0;f<c.length;f++){var p=c[f],y=document.createElement("canvas");y.width=p.clientWidth,y.height=p.clientHeight,p.parentNode.insertBefore(y,p),p.parentNode.removeChild(p);var v=document.createElement("div");v.appendChild(p),a(y,v.innerHTML)}};"undefined"==typeof Element||(void 0!==Element.prototype.matches?o=function(t,e){return t.matches(e)}:void 0!==Element.prototype.webkitMatchesSelector?o=function(t,e){return t.webkitMatchesSelector(e)}:void 0!==Element.prototype.mozMatchesSelector?o=function(t,e){return t.mozMatchesSelector(e)}:void 0!==Element.prototype.msMatchesSelector?o=function(t,e){return t.msMatchesSelector(e)}:void 0!==Element.prototype.oMatchesSelector?o=function(t,e){return t.oMatchesSelector(e)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(o=function(t,e){return $(t).is(e)}),void 0===o&&"undefined"!=typeof Sizzle&&(o=Sizzle.matchesSelector)));var s=/(\[[^\]]+\])/g,l=/(#[^\s\+>~\.\[:]+)/g,u=/(\.[^\s\+>~\.\[:]+)/g,h=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,c=/(:[\w-]+\([^\)]*\))/gi,f=/(:[^\s\+>~\.\[:]+)/g,p=/([^\s\+>~\.\[:]+)/g;function d(t){var e=[0,0,0],n=function(n,r){var i=t.match(n);null!=i&&(e[r]+=i.length,t=t.replace(n," "))};return t=(t=t.replace(/:not\(([^\)]*)\)/g,"     $1 ")).replace(/{[\s\S]*/gm," "),n(s,1),n(l,0),n(u,1),n(h,2),n(c,1),n(f,1),t=(t=t.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," "),n(p,2),e.join("")}"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(t,e,n,r,i,o){var s={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:e,offsetY:n,scaleWidth:r,scaleHeight:i};for(var l in o)o.hasOwnProperty(l)&&(s[l]=o[l]);a(this.canvas,t,s)}),n.exports=a}(n={exports:{}}),n.exports}(n(3),n(4))},function(t,e,n){var r;window,t.exports=(r=n(0),function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=r},function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return i}));var r=n(0);function i(){var t,e,n,i,o,a,s,l,u,h=[];function c(t){return t.eachAfter(f),t.eachBefore(p),t.eachBefore(d),t}function f(i){var c=u(i).width,f=u(i).height;if(t(i)){if(c=f=0,i.children){for(var p=function(t){var r=[],i=0,o=!1,s=0,u=!0;return t.children.forEach((function(h,c){e(h)&&!o&&(o=!0),i+=h.x1-h.x0,i+=u?n(h)?a(h).left:0:Math.max(a(h).left,a(t.children[c-1]).right);var f=n(h)?a(h).right:0;(i+f>l(t)||c===t.children.length-1)&&(i+=f),i>l(t)||c===t.children.length-1?(r.push({from:s,to:c,width:i,flexHeight:o}),c<t.children.length-1&&(s=c+1,i=0,o=!1,u=!0)):u=!1})),r}(i),d=0;d<p.length;d++)p[d].height=y(i,p,d);h.push({box:i,lines:p}),c+=r.max(p,(function(t){return t.width})),f+=r.sum(p,(function(t){return t.height}))}c+=o(i).left+o(i).right,f+=o(i).top+o(i).bottom,c=Math.max(c,s(i).width),f=Math.max(f,s(i).height)}i.x0=i.y0=0,i.x1=c,i.y1=f}function p(r){var i=r.y1;if(r.parent&&e(r)){i=g(r).height;var o=v(r.parent),s=m(r,o);i-=n(r)||0!==s?a(r).top:0;var l=(i-=n(r)||s!==o.length-1?a(r).bottom:0)-r.y1;if(t(r)&&r.children&&l>0){var u=v(r),h=l/u.length,c=!0,f=!1,p=void 0;try{for(var d,y=u[Symbol.iterator]();!(c=(d=y.next()).done);c=!0)d.value.height+=h}catch(t){f=!0,p=t}finally{try{c||null==y.return||y.return()}finally{if(f)throw p}}}}r.y1=i}function d(t){var e=t.x1-t.x0,r=t.y1-t.y0;if(t.parent){t.y0=t.parent.y0+o(t.parent).top;var s=t.parent.children.indexOf(t);if(0===s||function(t){if(t.parent){var e=t.parent.children.indexOf(t),n=v(t.parent);return n[m(t,n)].from===e}return null}(t))t.x0+=t.parent.x0+o(t.parent).left,n(t)&&(t.x0+=a(t).left);else{var l=t.parent.children[s-1];t.x0=l.x1,t.x0+=Math.max(a(l).right,a(t).left)}}else switch(i){case"top":t.y0=0;break;case"middle":t.y0=r/2;break;case"bottom":t.y0=r}switch(i){case"top":if(t.parent){var u=m(t);t.y0+=n(t)||0!==u?a(t).top:0,t.y0+=b(t)}break;case"middle":t.parent&&(t.y0+=b(t)+g(t).height/2),t.y0-=r/2;break;case"bottom":if(t.parent){var h=v(t.parent),c=m(t,h);t.y0-=n(t)||c!==h.length-1?a(t).bottom:0,t.y0+=b(t,!0)}t.y0-=r}t.x1=t.x0+e,t.y1=t.y0+r}function y(t,e,r){for(var i=e[r],o=0,l=i.from;l<=i.to;l++){var u=t.children[l],h=u.y1-u.y0,c=(n(u)||0!==r?a(u).top:0)+(n(u)||r!==e.length-1?a(u).bottom:0);h+c>o&&(o=h+c)}return Math.max(o,s(t).height)}function v(t){return h[h.findIndex((function(e){return e.box===t}))].lines}function m(t,e){if(t.parent){var n=arguments.length>1?e:v(t.parent),r=t.parent.children.indexOf(t);return n.findIndex((function(t){return r>=t.from&&r<=t.to}))}return null}function g(t){var e=v(t.parent);return e[m(t,e)]}function b(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t.parent){var n=v(t.parent),i=m(t,n),o=e?i:i-1;return r.sum(n.filter((function(t,e){return e<=o})),(function(t){return t.height}))}return null}function x(t){return function(){return t}}return c.vAlign=function(t){return arguments.length?(i=t,c):i},c.edgeMargins=function(t){return arguments.length?(n="function"==typeof t?t:x(+t),c):n},c.isContainer=function(e){return arguments.length?(t="function"==typeof e?e:x(+e),c):t},c.spanHeight=function(t){return arguments.length?(e="function"==typeof t?t:x(+t),c):e},c.padding=function(t){return arguments.length?(o="function"==typeof t?t:x(+t),c):o},c.margin=function(t){return arguments.length?(a="function"==typeof t?t:x(+t),c):a},c.nodeSize=function(t){return arguments.length?(u="function"==typeof t?t:x(+t),c):u},c.minContainerSize=function(t){return arguments.length?(s="function"==typeof t?t:x(+t),c):s},c.maxLineWidth=function(t){return arguments.length?(l="function"==typeof t?t:x(+t),c):l},c}}]).default)},function(t,e){t.exports=function(t){this.ok=!1,this.alpha=1,"#"==t.charAt(0)&&(t=t.substr(1,6)),t=(t=t.replace(/ /g,"")).toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};t=e[t]||t;for(var n=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseFloat(t[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}],r=0;r<n.length;r++){var i=n[r].re,o=n[r].process,a=i.exec(t);if(a){var s=o(a);this.r=s[0],this.g=s[1],this.b=s[2],s.length>3&&(this.alpha=s[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),n=this.b.toString(16);return 1==t.length&&(t="0"+t),1==e.length&&(e="0"+e),1==n.length&&(n="0"+n),"#"+t+e+n},this.getHelpXML=function(){for(var t=new Array,r=0;r<n.length;r++)for(var i=n[r].example,o=0;o<i.length;o++)t[t.length]=i[o];for(var a in e)t[t.length]=a;var s=document.createElement("ul");s.setAttribute("id","rgbcolor-examples");for(r=0;r<t.length;r++)try{var l=document.createElement("li"),u=new RGBColor(t[r]),h=document.createElement("div");h.style.cssText="margin: 3px; border: 1px solid black; background:"+u.toHex()+"; color:"+u.toHex(),h.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+t[r]+" -> "+u.toRGB()+" -> "+u.toHex());l.appendChild(h),l.appendChild(c),s.appendChild(l)}catch(t){}return s}}},function(t,e){var n=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],r=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(t,e,n,r,i){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLCanvasElement&&!t instanceof HTMLCanvasElement)return;var o,a=t.getContext("2d");try{try{o=a.getImageData(e,n,r,i)}catch(t){throw new Error("unable to access local image data: "+t)}}catch(t){throw new Error("unable to access image data: "+t)}return o}function o(t,e,n,r,o,s){if(!(isNaN(s)||s<1)){s|=0;var l=i(t,e,n,r,o);l=a(l,e,n,r,o,s),t.getContext("2d").putImageData(l,e,n)}}function a(t,e,i,o,a,s){var l,h,c,f,p,d,y,v,m,g,b,x,w,E,P,S,k,O,C,M,A,B,V,T,N=t.data,D=s+s+1,j=o-1,R=a-1,I=s+1,z=I*(I+1)/2,L=new u,F=L;for(c=1;c<D;c++)if(F=F.next=new u,c==I)var q=F;F.next=L;var _=null,X=null;y=d=0;var U=n[s],$=r[s];for(h=0;h<a;h++){for(S=k=O=C=v=m=g=b=0,x=I*(M=N[d]),w=I*(A=N[d+1]),E=I*(B=N[d+2]),P=I*(V=N[d+3]),v+=z*M,m+=z*A,g+=z*B,b+=z*V,F=L,c=0;c<I;c++)F.r=M,F.g=A,F.b=B,F.a=V,F=F.next;for(c=1;c<I;c++)f=d+((j<c?j:c)<<2),v+=(F.r=M=N[f])*(T=I-c),m+=(F.g=A=N[f+1])*T,g+=(F.b=B=N[f+2])*T,b+=(F.a=V=N[f+3])*T,S+=M,k+=A,O+=B,C+=V,F=F.next;for(_=L,X=q,l=0;l<o;l++)N[d+3]=V=b*U>>$,0!=V?(V=255/V,N[d]=(v*U>>$)*V,N[d+1]=(m*U>>$)*V,N[d+2]=(g*U>>$)*V):N[d]=N[d+1]=N[d+2]=0,v-=x,m-=w,g-=E,b-=P,x-=_.r,w-=_.g,E-=_.b,P-=_.a,f=y+((f=l+s+1)<j?f:j)<<2,v+=S+=_.r=N[f],m+=k+=_.g=N[f+1],g+=O+=_.b=N[f+2],b+=C+=_.a=N[f+3],_=_.next,x+=M=X.r,w+=A=X.g,E+=B=X.b,P+=V=X.a,S-=M,k-=A,O-=B,C-=V,X=X.next,d+=4;y+=o}for(l=0;l<o;l++){for(k=O=C=S=m=g=b=v=0,x=I*(M=N[d=l<<2]),w=I*(A=N[d+1]),E=I*(B=N[d+2]),P=I*(V=N[d+3]),v+=z*M,m+=z*A,g+=z*B,b+=z*V,F=L,c=0;c<I;c++)F.r=M,F.g=A,F.b=B,F.a=V,F=F.next;for(p=o,c=1;c<=s;c++)d=p+l<<2,v+=(F.r=M=N[d])*(T=I-c),m+=(F.g=A=N[d+1])*T,g+=(F.b=B=N[d+2])*T,b+=(F.a=V=N[d+3])*T,S+=M,k+=A,O+=B,C+=V,F=F.next,c<R&&(p+=o);for(d=l,_=L,X=q,h=0;h<a;h++)N[(f=d<<2)+3]=V=b*U>>$,V>0?(V=255/V,N[f]=(v*U>>$)*V,N[f+1]=(m*U>>$)*V,N[f+2]=(g*U>>$)*V):N[f]=N[f+1]=N[f+2]=0,v-=x,m-=w,g-=E,b-=P,x-=_.r,w-=_.g,E-=_.b,P-=_.a,f=l+((f=h+I)<R?f:R)*o<<2,v+=S+=_.r=N[f],m+=k+=_.g=N[f+1],g+=O+=_.b=N[f+2],b+=C+=_.a=N[f+3],_=_.next,x+=M=X.r,w+=A=X.g,E+=B=X.b,P+=V=X.a,S-=M,k-=A,O-=B,C-=V,X=X.next,d+=o}return t}function s(t,e,n,r,o,a){if(!(isNaN(a)||a<1)){a|=0;var s=i(t,e,n,r,o);s=l(s,e,n,r,o,a),t.getContext("2d").putImageData(s,e,n)}}function l(t,e,i,o,a,s){var l,h,c,f,p,d,y,v,m,g,b,x,w,E,P,S,k,O,C,M,A=t.data,B=s+s+1,V=o-1,T=a-1,N=s+1,D=N*(N+1)/2,j=new u,R=j;for(c=1;c<B;c++)if(R=R.next=new u,c==N)var I=R;R.next=j;var z=null,L=null;y=d=0;var F=n[s],q=r[s];for(h=0;h<a;h++){for(E=P=S=v=m=g=0,b=N*(k=A[d]),x=N*(O=A[d+1]),w=N*(C=A[d+2]),v+=D*k,m+=D*O,g+=D*C,R=j,c=0;c<N;c++)R.r=k,R.g=O,R.b=C,R=R.next;for(c=1;c<N;c++)f=d+((V<c?V:c)<<2),v+=(R.r=k=A[f])*(M=N-c),m+=(R.g=O=A[f+1])*M,g+=(R.b=C=A[f+2])*M,E+=k,P+=O,S+=C,R=R.next;for(z=j,L=I,l=0;l<o;l++)A[d]=v*F>>q,A[d+1]=m*F>>q,A[d+2]=g*F>>q,v-=b,m-=x,g-=w,b-=z.r,x-=z.g,w-=z.b,f=y+((f=l+s+1)<V?f:V)<<2,v+=E+=z.r=A[f],m+=P+=z.g=A[f+1],g+=S+=z.b=A[f+2],z=z.next,b+=k=L.r,x+=O=L.g,w+=C=L.b,E-=k,P-=O,S-=C,L=L.next,d+=4;y+=o}for(l=0;l<o;l++){for(P=S=E=m=g=v=0,b=N*(k=A[d=l<<2]),x=N*(O=A[d+1]),w=N*(C=A[d+2]),v+=D*k,m+=D*O,g+=D*C,R=j,c=0;c<N;c++)R.r=k,R.g=O,R.b=C,R=R.next;for(p=o,c=1;c<=s;c++)d=p+l<<2,v+=(R.r=k=A[d])*(M=N-c),m+=(R.g=O=A[d+1])*M,g+=(R.b=C=A[d+2])*M,E+=k,P+=O,S+=C,R=R.next,c<T&&(p+=o);for(d=l,z=j,L=I,h=0;h<a;h++)A[f=d<<2]=v*F>>q,A[f+1]=m*F>>q,A[f+2]=g*F>>q,v-=b,m-=x,g-=w,b-=z.r,x-=z.g,w-=z.b,f=l+((f=h+N)<T?f:T)*o<<2,v+=E+=z.r=A[f],m+=P+=z.g=A[f+1],g+=S+=z.b=A[f+2],z=z.next,b+=k=L.r,x+=O=L.g,w+=C=L.b,E-=k,P-=O,S-=C,L=L.next,d+=o}return t}function u(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}t.exports={image:function(t,e,n,r){if("string"==typeof t)t=document.getElementById(t);else if("undefined"!=typeof HTMLImageElement&&!t instanceof HTMLImageElement)return;var i=t.naturalWidth,a=t.naturalHeight;if("string"==typeof e)e=document.getElementById(e);else if("undefined"!=typeof HTMLCanvasElement&&!e instanceof HTMLCanvasElement)return;e.style.width=i+"px",e.style.height=a+"px",e.width=i,e.height=a;var l=e.getContext("2d");l.clearRect(0,0,i,a),l.drawImage(t,0,0),isNaN(n)||n<1||(r?o(e,0,0,i,a,n):s(e,0,0,i,a,n))},canvasRGBA:o,canvasRGB:s,imageDataRGBA:a,imageDataRGB:l}},function(t,e,n){(function(t){var r,i=function(t){"use strict";var e=1e7,n=9007199254740992,r=c(n),o="function"==typeof BigInt;function a(t,e,n,r){return void 0===t?a[0]:void 0!==e&&(10!=+e||n)?F(t,e,n,r):$(t)}function s(t,e){this.value=t,this.sign=e,this.isSmall=!1}function l(t){this.value=t,this.sign=t<0,this.isSmall=!0}function u(t){this.value=t}function h(t){return-n<t&&t<n}function c(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function f(t){p(t);var n=t.length;if(n<4&&M(t,r)<0)switch(n){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function p(t){for(var e=t.length;0===t[--e];);t.length=e+1}function d(t){for(var e=new Array(t),n=-1;++n<t;)e[n]=0;return e}function y(t){return t>0?Math.floor(t):Math.ceil(t)}function v(t,n){var r,i,o=t.length,a=n.length,s=new Array(o),l=0,u=e;for(i=0;i<a;i++)l=(r=t[i]+n[i]+l)>=u?1:0,s[i]=r-l*u;for(;i<o;)l=(r=t[i]+l)===u?1:0,s[i++]=r-l*u;return l>0&&s.push(l),s}function m(t,e){return t.length>=e.length?v(t,e):v(e,t)}function g(t,n){var r,i,o=t.length,a=new Array(o),s=e;for(i=0;i<o;i++)r=t[i]-s+n,n=Math.floor(r/s),a[i]=r-n*s,n+=1;for(;n>0;)a[i++]=n%s,n=Math.floor(n/s);return a}function b(t,e){var n,r,i=t.length,o=e.length,a=new Array(i),s=0;for(n=0;n<o;n++)(r=t[n]-s-e[n])<0?(r+=1e7,s=1):s=0,a[n]=r;for(n=o;n<i;n++){if(!((r=t[n]-s)<0)){a[n++]=r;break}r+=1e7,a[n]=r}for(;n<i;n++)a[n]=t[n];return p(a),a}function x(t,e,n){var r,i,o=t.length,a=new Array(o),u=-e;for(r=0;r<o;r++)i=t[r]+u,u=Math.floor(i/1e7),i%=1e7,a[r]=i<0?i+1e7:i;return"number"==typeof(a=f(a))?(n&&(a=-a),new l(a)):new s(a,n)}function w(t,e){var n,r,i,o,a=t.length,s=e.length,l=d(a+s);for(i=0;i<a;++i){o=t[i];for(var u=0;u<s;++u)n=o*e[u]+l[i+u],r=Math.floor(n/1e7),l[i+u]=n-1e7*r,l[i+u+1]+=r}return p(l),l}function E(t,n){var r,i,o=t.length,a=new Array(o),s=e,l=0;for(i=0;i<o;i++)r=t[i]*n+l,l=Math.floor(r/s),a[i]=r-l*s;for(;l>0;)a[i++]=l%s,l=Math.floor(l/s);return a}function P(t,e){for(var n=[];e-- >0;)n.push(0);return n.concat(t)}function S(t,n,r){return new s(t<e?E(n,t):w(n,c(t)),r)}function k(t){var e,n,r,i,o=t.length,a=d(o+o);for(r=0;r<o;r++){n=0-(i=t[r])*i;for(var s=r;s<o;s++)e=i*t[s]*2+a[r+s]+n,n=Math.floor(e/1e7),a[r+s]=e-1e7*n;a[r+o]=n}return p(a),a}function O(t,e){var n,r,i,o,a=t.length,s=d(a);for(i=0,n=a-1;n>=0;--n)i=(o=1e7*i+t[n])-(r=y(o/e))*e,s[n]=0|r;return[s,0|i]}function C(t,n){var r,i=$(n);if(o)return[new u(t.value/i.value),new u(t.value%i.value)];var h,v=t.value,m=i.value;if(0===m)throw new Error("Cannot divide by zero");if(t.isSmall)return i.isSmall?[new l(y(v/m)),new l(v%m)]:[a[0],t];if(i.isSmall){if(1===m)return[t,a[0]];if(-1==m)return[t.negate(),a[0]];var g=Math.abs(m);if(g<e){h=f((r=O(v,g))[0]);var x=r[1];return t.sign&&(x=-x),"number"==typeof h?(t.sign!==i.sign&&(h=-h),[new l(h),new l(x)]):[new s(h,t.sign!==i.sign),new l(x)]}m=c(g)}var w=M(v,m);if(-1===w)return[a[0],t];if(0===w)return[a[t.sign===i.sign?1:-1],a[0]];h=(r=v.length+m.length<=200?function(t,n){var r,i,o,a,s,l,u,h=t.length,c=n.length,p=e,y=d(n.length),v=n[c-1],m=Math.ceil(p/(2*v)),g=E(t,m),b=E(n,m);for(g.length<=h&&g.push(0),b.push(0),v=b[c-1],i=h-c;i>=0;i--){for(r=p-1,g[i+c]!==v&&(r=Math.floor((g[i+c]*p+g[i+c-1])/v)),o=0,a=0,l=b.length,s=0;s<l;s++)o+=r*b[s],u=Math.floor(o/p),a+=g[i+s]-(o-u*p),o=u,a<0?(g[i+s]=a+p,a=-1):(g[i+s]=a,a=0);for(;0!==a;){for(r-=1,o=0,s=0;s<l;s++)(o+=g[i+s]-p+b[s])<0?(g[i+s]=o+p,o=0):(g[i+s]=o,o=1);a+=o}y[i]=r}return g=O(g,m)[0],[f(y),f(g)]}(v,m):function(t,e){for(var n,r,i,o,a,s=t.length,l=e.length,u=[],h=[];s;)if(h.unshift(t[--s]),p(h),M(h,e)<0)u.push(0);else{i=1e7*h[(r=h.length)-1]+h[r-2],o=1e7*e[l-1]+e[l-2],r>l&&(i=1e7*(i+1)),n=Math.ceil(i/o);do{if(M(a=E(e,n),h)<=0)break;n--}while(n);u.push(n),h=b(h,a)}return u.reverse(),[f(u),f(h)]}(v,m))[0];var P=t.sign!==i.sign,S=r[1],k=t.sign;return"number"==typeof h?(P&&(h=-h),h=new l(h)):h=new s(h,P),"number"==typeof S?(k&&(S=-S),S=new l(S)):S=new s(S,k),[h,S]}function M(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n])return t[n]>e[n]?1:-1;return 0}function A(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function B(t,e){for(var n,r,o,a=t.prev(),s=a,l=0;s.isEven();)s=s.divide(2),l++;t:for(r=0;r<e.length;r++)if(!t.lesser(e[r])&&!(o=i(e[r]).modPow(s,t)).isUnit()&&!o.equals(a)){for(n=l-1;0!=n;n--){if((o=o.square().mod(t)).isUnit())return!1;if(o.equals(a))continue t}return!1}return!0}s.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),u.prototype=Object.create(a.prototype),s.prototype.add=function(t){var e=$(t);if(this.sign!==e.sign)return this.subtract(e.negate());var n=this.value,r=e.value;return e.isSmall?new s(g(n,Math.abs(r)),this.sign):new s(m(n,r),this.sign)},s.prototype.plus=s.prototype.add,l.prototype.add=function(t){var e=$(t),n=this.value;if(n<0!==e.sign)return this.subtract(e.negate());var r=e.value;if(e.isSmall){if(h(n+r))return new l(n+r);r=c(Math.abs(r))}return new s(g(r,Math.abs(n)),n<0)},l.prototype.plus=l.prototype.add,u.prototype.add=function(t){return new u(this.value+$(t).value)},u.prototype.plus=u.prototype.add,s.prototype.subtract=function(t){var e=$(t);if(this.sign!==e.sign)return this.add(e.negate());var n=this.value,r=e.value;return e.isSmall?x(n,Math.abs(r),this.sign):function(t,e,n){var r;return M(t,e)>=0?r=b(t,e):(r=b(e,t),n=!n),"number"==typeof(r=f(r))?(n&&(r=-r),new l(r)):new s(r,n)}(n,r,this.sign)},s.prototype.minus=s.prototype.subtract,l.prototype.subtract=function(t){var e=$(t),n=this.value;if(n<0!==e.sign)return this.add(e.negate());var r=e.value;return e.isSmall?new l(n-r):x(r,Math.abs(n),n>=0)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(t){return new u(this.value-$(t).value)},u.prototype.minus=u.prototype.subtract,s.prototype.negate=function(){return new s(this.value,!this.sign)},l.prototype.negate=function(){var t=this.sign,e=new l(-this.value);return e.sign=!t,e},u.prototype.negate=function(){return new u(-this.value)},s.prototype.abs=function(){return new s(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)},s.prototype.multiply=function(t){var n,r,i,o=$(t),l=this.value,u=o.value,h=this.sign!==o.sign;if(o.isSmall){if(0===u)return a[0];if(1===u)return this;if(-1===u)return this.negate();if((n=Math.abs(u))<e)return new s(E(l,n),h);u=c(n)}return r=l.length,i=u.length,new s(-.012*r-.012*i+15e-6*r*i>0?function t(e,n){var r=Math.max(e.length,n.length);if(r<=30)return w(e,n);r=Math.ceil(r/2);var i=e.slice(r),o=e.slice(0,r),a=n.slice(r),s=n.slice(0,r),l=t(o,s),u=t(i,a),h=t(m(o,i),m(s,a)),c=m(m(l,P(b(b(h,l),u),r)),P(u,2*r));return p(c),c}(l,u):w(l,u),h)},s.prototype.times=s.prototype.multiply,l.prototype._multiplyBySmall=function(t){return h(t.value*this.value)?new l(t.value*this.value):S(Math.abs(t.value),c(Math.abs(this.value)),this.sign!==t.sign)},s.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():S(Math.abs(t.value),this.value,this.sign!==t.sign)},l.prototype.multiply=function(t){return $(t)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,u.prototype.multiply=function(t){return new u(this.value*$(t).value)},u.prototype.times=u.prototype.multiply,s.prototype.square=function(){return new s(k(this.value),!1)},l.prototype.square=function(){var t=this.value*this.value;return h(t)?new l(t):new s(k(c(Math.abs(this.value))),!1)},u.prototype.square=function(t){return new u(this.value*this.value)},s.prototype.divmod=function(t){var e=C(this,t);return{quotient:e[0],remainder:e[1]}},u.prototype.divmod=l.prototype.divmod=s.prototype.divmod,s.prototype.divide=function(t){return C(this,t)[0]},u.prototype.over=u.prototype.divide=function(t){return new u(this.value/$(t).value)},l.prototype.over=l.prototype.divide=s.prototype.over=s.prototype.divide,s.prototype.mod=function(t){return C(this,t)[1]},u.prototype.mod=u.prototype.remainder=function(t){return new u(this.value%$(t).value)},l.prototype.remainder=l.prototype.mod=s.prototype.remainder=s.prototype.mod,s.prototype.pow=function(t){var e,n,r,i=$(t),o=this.value,s=i.value;if(0===s)return a[1];if(0===o)return a[0];if(1===o)return a[1];if(-1===o)return i.isEven()?a[1]:a[-1];if(i.sign)return a[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&h(e=Math.pow(o,s)))return new l(y(e));for(n=this,r=a[1];!0&s&&(r=r.times(n),--s),0!==s;)s/=2,n=n.square();return r},l.prototype.pow=s.prototype.pow,u.prototype.pow=function(t){var e=$(t),n=this.value,r=e.value,i=BigInt(0),o=BigInt(1),s=BigInt(2);if(r===i)return a[1];if(n===i)return a[0];if(n===o)return a[1];if(n===BigInt(-1))return e.isEven()?a[1]:a[-1];if(e.isNegative())return new u(i);for(var l=this,h=a[1];(r&o)===o&&(h=h.times(l),--r),r!==i;)r/=s,l=l.square();return h},s.prototype.modPow=function(t,e){if(t=$(t),(e=$(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var n=a[1],r=this.mod(e);for(t.isNegative()&&(t=t.multiply(a[-1]),r=r.modInv(e));t.isPositive();){if(r.isZero())return a[0];t.isOdd()&&(n=n.multiply(r).mod(e)),t=t.divide(2),r=r.square().mod(e)}return n},u.prototype.modPow=l.prototype.modPow=s.prototype.modPow,s.prototype.compareAbs=function(t){var e=$(t),n=this.value,r=e.value;return e.isSmall?1:M(n,r)},l.prototype.compareAbs=function(t){var e=$(t),n=Math.abs(this.value),r=e.value;return e.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},u.prototype.compareAbs=function(t){var e=this.value,n=$(t).value;return(e=e>=0?e:-e)===(n=n>=0?n:-n)?0:e>n?1:-1},s.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=$(t),n=this.value,r=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:M(n,r)*(this.sign?-1:1)},s.prototype.compareTo=s.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=$(t),n=this.value,r=e.value;return e.isSmall?n==r?0:n>r?1:-1:n<0!==e.sign?n<0?-1:1:n<0?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,n=$(t).value;return e===n?0:e>n?1:-1},u.prototype.compareTo=u.prototype.compare,s.prototype.equals=function(t){return 0===this.compare(t)},u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals=s.prototype.eq=s.prototype.equals,s.prototype.notEquals=function(t){return 0!==this.compare(t)},u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=s.prototype.neq=s.prototype.notEquals,s.prototype.greater=function(t){return this.compare(t)>0},u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater=s.prototype.gt=s.prototype.greater,s.prototype.lesser=function(t){return this.compare(t)<0},u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser=s.prototype.lt=s.prototype.lesser,s.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=s.prototype.geq=s.prototype.greaterOrEquals,s.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=s.prototype.leq=s.prototype.lesserOrEquals,s.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},s.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},s.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=l.prototype.isPositive,s.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=l.prototype.isNegative,s.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},s.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},u.prototype.isZero=function(){return this.value===BigInt(0)},s.prototype.isDivisibleBy=function(t){var e=$(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},u.prototype.isDivisibleBy=l.prototype.isDivisibleBy=s.prototype.isDivisibleBy,s.prototype.isPrime=function(t){var e=A(this);if(void 0!==e)return e;var n=this.abs(),r=n.bitLength();if(r<=64)return B(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*r.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(o,2):o),s=[],l=0;l<a;l++)s.push(i(l+2));return B(n,s)},u.prototype.isPrime=l.prototype.isPrime=s.prototype.isPrime,s.prototype.isProbablePrime=function(t,e){var n=A(this);if(void 0!==n)return n;for(var r=this.abs(),o=void 0===t?5:t,a=[],s=0;s<o;s++)a.push(i.randBetween(2,r.minus(2),e));return B(r,a)},u.prototype.isProbablePrime=l.prototype.isProbablePrime=s.prototype.isProbablePrime,s.prototype.modInv=function(t){for(var e,n,r,o=i.zero,a=i.one,s=$(t),l=this.abs();!l.isZero();)e=s.divide(l),n=o,r=s,o=a,s=l,a=n.subtract(e.multiply(a)),l=r.subtract(e.multiply(l));if(!s.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===o.compare(0)&&(o=o.add(t)),this.isNegative()?o.negate():o},u.prototype.modInv=l.prototype.modInv=s.prototype.modInv,s.prototype.next=function(){var t=this.value;return this.sign?x(t,1,this.sign):new s(g(t,1),this.sign)},l.prototype.next=function(){var t=this.value;return t+1<n?new l(t+1):new s(r,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},s.prototype.prev=function(){var t=this.value;return this.sign?new s(g(t,1),!0):x(t,1,this.sign)},l.prototype.prev=function(){var t=this.value;return t-1>-n?new l(t-1):new s(r,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var V=[1];2*V[V.length-1]<=e;)V.push(2*V[V.length-1]);var T=V.length,N=V[T-1];function D(t){return Math.abs(t)<=e}function j(t,e,n){e=$(e);for(var r=t.isNegative(),o=e.isNegative(),a=r?t.not():t,s=o?e.not():e,l=0,u=0,h=null,c=null,f=[];!a.isZero()||!s.isZero();)l=(h=C(a,N))[1].toJSNumber(),r&&(l=N-1-l),u=(c=C(s,N))[1].toJSNumber(),o&&(u=N-1-u),a=h[0],s=c[0],f.push(n(l,u));for(var p=0!==n(r?1:0,o?1:0)?i(-1):i(0),d=f.length-1;d>=0;d-=1)p=p.multiply(N).add(i(f[d]));return p}s.prototype.shiftLeft=function(t){var e=$(t).toJSNumber();if(!D(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var n=this;if(n.isZero())return n;for(;e>=T;)n=n.multiply(N),e-=T-1;return n.multiply(V[e])},u.prototype.shiftLeft=l.prototype.shiftLeft=s.prototype.shiftLeft,s.prototype.shiftRight=function(t){var e,n=$(t).toJSNumber();if(!D(n))throw new Error(String(n)+" is too large for shifting.");if(n<0)return this.shiftLeft(-n);for(var r=this;n>=T;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(e=C(r,N))[1].isNegative()?e[0].prev():e[0],n-=T-1}return(e=C(r,V[n]))[1].isNegative()?e[0].prev():e[0]},u.prototype.shiftRight=l.prototype.shiftRight=s.prototype.shiftRight,s.prototype.not=function(){return this.negate().prev()},u.prototype.not=l.prototype.not=s.prototype.not,s.prototype.and=function(t){return j(this,t,(function(t,e){return t&e}))},u.prototype.and=l.prototype.and=s.prototype.and,s.prototype.or=function(t){return j(this,t,(function(t,e){return t|e}))},u.prototype.or=l.prototype.or=s.prototype.or,s.prototype.xor=function(t){return j(this,t,(function(t,e){return t^e}))},u.prototype.xor=l.prototype.xor=s.prototype.xor;function R(t){var n=t.value,r="number"==typeof n?n|1<<30:"bigint"==typeof n?n|BigInt(1<<30):n[0]+n[1]*e|1073758208;return r&-r}function I(t,e){return t=$(t),e=$(e),t.greater(e)?t:e}function z(t,e){return t=$(t),e=$(e),t.lesser(e)?t:e}function L(t,e){if(t=$(t).abs(),e=$(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var n,r,i=a[1];t.isEven()&&e.isEven();)n=z(R(t),R(e)),t=t.divide(n),e=e.divide(n),i=i.multiply(n);for(;t.isEven();)t=t.divide(R(t));do{for(;e.isEven();)e=e.divide(R(e));t.greater(e)&&(r=e,e=t,t=r),e=e.subtract(t)}while(!e.isZero());return i.isUnit()?t:t.multiply(i)}s.prototype.bitLength=function(){var t=this;return t.compareTo(i(0))<0&&(t=t.negate().subtract(i(1))),0===t.compareTo(i(0))?i(0):i(function t(e,n){if(n.compareTo(e)<=0){var r=t(e,n.square(n)),o=r.p,a=r.e,s=o.multiply(n);return s.compareTo(e)<=0?{p:s,e:2*a+1}:{p:o,e:2*a}}return{p:i(1),e:0}}(t,i(2)).e).add(i(1))},u.prototype.bitLength=l.prototype.bitLength=s.prototype.bitLength;var F=function(t,e,n,r){n=n||"0123456789abcdefghijklmnopqrstuvwxyz",t=String(t),r||(t=t.toLowerCase(),n=n.toLowerCase());var i,o=t.length,a=Math.abs(e),s={};for(i=0;i<n.length;i++)s[n[i]]=i;for(i=0;i<o;i++){if("-"!==(h=t[i])&&(h in s&&s[h]>=a)){if("1"===h&&1===a)continue;throw new Error(h+" is not a valid digit in base "+e+".")}}e=$(e);var l=[],u="-"===t[0];for(i=u?1:0;i<t.length;i++){var h;if((h=t[i])in s)l.push($(s[h]));else{if("<"!==h)throw new Error(h+" is not a valid character");var c=i;do{i++}while(">"!==t[i]&&i<t.length);l.push($(t.slice(c+1,i)))}}return q(l,e,u)};function q(t,e,n){var r,i=a[0],o=a[1];for(r=t.length-1;r>=0;r--)i=i.add(t[r].times(o)),o=o.times(e);return n?i.negate():i}function _(t,e){if((e=i(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var n=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return n.unshift([1]),{value:[].concat.apply([],n),isNegative:!1}}var r=!1;if(t.isNegative()&&e.isPositive()&&(r=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:r};for(var o,a=[],s=t;s.isNegative()||s.compareAbs(e)>=0;){o=s.divmod(e),s=o.quotient;var l=o.remainder;l.isNegative()&&(l=e.minus(l).abs(),s=s.next()),a.push(l.toJSNumber())}return a.push(s.toJSNumber()),{value:a.reverse(),isNegative:r}}function X(t,e,n){var r=_(t,e);return(r.isNegative?"-":"")+r.value.map((function(t){return function(t,e){return t<(e=e||"0123456789abcdefghijklmnopqrstuvwxyz").length?e[t]:"<"+t+">"}(t,n)})).join("")}function U(t){if(h(+t)){var e=+t;if(e===y(e))return o?new u(BigInt(e)):new l(e);throw new Error("Invalid integer: "+t)}var n="-"===t[0];n&&(t=t.slice(1));var r=t.split(/e/i);if(r.length>2)throw new Error("Invalid integer: "+r.join("e"));if(2===r.length){var i=r[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==y(i)||!h(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var a=r[0],c=a.indexOf(".");if(c>=0&&(i-=a.length-c-1,a=a.slice(0,c)+a.slice(c+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=a+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(o)return new u(BigInt(n?"-"+t:t));for(var f=[],d=t.length,v=d-7;d>0;)f.push(+t.slice(v,d)),(v-=7)<0&&(v=0),d-=7;return p(f),new s(f,n)}function $(t){return"number"==typeof t?function(t){if(o)return new u(BigInt(t));if(h(t)){if(t!==y(t))throw new Error(t+" is not an integer.");return new l(t)}return U(t.toString())}(t):"string"==typeof t?U(t):"bigint"==typeof t?new u(t):t}s.prototype.toArray=function(t){return _(this,t)},l.prototype.toArray=function(t){return _(this,t)},u.prototype.toArray=function(t){return _(this,t)},s.prototype.toString=function(t,e){if(void 0===t&&(t=10),10!==t)return X(this,t,e);for(var n,r=this.value,i=r.length,o=String(r[--i]);--i>=0;)n=String(r[i]),o+="0000000".slice(n.length)+n;return(this.sign?"-":"")+o},l.prototype.toString=function(t,e){return void 0===t&&(t=10),10!=t?X(this,t,e):String(this.value)},u.prototype.toString=l.prototype.toString,u.prototype.toJSON=s.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},s.prototype.valueOf=function(){return parseInt(this.toString(),10)},s.prototype.toJSNumber=s.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var W=0;W<1e3;W++)a[W]=$(W),W>0&&(a[-W]=$(-W));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=I,a.min=z,a.gcd=L,a.lcm=function(t,e){return t=$(t).abs(),e=$(e).abs(),t.divide(L(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof s||t instanceof l||t instanceof u},a.randBetween=function(t,n,r){t=$(t),n=$(n);var i=r||Math.random,o=z(t,n),s=I(t,n).subtract(o).add(1);if(s.isSmall)return o.add(Math.floor(i()*s));for(var l=_(s,e).value,u=[],h=!0,c=0;c<l.length;c++){var f=h?l[c]:e,p=y(i()*f);u.push(p),p<f&&(h=!1)}return o.add(a.fromArray(u,e,!1))},a.fromArray=function(t,e,n){return q(t.map($),$(e||10),n)},a}();t.hasOwnProperty("exports")&&(t.exports=i),void 0===(r=function(){return i}.call(e,n,e,t))||(t.exports=r)}).call(this,n(6)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e);var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return e=t,i=[{key:"rel_logic",value:function(t,e){return t>3||t<0||e>3||e<0?-98:0===t||1===e?e:0===e||1===t||t===e?t:2===t&&3===e||3===t&&2===e?1:-99}},{key:"rel",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e.length>1){var r=0;for(var i in e)r=this.rel_logic(r,e[i]);return r}return-97}},{key:"inv_logic",value:function(t){switch(t){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}return-99}},{key:"inv",value:function(t,e){if(e>0){for(var n=t,r=0;r<e;r++)n=this.inv_logic(n);return n}return this.inv_logic(t)}},{key:"uForm2",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.reEntry(void 0,!1,n,t,e)}},{key:"iForm2",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.reEntry(void 0,!0,n,t,e)}},{key:"uForm3",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.reEntry(!0,t,i,e,n,r)}},{key:"iForm3",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.reEntry(!1,t,i,e,n,r)}},{key:"uForm4",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.reEntry(void 0,!1,i,t,e,n,r)}},{key:"iForm4",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.reEntry(void 0,!0,i,t,e,n,r)}},{key:"uForm5",value:function(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this.reEntry(!0,t,a,e,n,r,i,o)}},{key:"iForm5",value:function(t,e,n,r,i,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return this.reEntry(!1,t,a,e,n,r,i,o)}},{key:"reEntry",value:function(t,e,n){void 0===t&&(t=!1),void 0===e&&(e=!1);for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];var a=i.length%2==0,s=0,l=-1,u=!1;a?e&&(u=!0):t||(u=!0);for(var h=-1,c=0;c<i.length;c++){var f=i[c];if(1==f){h=c;break}if(0==f)s++;else if(2==f||3==f)if(-1==l)l=c;else if(f!=i[l]){h=l;break}}if(s==i.length)return u?3:2;if(h>=0){for(var p=1,d=h;d<i.length;d++)p=e&&d==i.length-1?this.rel(p,i[d]):this.inv(this.rel(p,i[d]));return p}for(var y=!t||a||e?1:2,v=i.length*y-1;v>=0;v--){var m=v%i.length;if(2==i[m]||3==i[m]){var g=i.length*y-1-v;if(n&&(e&&g%2==0||!e&&g%2==1))return u?this.rel(3,i[m]):this.rel(2,i[m]);var b=2;!e||a||t||(b=this.inv(b));for(var x=0;x<i.length*y;x++){var w=0;x==v&&(w=2==i[m]?0:this.inv(0)),b=e&&x==i.length-1?this.rel(b,w):this.inv(this.rel(b,w))}var E=2;!e||a||t||(E=this.inv(E));for(var P=0;P<i.length*y;P++){var S=0;P==v&&(S=2==i[m]?1:this.inv(1)),E=e&&P==i.length-1?this.rel(E,S):this.inv(this.rel(E,S))}return this.cont(b,E)}}return-99}},{key:"implL",value:function(t,e){return this.rel(this.inv(t),e)}},{key:"implR",value:function(t,e){return this.rel(t,this.inv(e))}},{key:"pre",value:function(t,e){return this.inv(this.implL(t,e))}},{key:"post",value:function(t,e){return this.inv(this.implR(t,e))}},{key:"cont",value:function(t,e){return this.rel(this.pre(t,e),this.post(t,e))}},{key:"equiv",value:function(t,e){return this.inv(this.cont(t,e))}}],(n=null)&&r(e.prototype,n),i&&r(e,i),t}(),o=n(0),a=n(1);function s(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e){for(var n=t+"";n.length<e;)n="0"+n;return n}String.prototype.replaceAll=function(t,e,n){return n&&(t=t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")),this.replace(new RegExp(t,"g"),e)},String.prototype.addBefore=function(t,e){return this.substr(0,t)+e+this.substr(t)},String.prototype.replaceAt=function(t,e){return this.substr(0,t)+e+this.substr(t+e.length)};var c=function(t){return t.reduce((function t(e,n,r,i){return e.concat(i.length>1&&i.slice(0,r).concat(i.slice(r+1)).reduce(t,[]).map((function(t){return[n].concat(t)}))||[[n]])}),[])},f=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.length>e?t.substr(0,e)+n:t},p={a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"",alt:"","2r":"","2r+1":""},d=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.keys(t).reduce((function(n,r){return Object.assign(n,u({},t[r],e?r:(n[t[r]]||[]).concat(r)))}),{})}(p,!0),y=function(t,e){return function(){var n=t.apply(void 0,arguments);return{cata:function(t){return n?t.success(n):t.error(e)}}}},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'"',n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!m(t,e))return null;var r=t.split(e);return r.filter((function(t,e,n){return e%2==0||e===n.length-1})).join(n)},m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'"',n=t.split(e);return n.length%2==1},g=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{open:"{",close:"}"},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=e.match(new RegExp("\\".concat(n.open,"[^").concat(n.open).concat(n.close,"]*?\\").concat(n.close),"g"));if(!i)return r;var o=i.reduce((function(t,e){return t.replace(e,"")}),e);return t(o,n,[].concat(s(r),s(i)))},b=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"(",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:")";return 0===t.length||0===t.split("").reduce((function(t,r,i,o){if(r===e)t++;else if(r===n){if(null===t)return NaN;t--}return i===o.length-1&&null===t?0:t}),null)},x=function(t,e){return void 0!==t&&void 0!==e&&(t.length===e.length&&t.every((function(t){return e.some((function(e){return t===e}))})))};function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){P(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function M(t,e,n){return(M="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=T(t);if(e){var i=T(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return V(this,n)}}function V(t,e){return!e||"object"!==S(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(i,t);var e,n,r;B(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),V(void 0)}return e=i,r=[{key:"calc",value:function(t){var e=0,n=this.getValidForm(t);for(var r in n.space)if("form"===n.space[r].type)e=this.rel(e,this.calc(n.space[r]));else if("const"===n.space[r].type)e=this.rel(e,n.space[r].value);else if("var"===n.space[r].type)isNaN(n.space[r].value)||(e=this.rel(e,n.space[r].value));else if("unclear"===n.space[r].type)e=this.rel(e,n.space[r].value);else if("reEntry"===n.space[r].type){var i=[],o=n.space[r];for(var a in o.nested)i=[].concat(k(i),[this.calc(o.nested[a])]);var s=o.nested.length%2==0?void 0:o.reEven;e=this.rel(e,this.reEntry.apply(this,[s,o.lastOpen,o.altInterpretation].concat(k(i))))}return n.unmarked?e:this.inv(e)}},{key:"calcAll",value:function(t){var e=this.getValidForm(t),n=this.getVariables(e),r=n.length,i={};if(r<1)return i.Result=this.calc(e),i;for(var o=n.join()+";",a=0;a<Math.pow(4,r);a++){var s=h(a.toString(4),r),l=s.split("").map((function(t,e){return{var:n[e],value:parseInt(t)}}));i[o+s]=this.interCalc(e,l)}return i}},{key:"interCalc",value:function(t,e){return this.calc(this.interpret(t,e))}},{key:"interpret",value:function(t,e){var n=this.getValidForm(t),r=JSON.parse(JSON.stringify(n));return this.traverseForm(r,(function(t){var n=t.space;for(var r in n)if("var"===n[r].type)for(var i in e)if(n[r].symbol===e[i].var){n[r].value=e[i].value;break}})),r}},{key:"rel_logic",value:function(t,e){return S(t)===Array||S(e)===Array?null:M(T(i),"rel_logic",this).call(this,t,e)}},{key:"rel",value:function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(t=M(T(i),"rel",this)).call.apply(t,[this].concat(n))}},{key:"inv_logic",value:function(t){return S(t)===Array?null:M(T(i),"inv_logic",this).call(this,t)}},{key:"inv",value:function(t,e){return M(T(i),"inv",this).call(this,t,e)}},{key:"parseLinear",value:function(t){var e=this.convFromLinear(t),n=null;try{n=JSON.parse(e)}catch(t){console.log(t)}return n}},{key:"convFromLinear",value:function(t){var e=this.cleanLinear(t);return function t(e){return e.reduce((function(e,n){return e.concat(Array.isArray(n)?t(n):n)}),[])}(this.constructFromLinear(e)).join("")}},{key:"cleanLinear",value:function(t){var e="",n=!1,r=!1;for(var i in t){var o=t[i];if("string"!=typeof o)break;'"'!==o||r||(n=!n),"/"!==o||n||(r=!r)," "===o?(n||r)&&(e+=o):e+=o}return e}},{key:"constructFromLinear",value:function(t){var e=[],n=!0,r=0,i=!1,o=!1;for(var a in t){var s=t[a];if("string"!=typeof s)break;if(!i&&!o)if("("===s){if(0==r&&0!=a)break;r++}else if(")"===s&&0==--r){if(a==t.length-1){n=!1;break}break}'"'!==s||o||(i=!i),"/"!==s||i||(o=!o)}e=[].concat(k(e),["  {"]),e=[].concat(k(e),['"type":"form",']),n?e=[].concat(k(e),['"unmarked":true,']):t=t.slice(1,t.length-1),e=[].concat(k(e),['"space":[']);var l=[""];for(var u in r=0,i=!1,o=!1,t){var h=t[u],c=t[u-1];if("string"!=typeof h)break;i||o||(")"!==h&&"}"!==h||r--,"("===h||"{"===h?(0===r&&u>0&&(l=[].concat(k(l),[""])),r++):")"!==c&&"}"!==c||")"===h||"}"===h||0===r&&(l=[].concat(k(l),[""])),1===r&&","===h?h="":1===r&&"|"===h&&(h="")),'"'!==h||o||(i=!i),"/"!==h||i||(o=!o),l[l.length-1]+=h}for(var f in l){if("("===l[f][0]){var p=[this.constructFromLinear(l[f])];l[f]=p.slice()}else if("{"===l[f][0]){var d=["  {"];d=[].concat(k(d),['"type":"reEntry",']);var y=l[f].slice(1,l[f].length-1).split(""),v=y[y.length-1].split("");for(var m in d=v.length%2==0?[].concat(k(d),['"reEven":"undefined",']):"2r"===y[0]||"2r"===y[1]||"2r"===y[2]?[].concat(k(d),['"reEven":true,']):[].concat(k(d),['"reEven":false,']),d="open"===y[0]||"open"===y[1]||"open"===y[2]?[].concat(k(d),['"lastOpen":true,']):[].concat(k(d),['"lastOpen":false,']),d="alt"===y[0]||"alt"===y[1]||"alt"===y[2]?[].concat(k(d),['"altInterpretation":true,']):[].concat(k(d),['"altInterpretation":false,']),d=[].concat(k(d),['"nested":[']),v)d=[].concat(k(d),[this.constructFromLinear(v[m])]),m<v.length-1&&(d=[].concat(k(d),[","]));d=[].concat(k(d),["]}  "]),l[f]=d.slice()}else{var g=[],b=[],x=!1,w=!1;for(var E in l[f]){var P=l[f][E];if("string"!=typeof P)break;'"'!==P||w?"/"!==P||x?(x||w||(b=[].concat(k(b),[""])),b[b.length-1]+='"'===P&&w?"\\"+P:P):(w=!w)&&(b=[].concat(k(b),[""])):(x=!x)&&(b=[].concat(k(b),[""]))}for(var S in b){if("string"!=typeof b[S])break;g=[].concat(k(g),["  {"]),!isNaN(b[S])&&b[S].length>0&&""!==b[S][0]&&""!==b[S][0]?(g=[].concat(k(g),['"type":"const",']),g=[].concat(k(g),['"value":']),g=[].concat(k(g),[b[S]])):""===b[S][0]?(g=[].concat(k(g),['"type":"unclear",']),g=[].concat(k(g),['"value":2,']),g=[].concat(k(g),['"symbol":']),g=[].concat(k(g),['"'+b[S].slice(1)+'"'])):(g=[].concat(k(g),['"type":"var",']),g=[].concat(k(g),['"value":"*",']),g=[].concat(k(g),['"symbol":']),g=""===b[S][0]?[].concat(k(g),['"'+b[S].slice(1)+'"']):[].concat(k(g),['"'+b[S]+'"'])),g=[].concat(k(g),["}  "]),S<b.length-1&&(g=[].concat(k(g),[","]))}l[f]=g.slice()}e=[].concat(k(e),[l[f]]),f<l.length-1&&(e=[].concat(k(e),[","]))}return e=[].concat(k(e),["]}  "])}},{key:"jsonString",value:function(t){var e=this.getValidForm(t);return JSON.stringify(e,void 0,2)}},{key:"getVariables",value:function(t){var e=this.getValidForm(t),n=[];return this.traverseForm(e,(function(t){var e,r,i=t.space;for(var o in i)"var"===i[o].type&&(e=n,r=i[o].symbol,-1==e.indexOf(r)&&(n=[].concat(k(n),[i[o].symbol])))})),n.sort()}},{key:"traverseForm",value:function(t,e){var n=e.apply(this,[t]);if(t.space){if(t.space.length>0)for(var r in t.space)if(("form"===t.space[r].type||"reEntry"===t.space[r].type)&&this.traverseForm(t.space[r],e))break}else if(t.nested){if(t.nested.length>0)for(var i in t.nested)if(this.traverseForm(t.nested[i],e))break}else console.log("ERROR: Not a form!");return n}},{key:"getTotalVars",value:function(t){return this.getVariables(t.substr()).length}},{key:"reOrderVars",value:function(t,e){return this.decodeVars(this.encodeVars(t,e))}},{key:"decodeVars",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=d;if(e){var r=Object.keys(d),i=r.slice(0,e.length),o=r.slice(-3);n=i.concat(o).reduce((function(t,n,r){return E(E({},t),{},P({},n,r<e.length?e[r]:d[n]))}),{})}return t.split("").map((function(t){return Object.keys(n).indexOf(t)>-1?n[t]:t})).join("")}},{key:"encodeVars",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;function n(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}e||(e=this.getVariables(t));var r={alt:"alt(?=|)",rEven:"2r(?=|)",rOdd:"2r+1(?=|)"},i=function(t){return t.length>1?'"'.concat(n(t),'"'):"".concat(n(t))};return e.reduce((function(t,e,n){return t.replace(new RegExp(r.alt,"g"),p.alt).replace(new RegExp(r.rEven,"g"),p["2r"]).replace(new RegExp(r.rOdd,"g"),p["2r+1"]).replace(new RegExp(i(e),"g"),Object.keys(d)[n])}),t)}},{key:"matchDefaultVarOrder",value:function(t){return"ELR"===t.join("")?["L","E","R"]:"+-LR"===t.join("")?["-","L","R","+"]:"+-ELR"===t.join("")?["-","L","E","R","+"]:t}},{key:"isValidForm",value:function(t,e){return"string"==typeof t?isValidFormula(t,e):isValidJSONForm(t,e)}},{key:"isValidFormula",value:function(t,e){var n=this,r=[y((function(){return"string"==typeof t}),"Formula input is not of type string")];if(t.length>0&&(r=[].concat(k(r),[y((function(){return!!v(t,'"')&&!!v(t,"/")}),'Number of quotes for literal variables (e.g.: "x") or number of slashes for unclear FORMs (e.g.: /x/) don\'t match')])),r.every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})})),t.length>0){var i=v(v(t,'"'),"/");[y((function(){return b(i,"(",")")}),"Number or opening/closing order of parantheses in formula don't match"),y((function(){return b(i,"{","}")}),"Number or opening/closing order of curly brackets in formula don't match")].every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})}));var o=g(i,{open:"(",close:")"}),a=g(i,{open:"{",close:"}"});[y((function(){return o.every((function(t){return b(t,"{","}")}))&&a.every((function(t){return b(t,"(",")")}))}),"Opening/closing of parantheses overlaps with opening/closing of curly brackets in formula (e.g.: ({a)b})"),y((function(){return a.every((function(t){return n.isValidReEntry(t)}))}),"Option part of one or more re-entry constructions is not well-formed")].every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})}))}return!0}},{key:"isValidReEntry",value:function(t,e){var n=t.slice(1,-1).split("|");if(n.length>1){var r=n.filter((function(t,e,n){return e<n.length-1})),i=["alt","open","2r","2r+1"],o=r.reduce((function(t,e){return[].concat(k(t),[i.filter((function(t){return e===t}))[0]])}),[]).filter((function(t){return t})),a=k(new Set(o));return[y((function(){return a.length===r.length}),"One or more re-entry constructions have invalid or duplicate options"),y((function(){return a.filter((function(t){return t===i[2]||t===i[3]})).length<2}),"One or more re-entry constructions have both options 2r and 2r+1 set at the same time")].every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})}))}return!0}},{key:"isValidJSONForm",value:function(t,e){return[y((function(){return!0}),"")].every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})}))}},{key:"formMatchesVarList",value:function(t,e){var n=this.getVariables(t);if(e.length!==n.length||!n.every((function(t){return e.some((function(e){return t===e}))})))throw new Error("FORM doesn't match the given variable list");return!0}},{key:"getValidForm",value:function(t){if("string"==typeof t){if(!this.isValidFormula(t))throw new Error("Input is not a valid formula");return this.parseLinear(t)}return t}}],(n=null)&&C(e.prototype,n),r&&C(e,r),i}(i),D=n(2),j=n.n(D),R={width:window.innerWidth,height:window.innerHeight,margin:{left:10,right:10,top:10,bottom:10}};function I(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R,n=Object.assign({},e,t);return t.parentId?n.parent=o.select("#".concat(t.parentId)):o.select("body"),n.svg=n.parent.append("svg").lower().attr("id",n.id||"chart").attr("width",n.width-n.margin.right).attr("height",n.height-n.margin.bottom),t.styleClass&&n.svg.attr("class",t.styleClass),t.drawBackground&&n.svg.append("rect").attr("id","background").attr("width","100%").attr("height","100%").attr("fill","#ffffff"),n.container=n.svg.append("g").attr("id","container").attr("transform","translate(".concat(n.margin.left,", ").concat(n.margin.top,")")),n}function z(t,e){o.select(t.node().parentElement).attr("width",t.node().getBBox().width+e.left+e.right).attr("height",t.node().getBBox().height+e.top+e.bottom)}function L(t){var e=t.ancestors().filter((function(t){return"form"===t.data.type&&t.data.unmarked||"reEntry"===t.data.type&&t.data.lastOpen})).length;return t.depth-e}function F(t){return function(e){e.each((function(e){var n="string"==typeof t(e)?t(e).split("_"):"";2===n.length?(o.select(this).append("tspan").text((function(t){return n[0]})),o.select(this).append("tspan").text((function(t){return n[1]})).attr("dx",1).attr("dy",6).style("font-size",".8em")):o.select(this).text(t(e))}))}}function q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inherit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inherit",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal";if(o){var i=o.select("body").append("svg");i.append("text").style("font-size",e).style("font-style",r).style("font-family",n).attr("x","-9999").attr("y","-9999").call(F((function(){return t})));var a=i.node().getBBox();return i.remove(),{width:a.width,height:a.height}}}function _(t,e,n){return function(t,e){for(var n=0,r=1,i=Math.round(e),o=i;t%i>.3&&(t%(o+=.001*r)<t%i&&(i=o),n>=5e3&&(o=Math.round(e),r=-1),!(n>=1e4));)n++;return i}(2*Math.PI*t,e)*n}function X(t,e,n){var r="";for(var i in n)r=r.concat("".concat(_(t,e,n[i]),"px "));return r}function U(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return $(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function H(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){G(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function G(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var J={common:{font:{family:"sans-serif",size:"14px",style:"normal"},fontVar:{family:"sans-serif",size:"14px",style:"italic"},fontConst:{family:"courier, monospace",size:"14px",style:"normal"},fontContext:{family:"sans-serif",size:"10px",style:"normal"},strokeWidth:1,labels:{reEven:"2|r|",reOdd:"2|r|+1"},color:{base:o.color("black"),ground:o.color("white"),indef:o.color("red"),light:o.color("#ddd")}}};J.basic=H(H({},J.common),{},{font:H(H({},J.common.font),{},{family:"georgia, serif"}),fontVar:H(H({},J.common.fontVar),{},{family:"georgia, serif",style:"italic"}),fontConst:H(H({},J.common.fontConst),{},{family:"georgia, serif"}),fontContext:H(H({},J.common.fontContext),{},{family:"courier, monospace"})}),J.gestalt=H(H({},J.common),{},{font:H(H({},J.common.font),{},{family:"arial, sans-serif"}),fontVar:H(H({},J.common.fontVar),{},{family:"arial, sans-serif"}),fontConst:H(H({},J.common.fontConst),{},{family:"arial, sans-serif"}),fontContext:H(H({},J.common.fontContext),{},{family:"georgia, serif"}),color:H(H({},J.common.color),{},{pos:o.color("white"),neg:o.color("black")})});var Y=[J.basic,J.gestalt],Z=Y[0],Q=Y[1];function K(t){t.attr("stroke","none").attr("fill","none")}var tt={common:{nodeSize:{w:10,h:10},nodeSeparation:{hz:20,vt:40},dashes:{link:"4px 6px"}}};tt.basic=H(H({},Z),tt.common),tt.basic.applyAxisStyles=function(t){t.selectAll(".tick").select("line").style("stroke-width",1.5*this.nodeSize.w).style("stroke","rgba(0,0,0,.05").style("stroke-linecap","round"),t.selectAll(".tick").select("text").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("fill",this.color.base.toString()).attr("text-anchor","start")},tt.basic.applyNodeStyles=function(t,e){var n=U(e,10),r=(n[0],n[1]),i=n[2],o=n[3],a=n[4],s=n[5],l=n[6],u=n[7],h=n[8];n[9];i.selectAll("circle").style("stroke",this.color.base.toString()).style("fill",this.color.ground.toString()),l.selectAll("circle").style("fill",this.color.base.toString()),o.selectAll("circle").style("stroke",this.color.indef.toString()).style("fill",this.color.indef.toString()).filter((function(t){return t.data.lastOpen})).style("fill",this.color.ground.toString()),a.selectAll("circle").style("stroke",this.color.indef.toString()).style("stroke-dasharray",(function(t){return X(t.r,3,[1])})),s.selectAll("circle").style("fill",this.color.indef.toString()),t.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("fill",this.color.base.toString()),u.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),h.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),r.selectAll("circle.inner").style("stroke","none").style("fill",this.color.base.toString())},tt.basic.applyLinkStyles=function(t,e){var n=U(e,2),r=n[0],i=n[1];t.selectAll("path").style("stroke",this.color.base.toString()),r.selectAll("path").style("stroke",this.color.indef.toString()).style("stroke-dasharray",this.dashes.link),i.selectAll("path").style("stroke",this.color.indef.toString()).style("stroke-dasharray",this.dashes.link)};var et={common:{radius:14,padding:14}};et.basic=H(H({},Z),et.common),et.basic.applyNodeStyles=function(t,e){var n=U(e,10),r=(n[0],n[1],n[2]),i=n[3],o=(n[4],n[5]),a=n[6],s=n[7],l=n[8],u=n[9];r.select("circle").style("stroke",this.color.base.toString()).filter((function(t){return t.data.unmarked})).style("stroke","none"),i.select("circle").style("stroke",this.color.indef.toString()).filter((function(t){return t.data.lastOpen})).style("stroke-dasharray",(function(t){return X(t.r,14,[.4,.6])})),a.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("text-anchor","middle").style("fill",this.color.base.toString()),s.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),l.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),u.select("rect").style("fill",this.color.light.toString()),o.select("circle").style("fill",this.color.indef.toString()).style("stroke","none");i.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",this.color.indef.toString())},et.gestalt=H(H({},Q),et.common),et.gestalt.invertFill=function(t){return L(t)%2?this.color.pos.toString():this.color.neg.toString()},et.gestalt.applyNodeStyles=function(t,e,n){var r=this,i=U(e,10),a=(i[0],i[1],i[2]),s=i[3],l=(i[4],i[5]),u=i[6],h=i[7],c=i[8],f=i[9],p=o.select(n.node().parentNode).append("defs"),d=p.append("radialGradient").attr("id","grad-indef-outin").attr("fx","20%");d.append("stop").attr("offset","40%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.3),d.append("stop").attr("offset","90%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.8),d.append("stop").attr("offset","100%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",1);var y=p.append("radialGradient").attr("id","grad-indef-inout").attr("fx","20%");y.append("stop").attr("offset","10%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",1),y.append("stop").attr("offset","50%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.6),y.append("stop").attr("offset","60%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",.4),y.append("stop").attr("offset","100%").attr("stop-color",this.color.indef.toString()).attr("stop-opacity",0),a.select("circle").filter((function(t){return!t.data.unmarked})).style("stroke","none").style("fill",(function(t){return r.invertFill(t)})),s.select("circle").style("stroke",(function(t){return"reEntry"===t.parent.data.type?r.color.pos.toString():"none"})).style("fill","url(#grad-indef-outin)");var v=s.select("circle").filter((function(t){return t.data.lastOpen})).style("fill","url(#grad-indef-inout)").style("stroke-dasharray",(function(t){return X(t.r,8,[.4,.6])}));v.filter((function(t){return"reEntry"!==t.parent.data.type||!L(t)%2})).style("stroke",(function(t){return r.color.indef.toString()})),v.filter((function(t){return"reEntry"===t.parent.data.type&&!t.parent.data.lastOpen})).style("stroke",(function(t){return r.color.pos.toString()})),u.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("dominant-baseline","middle").style("text-anchor","middle").style("stroke","none").style("fill",(function(t){return r.invertFill(t)})),h.selectAll("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),c.selectAll("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),f.select("rect").style("fill",this.color.light.toString()),f.select("text").style("fill",this.color.base.toString()),l.select("circle").style("fill",this.color.indef.toString()).style("stroke","none").filter((function(t){return"reEntry"===t.parent.data.type})).style("stroke",this.color.indef.toString()).style("fill",this.color.pos.toString()).attr("transform","scale(1.5)");s.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",(function(t){return"reEntry"!==t.parent.data.type||t.parent.data.lastOpen?r.color.indef.toString():r.color.pos.toString()}));s.select(".label.inside").style("fill",(function(t){return"reEntry"!==t.parent.data.type&&t.data.lastOpen?r.color.indef.toString():r.color.pos.toString()}))};var nt={common:{elemMargin:{hz:12,vt:8},formMargin:{top:10,right:10},formPadding:{hz:0},minFormSize:{width:34,height:34},maxLineWidth:1e4,strokeWidth:1.1}};function rt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return it(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return it(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function at(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){st(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function st(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}nt.basic=H(H({},Z),nt.common),nt.basic.applyNodeStyles=function(t,e){var n=U(e,10),r=(n[0],n[1]),i=n[2],o=n[3],a=(n[4],n[5],n[6]),s=n[7],l=n[8],u=n[9];r.select("polyline").style("fill","none").style("stroke",this.color.base.toString()).style("stroke-width",this.strokeWidth),i.select("polyline").filter((function(t){return t.data.unmarked})).style("stroke","none"),a.selectAll("text").style("font-size",this.font.size).style("font-style",this.font.style).style("font-family",this.font.family).style("fill",this.color.base.toString()),s.select("text").style("font-size",this.fontVar.size).style("font-style",this.fontVar.style).style("font-family",this.fontVar.family),l.select("text").style("font-size",this.fontConst.size).style("font-style",this.fontConst.style).style("font-family",this.fontConst.family),o.select(".label").style("font-size",this.fontContext.size).style("font-style",this.fontContext.style).style("font-family",this.fontContext.family).style("stroke","none").style("fill",this.color.base.toString()),u.select(".unclearMark").style("fill",this.color.light.toString()),u.select("text").style("font-size",this.fontVar.size).style("font-style","normal").style("font-family",this.fontVar.family).style("stroke","none").style("fill",this.color.base.toString())};var ht=function(){function t(e,n,r){var i;lt(this,t);var o=I(at(at({},{margin:{left:50,right:50,top:50,bottom:50},padding:{left:10,right:10,top:10,bottom:10},styleClass:"basic"}),r));Object.assign(this,o),this.innerHeight=this.height-this.margin.top-this.margin.bottom-this.padding.top-this.padding.bottom,this.innerWidth=this.width-this.margin.left-this.margin.right-this.padding.left-this.padding.right;for(var a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];(i=this.constructor[e]).call.apply(i,[this,n].concat(s))}var e,n,r;return e=t,r=[{key:"tree",value:function(t){var e=this,n=this.container,r=o.hierarchy(t,(function(t){return t.space})),i=tt[this.styleClass],a=[i.nodeSize,i.nodeSeparation],s=a[0],l=a[1];i.font.size,i.font.family,this.padding={left:10,right:10,top:10,bottom:10},r.dx=s.w+l.hz,r.dy=this.width/(r.height+1);var u=o.tree().nodeSize([r.dx,r.dy]).separation((function(t,e){return t.parent==e.parent?1:2}))(r),h=1/0,c=-h;u.each((function(t){t.x>c&&(c=t.x),t.x<h&&(h=t.x)}));var f=r.data.unmarked,p=1.8*s.h,d=p;this.height=c-h+2*this.padding.top+s.h+2+d,this.svg.attr("width",this.width).attr("height",this.height),K(this.svg),n.classed("graph-tree",!0).attr("transform","translate(".concat(this.padding.left+s.w/2+(r.data.unmarked?-r.dy:0),",").concat(this.padding.top-h+s.h/2,")"));var y=o.range(r.height+(f?0:1));this.depthScale=o.scaleOrdinal().domain(y).range(y.map((function(t){return(t+(f?1:0))*r.dy})));var v=o.axisBottom().scale(this.depthScale).tickSizeInner(-(c-h)).tickSizeOuter(0).tickPadding(p).tickValues(this.depthScale.domain().map((function(t){return e.depthScale.domain().length<15?"Depth "+t:t}))),m=n.append("g").classed("depthAxis",!0).attr("transform","translate(0, ".concat(c,")")).call(v);m.select(".domain").remove();var g=n.selectAll(".link").data(u.links()).enter().append("g").classed("link",!0),b=n.selectAll(".node").data(u.descendants()).enter().append("g").classed("node",!0).attr("transform",(function(t){return"translate(".concat(t.y,",").concat(t.x,")")}));f&&(g.filter((function(t){return 0===t.source.depth})).remove(),b.filter((function(t){return 0===t.depth})).remove());var x=function(t,e){var n=e.filter((function(t){return t.target.data.reChild})).classed("reChildLink",!0),r=e.filter((function(t){return"reEntryPoint"===t.target.data.type})).classed("rePointLink",!0);return[n,r]}(0,g),w=rt(x,2),E=(w[0],w[1],ct(u,b)),P=rt(E,10),S=(P[0],P[1]),k=(P[2],P[3],P[4],P[5]),O=P[6],C=P[7],M=P[8],A=P[9];o.line().curve(o.curveBasis),g.append("path").attr("d",o.linkHorizontal().x((function(t){return t.y})).y((function(t){return t.x}))),b.filter((function(t){return!t.data.unmarked})).append("circle").attr("r",s.w/2),k.append("text").attr("x",s.w/2+2).text((function(t){for(var e=t.parent,n=0;"reEntry"!==e.data.type;){if(e=e.parent,n>1e3)return null;n++}return"undefined"!==e.data.reEven?e.data.reEven?"2|r|":"2|r|+1":""})),O.selectAll("circle").attr("r",s.w/2/2),b.append("text").attr("x",s.w/2+2),C.selectAll("text").call(F((function(t){return t.data.symbol}))),M.selectAll("text").text((function(t){return"= ".concat(t.data.value)})),A.selectAll("text").text((function(t){return"/".concat(t.data.symbol,"/")})),S.filter((function(t){return t.children})).append("circle").classed("inner",!0).attr("r",s.w/2/2),i.applyAxisStyles(m),i.applyLinkStyles(g,x),i.applyNodeStyles(b,E),z(n,this.padding)}},{key:"pack",value:function(t){var e=this.container;K(this.svg);var n=o.hierarchy(t,(function(t){return t.space})).sum((function(t){return t.children?0:1})),r=et[this.styleClass],i=[r.radius,r.padding],a=i[0],s=i[1],l=[r.font.size,r.font.family],u=l[0],h=l[1],c=o.pack().padding((function(t){var e=s;return"form"===t.data.type&&1===t.children.length&&"form"===t.children[0].data.type&&(e*=.4),t.data.unmarked&&1===t.children.length&&(e=0),e})).radius((function(t){var e=a;return"string"==typeof t.data.symbol?(e=q(t.data.symbol,u,h).width/2,"unclear"===t.data.type&&(e+=2*s)):t.data.value?e=q(t.data.value+"",u,h).width/2:(t.data.children||"reEntryPoint"===t.data.type||"space"===t.data.type)&&(e=0),e}))(n);e.attr("class","graph-pack").attr("transform","translate(".concat(c.r+this.padding.left,",").concat(c.r+this.padding.top,")"));var f=e.selectAll(".node").data(c.descendants()).enter().append("g").classed("node",!0).attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")})),p=ct(c,f),d=rt(p,10),y=(d[0],d[1]),v=(d[2],d[3]),m=(d[4],d[5]),g=(d[6],d[7]),b=d[8],x=d[9];y.append("circle").attr("r",(function(t){return t.r})),g.append("text").call(F((function(t){return t.data.symbol}))),b.append("text").text((function(t){return t.data.value})),x.append("rect").attr("transform",(function(t){return"skewX(-30) translate(".concat(-(t.r-s),",\n            ").concat(-(q("x",u,h).height+2*s)/2,")")})).attr("width",(function(t){return 2*t.r-2*s})).attr("height",(function(t){return q("x",u,h).height+2*s})),x.append("text").call(F((function(t){return t.data.symbol}))),m.append("circle").attr("r",1.5),v.filter((function(t){return"undefined"!==t.data.reEven})).call(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inherit",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inherit",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"normal";return function(i){i.each((function(i){var a=q(t(i),e,n);o.select(this).append("text").style("font-size",e).style("font-style",r).style("font-family",n).style("text-anchor","middle").raise().text((function(e){return t(e)})),o.select(this).filter((function(t){return 2*t.r>=a.width+50})).select("text").classed("label inside",!0).attr("y",(function(t){return t.r-.5*a.height})).attr("dominant-baseline","baseline"),o.select(this).filter((function(t){return 2*t.r<a.width+50})).select("text").classed("label outside",!0).attr("y",(function(t){return t.r+4})).attr("dominant-baseline","hanging")}))}}((function(t){return t.data.reEven?"2|r|":"2|r|+1"}),r.fontContext.size,r.fontContext.family)),r.applyNodeStyles(f,p,e),z(e,this.padding)}},{key:"gsbhooks",value:function(t){var e=this.container;K(this.svg);var n=o.hierarchy(t,(function(t){return t.space})).sum((function(t){return t.space?0:1}));this.styleClass="basic";var r=null===this.compactChecked||this.compactChecked,i=nt[this.styleClass],a=at({},i),s=a.elemMargin,l=a.formMargin,u=a.formPadding,h=a.minFormSize,c=a.maxLineWidth,f=a.fontVar,p=a.fontConst,d=a.fontContext,y=a.labels,v=s.hz/2,m=s.vt,g=j()().vAlign("bottom").edgeMargins((function(t){return!(ft(t)&&!t.parent.parent&&t.parent.data.unmarked)})).isContainer((function(t){return ft(t)})).padding((function(t){var e={left:0,right:0,top:0,bottom:0};if(ft(t)&&(e.left=e.right=u.hz,"reEntry"===t.data.type)){var n=q(t.data.reEven?y.reEven:y.reOdd,d.size,d.family,d.style);e.bottom=n.height+s.vt/2}return e})).margin((function(t){var e={left:0,right:0,top:0,bottom:0};return ft(t)?(e.top=l.top,e.right=l.right,0===t.depth&&(e.top=0),t.data.reChild&&(1===t.parent.children.length&&(e.right=h.width),t.parent.data.lastOpen&&(e.top=0),r&&t.parent.data.reChild&&("reEntryPoint"===t.children[0].data.type&&pt(t)||(e.top=0)))):"reEntryPoint"!==t.data.type?(e.top=e.bottom=s.vt,e.left=e.right=s.hz,"italic"==f.style&&(e.right+=1),"unclear"===t.data.type&&(e.bottom=0)):"reEntryPoint"===t.data.type&&(e.right=l.right),e})).spanHeight((function(t){var e=!1;return r&&t.data.reChild&&(e=!0),e})).minContainerSize((function(t){var e=h.width,n=h.height;return t.data.reChild&&1===t.children.length&&"reEntryPoint"===t.children[0].data.type&&pt(t)&&(e=h.width/2),"reEntry"===t.data.type&&t.children.length<=2&&"reEntryPoint"===t.children[0].data.type&&(e=(e=q(t.data.reEven?y.reEven:y.reOdd,d.size,d.family,d.style).width+8)<h.width?h.width:e),{width:e,height:n}})).maxLineWidth((function(t){return c})).nodeSize((function(t){var e,n=0,r=0;if("var"===(e=t).data.type||"const"===e.data.type||"unclear"===e.data.type){var i=void 0;switch(t.data.type){case"var":n=(i=q(t.data.symbol,f.size,f.family,f.style)).width,r=.7*i.height;break;case"unclear":n=(i=q(t.data.symbol,f.size,f.family,"normal")).width,n+=2*yt((r=.7*i.height)+2*m)+2*v,r+=2*m;break;case"const":n=(i=q(t.data.value,p.size,p.family,p.style)).width,r=.7*i.height}}return{width:n,height:r}}))(n);e.attr("class","graph-boxmodel").attr("transform","translate(".concat(this.padding.left,",").concat(this.padding.top,")"));var b=e.selectAll(".node").data(g.descendants()).enter().append("g").classed("node",!0).attr("transform",(function(t){return"translate(".concat(t.x0,",").concat(t.y0,")")})),x=ct(g,b),w=rt(x,10),E=(w[0],w[1],w[2]),P=w[3],S=(w[4],w[5],w[6],w[7]),k=w[8],O=w[9];E.append("polyline").attr("points",(function(t){return"0,0 ".concat(t.x1-t.x0,",0 ").concat(t.x1-t.x0,",").concat(t.y1-t.y0)})),P.append("polyline").attr("points",(function(t){var e=t.x1-t.x0,n=t.y1-t.y0,r=h.height;return"0,0 ".concat(e,",0 ").concat(e,",").concat(n," 0,").concat(n," 0,").concat(n-r)})).filter((function(t){return t.data.lastOpen})).attr("points",(function(t){var e=t.x1-t.x0,n=t.y1-t.y0,r=h.height;return"".concat(e,",").concat(n-r," ").concat(e,",").concat(n," 0,").concat(n," 0,").concat(n-r)})),P.filter((function(t){return"undefined"!==t.data.reEven})).append("text").classed("label",!0).attr("transform",(function(t){return"translate(0,".concat(t.y1-t.y0,")")})).attr("x",(function(t){return 4})).attr("y",(function(t){return-5})).text((function(t){return t.data.reEven?y.reEven:y.reOdd}));var C=function(t){return yt(.7*function(t){return q(t.data.symbol,f.size,f.family,"normal")}(t).height+2*m)};O.append("rect").classed("unclearMark",!0).attr("transform",(function(t){return"skewX(-30) translate(".concat(C(t),",",0,")")})).attr("width",(function(t){return t.x1-t.x0-C(t)})).attr("height",(function(t){return t.y1-t.y0})),O.append("text").attr("x",(function(t){return C(t)+v})).attr("y",(function(t){return t.y1-t.y0-m-(t.data.symbol.split("_").length>1?6:0)})).call(F((function(t){return t.data.symbol}))),k.append("text").attr("y",(function(t){return t.y1-t.y0})).text((function(t){return t.data.value})),S.append("text").attr("y",(function(t){return t.y1-t.y0})).call(F((function(t){return t.data.symbol}))),i.applyNodeStyles(b,x,e),z(e,this.padding)}},{key:"force",value:function(t){}}],(n=null)&&ut(e.prototype,n),r&&ut(e,r),t}();function ct(t,e){var n=e.filter((function(e){return t.leaves().filter((function(t){return t===e})).pop()})).classed("leaf",!0),r=e.filter((function(t){return"form"===t.data.type||"reEntry"===t.data.type})).classed("form",!0),i=r.filter((function(t){return"form"===t.data.type})).classed("form",!0),o=r.filter((function(t){return"reEntry"===t.data.type})).classed("reEntry",!0),a=e.filter((function(t){return!("form"===t.data.type||"reEntry"===t.data.type)})).classed("element",!0),s=a.filter((function(t){return"var"===t.data.type})).classed("var",!0),l=a.filter((function(t){return"const"===t.data.type})).classed("const",!0);l.unmarked=a.filter((function(t){return 0==t.data.value})).classed("unmarked",!0),l.marked=a.filter((function(t){return 1==t.data.value})).classed("marked",!0),l.indef=a.filter((function(t){return 2==t.data.value})).classed("indef",!0),l.imag=a.filter((function(t){return 3==t.data.value})).classed("imag",!0);var u=a.filter((function(t){return"unclear"===t.data.type})).classed("unclear",!0),h=i.filter((function(t){return t.data.reChild})).classed("reChild",!0);return[n,r,i,o,h,a.filter((function(t){return"reEntryPoint"===t.data.type})).classed("reEntryPoint",!0),a,s,l,u]}function ft(t){return"form"===t.data.type||"reEntry"===t.data.type}function pt(t){return t.ancestors().filter((function(t){return"reEntry"===t.data.type})).shift().data.lastOpen}var dt=function(t,e,n,r){n=n||o.select(e.parentNode).attr("id");var i,s=(""+(i=new Date).getUTCFullYear()).substr(2)+h(i.getUTCMonth()+1,2)+h(i.getUTCDate(),2)+"-"+h(i.getHours(),2)+h(i.getMinutes(),2)+h(i.getSeconds(),2);try{switch(t){case"svg":!function(t,e){t.setAttribute("xmlns","http://www.w3.org/2000/svg");var n=t.outerHTML,r=new Blob(['<?xml version="1.0" standalone="no"?>\r\n',n],{type:"image/svg+xml;charset=utf-8"}),i=URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o)}(e,s+"_"+n+".svg");break;case"img":!function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=t.getBBox().width,i=t.getBBox().height,o=document.createElement("canvas");o.setAttribute("id","drawingArea"),document.body.appendChild(o),o.width=r*n,o.height=i*n,a(document.getElementById("drawingArea"),t.outerHTML,{ignoreDimensions:!0,ignoreMouse:!0,ignoreAnimation:!0,scaleWidth:r*n,scaleHeight:i*n});var s=o.toDataURL("image/png"),l=document.createElement("a");l.href=s,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),document.body.removeChild(o)}(e,s+"_"+n+".png",r)}}catch(t){console.log(t)}};function yt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return Math.tan(e*(Math.PI/180))*t}function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t){return function(t){if(Array.isArray(t))return gt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function xt(t,e,n){return(xt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function wt(t,e){return(wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=St(t);if(e){var i=St(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Pt(this,n)}}function Pt(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(i,t);var e,n,r;Et(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),Pt(void 0)}return e=i,r=[{key:"jsonString",value:function(t){var e=this.expand_reEntry(t);return xt(St(i),"jsonString",this).call(this,e)}},{key:"createGraph",value:function(t,e,n){var r="pack"===t,i=this.expand_reEntry(e,{addEmptyReChildSpace:r}),o=new ht(t,i,n);return o.formula=e,o}},{key:"saveGraph",value:function(t,e,n,r){dt(t,e,n,r)}},{key:"constructNested",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.space=[];for(var r in t.nested.reverse(),t.nested){if(r>0){n.unshift({type:"form",reChild:!0,space:[]});var i,o=n[0];t.nested[r].unmarked?(i=o.space).push.apply(i,mt(t.nested[r].space)):o.space.push(t.nested[r]),n=o.space}else{var a;t.nested[r].unmarked?(a=n).push.apply(a,mt(t.nested[r].space)):n.push(t.nested[r])}e.addEmptyReChildSpace&&0===n.length&&n.push({type:"space"})}var s=t;if(t.space.length>0)for(;s.space[0].hasOwnProperty("reChild")&&!((s=s.space[0]).space.length<1););return t.lastOpen?(s.space.unshift({type:"form",reChild:!0,space:[]}),s.space[0].space.unshift({type:"reEntryPoint"})):s.space.unshift({type:"reEntryPoint"}),delete t.nested,t}},{key:"expand_reEntry",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getValidForm(t),r=JSON.parse(JSON.stringify(n)),i=0;return this.traverseForm(n,(function(t){t.runningIndex=i,i++})),i=0,this.traverseForm(r,(function(t){t.runningIndex=i,i++})),this.traverseForm(n,(function(t){"reEntry"===t.type&&this.traverseForm(r,(function(n){if(JSON.stringify(t)===JSON.stringify(n)&&t.runningIndex===(n.hasOwnProperty("runningIndex")?n.runningIndex:null))return n=this.constructNested(n,e),!0}))})),this.traverseForm(r,(function(t){delete t.runningIndex})),r}}],(n=null)&&bt(e.prototype,n),r&&bt(e,r),i}(N);function Ot(t){return function(t){if(Array.isArray(t))return Ct(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function At(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mt(Object(n),!0).forEach((function(e){Bt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Bt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vt(t,e,n){var r=void 0!==t?'<span class="dna-form" title="FORM">'.concat(t,"</span>"):"",i=n&&e.length>1?'.<span class="dna-varorder" title="Variable interpretation order">['+n.join(",")+"]</span>":"";return'<div id="dna"><code>'.concat(r+i,'::<span class="dna-code">').concat(Rt(e),"</span></code></div>")}function Tt(t,e,n,r,i){var o=Math.sqrt(n.length),a=t.includes("::"),s=At({size:function(t){var e=14-(t-1);return Math.max(2,e)}(r),gapGrow:1.5,svgPad:"0",strokeW:.5,strokeC:"#fff",bgC:"none",hideInputLabel:!1,hideOrderLabel:!1,fullInputLabel:!1,inputLabelMax:200,customLabel:void 0},i),l=s.size,u=s.gapGrow,h=s.svgPad,c=s.strokeW,p=s.strokeC,d=s.bgC,y=s.hideInputLabel,v=s.hideOrderLabel,m=s.customLabel,g=s.fullInputLabel,b=s.inputLabelMax,x=(s.filter,[c].concat(Ot(Array.from({length:r-1},(function(t,e){return(e+1)*u}))))),w={w:l,h:l},E=Lt(r,x),P={w:w.w*o+x[0]+E,h:w.h*o+x[0]+E},S={w:Math.sqrt(2*Math.pow(P.w,2)),h:Math.sqrt(2*Math.pow(P.h,2))},k=n.split("").reverse().join("");return'<figure class="vmap" style="margin: 0;">\n\t\t<svg style="background: '.concat(d,"; padding: ").concat(h,';" width=').concat(w.w*o+E," height=").concat(w.h*o+E,'\n\t\tfill="white" stroke="').concat(p,'" stroke-width="').concat(x[0],'"\n\t\tviewBox="-').concat(x[0]/2," -").concat(x[0]/2," ").concat(S.w," ").concat(S.h,'">\n\t\t<g transform="translate(0,').concat(S.h/2,') rotate(-45,0,0)">').concat(jt(k,r,w,x),"</g>\n\t\t</svg>\n\t\t").concat(function(){if(void 0!==m)return'<figcaption style="word-wrap: break-word;">'.concat(m,"</figcaption>");if(!y||!v){var n="";return v||(n+="".concat(e.reduce((function(t,e,n){return t+(n>0?" > ":"")+function(t){if(t.length>1){var e=t.split("_");return e.length>1?"".concat(e[0],"<sub>").concat(e[1],"</sub>"):'"'.concat(t,'"')}return t}(e)}),"")).concat(y||r<1?"":"<br/>")),y||(n+=a?'<code style="font-size:0.8em;">'.concat(g?t:f(t,t.split("::")[0].length+Math.pow(4,4),"(".concat(Math.pow(4,r),")")),"</code>"):" = "+(g?t:f(t,b," <i>+more</i>"))),'<figcaption style="word-wrap: break-word;">'.concat(n,"</figcaption>")}return""}(),"\n\t\t</figure>")}function Nt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=At({margin:20,customLabel:void 0},n),i=r.margin,o=r.customLabel,a=t.map((function(t){return'<div class="vmap-item" style="padding: '.concat(Math.floor(i/4),"px ").concat(Math.floor(i/2),'px"> \n\t\t\t\t').concat(t,"</div>")})).reduce((function(t,e){return t+e}),""),s=void 0!==o?o:" = ".concat(e);return'<figure class="vmap-perspectives" style="max-width: none;">\n\t\t\t<div class="vmap-list" style="display: flex; flex-wrap: wrap; margin: 0 -'.concat(Math.floor(i/2),'px">\n\t\t\t').concat(a,'\n\t\t\t</div>\n\t\t\t<figcaption style="border-top: 1px solid; padding-top: ').concat(Math.floor(i/4),"px; margin-top: ").concat(Math.floor(i/2),'px; word-wrap: break-word;">').concat(s,"</figcaption>\n\t\t\t</figure>")}function Dt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=At({margin:20,vAlign:"bottom"},e),r=n.margin,i=n.vAlign;return'<div class="vmap-list" style="display: flex; flex-wrap: wrap; '.concat(Ft(i)," margin: 0 -").concat(Math.floor(r/2),'px">\n\t\t\t').concat(t.reduce((function(t,e){return"".concat(t,'<div class="vmap-item" style="padding: ').concat(Math.floor(r/4),"px ").concat(Math.floor(r/2),'px">').concat(e,"</div>")}),""),"\n\t\t\t</div>")}var jt=function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=Lt(n,i),l=Math.pow(4,n),u=Math.sqrt(l);e=e.substr(o*l,l),a+='<g transform="translate('.concat(It(o,u*r.w)+It(o,s)+It(o,i[n]),",\n").concat(zt(o,u*r.h)+zt(o,s)+zt(o,i[n]),')">');for(var h=0;n>0&&h<4||0===n&&h<1;h++)if(n>1)a=t(e,n-1,r,i,h,a);else{var c=e.substr(h,1);a+="<rect x=".concat(It(h,r.w)," y=").concat(zt(h,r.h)," width=").concat(r.w," height=").concat(r.h," fill=").concat(qt(c),"></rect>")}return a+="</g>"},Rt=function(t){return t.split("").reduce((function(t,e,n,r){return t+((n+1)%4==1?'<span class="dna-quart1">':"")+e+((n+1)%4==0?"</span>":"")}),"")},It=function(t,e){return t%2*(void 0!==e?e:0)},zt=function(t,e){return+(t>0&&t<3)*(void 0!==e?e:0)},Lt=function(t,e){return e.slice(1,t).reverse().reduce((function(t,e,n){return t+Math.pow(2,n)*e}),0)},Ft=function(t){return"align-items: ".concat("top"===t?"flex-start":"center"===t?"center":"flex-end",";")},qt=function(t){return 0==t?"#000000":1==t?"#4757ff":2==t?"#ff0044":3==t?"#00ff5f":NaN};var _t=n(5);function Xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xt(Object(n),!0).forEach((function(e){$t(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wt(t){return(Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Gt(t,e,n){return(Gt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Jt(t,e){return(Jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Qt(t);if(e){var i=Qt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Zt(this,n)}}function Zt(t,e){return!e||"object"!==Wt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qt(t){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Kt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jt(t,e)}(i,t);var e,n,r;Yt(i);function i(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),Zt(void 0)}return e=i,r=[{key:"calcAll",value:function(t){var e=this;if(t.includes("::")&&this.isValidDNA(t)){var n=function(){var n=t.split(":").pop(),r=n.split("").reverse(),i=e.totalVarsFromDNA(n),o=Array.from({length:i},(function(t,e){return'"x_'.concat(e,'"')})),a={};if(i<1)return a.Result=parseInt(r[0]),{v:a};for(var s=o.join()+";",l=0;l<r.length;l++){var u=h(l.toString(4),i);u.split("").map((function(t,e){return{var:o[e],value:parseInt(t)}})),a[s+u]=r[l]}return{v:a}}();if("object"===Wt(n))return n.v}return Gt(Qt(i),"calcAll",this).call(this,t)}},{key:"getVariables",value:function(t){if("string"==typeof t&&t.includes("::")){var e=this.getDNAparts(t),n=e.dna,r=e.formula,o=e.varList;if(void 0!==o)return o;if(void 0!==r)return Gt(Qt(i),"getVariables",this).call(this,r);var a=this.totalVarsFromDNA(n);return Array.from({length:a},(function(t,e){return"x_".concat(e)}))}return Gt(Qt(i),"getVariables",this).call(this,t)}},{key:"encode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=e?this.reOrderVars(t,e):t;return Object.values(this.calcAll(n)).reverse().join("")}},{key:"decode",value:function(t){return null}},{key:"intToDNA",value:function(t,e){if(t<0)throw new Error("Negative integers cannot be converted to formDNA.");var n=t.toString(4),r=e?Math.pow(4,e):function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.pow(4,n)>=e?Math.pow(4,n):t(e,n+1)}(n.length);if(n.length>r)throw new Error("Integer size exceeds desired DNA length.");return h(n,r)}},{key:"formToDNA",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=Ut({output:"text"},n),i=r.output,o=void 0,a=void 0,s=void 0;if(t.includes("::")){if(!this.isValidDNA(t))throw new Error("Input is not valid formDNA");var l=this.getDNAparts(t);o=l.dna,a=l.formula,s=l.varList}else o=this.encode(t,e||void 0),a=t,s=e||this.getVariables(a);switch(i){case"html":return Vt(a,o,s);case"text":return(void 0!==a?a:"")+(s&&o.length>1?".[".concat(s.join(","),"]"):"")+"::"+o;case"num":return o;default:return[a,s,o]}}},{key:"dnaToFORM",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this.decode(t,e)}},{key:"genRandomDNA",value:function(t){var e,n=(e=Math.pow(4n,Math.pow(4n,BigInt(t))),_t.randBetween(0,e)).value;return this.intToDNA(n,t)}},{key:"vmap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=Ut({limitSize:!0},n),i=r.limitSize,o=void 0,a=t;if(t.includes("::")&&this.isValidDNA(t)){var s=this.getDNAparts(t);o=s.dna,a=s.formula;var l=s.varList?s.varList:this.getVariables(t);if(void 0!==e&&void 0!==l&&!x(e,l))throw new Error("Variable order is specified in the formDNA input and as an argument for the vmap function and they are different. Please select only one specification to avoid conflicting results.");l?e=l:a&&(e=this.getVariables(a))}else e||(e=this.matchDefaultVarOrder(this.getVariables(a)));o||(o=this.encode(a,e));var u=this.totalVarsFromDNA(o);if(NaN===u)throw new Error("Invalid variable number for vmaps.");if(i&&u>8)throw new Error('vmaps with more than 8 variables are too computationally intensive to be rendered with this implementation. If you still want to proceed, add the option "limitSize: false" to your vmap function call (using the formform library).');return Tt(t,e,o,u,n)}},{key:"vmapPerspectives",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=Ut({limitSize:!0},r),o=i.limitSize;if("string"==typeof t&&t.includes("::"))throw new Error("formDNA input is not yet supported for vmap perspectives.");void 0===n&&(n=this.matchDefaultVarOrder(this.getVariables(t)));var a=n.length;if(o&&a>5)throw new Error('Rendering all the perspectives for vmaps with more than 5 variables is too computationally intensive with this implementation. You can, however, still compute single permutations by changing the variable order of your FORM. If you still want to proceed, add the option "limitSize: false" to your vmapPerspectives function call (using the formform library).');var s=t,l=c(n).map((function(t){return e.vmap(s,t,Ut({hideInputLabel:!0,customLabel:void 0},r))}));return Nt(l,s,r)}},{key:"vmapList",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=t.map((function(t){return e.vmap(t[0],t[1],Ut(Ut({},t[2]),n))}));return Dt(r,n)}},{key:"dnaMatchesForm",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=r||Gt(Qt(i),"getVariables",this).call(this,e),a=r?[y((function(){return n.formMatchesVarList(e,o)}),"FORM doesn't match the given variable list"),y((function(){return o.length===n.totalVarsFromDNA(t)}),"Number of variables in given variable list doesn't match formDNA code length"),y((function(){return n.encode(e,o)===t}),"formDNA code is inconsistent with FORM interpretation results (respecting specified variable order)")]:[y((function(){return o&&o.length===n.totalVarsFromDNA(t)}),"Number of FORM variables doesn't match formDNA code length"),y((function(){return n.encode(e)===t}),"formDNA code is inconsistent with FORM interpretation results")];return a.every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})}))}},{key:"isValidDNA",value:function(t,e){var n=this,r=Ut({compareForm:!0,requireMark:!0},e),i=r.compareForm,o=r.requireMark?t:"::"+t;[y((function(){return"string"==typeof o}),"formDNA input is not of type string"),y((function(){return o.includes("::")}),"Input does not include the mark :: for formDNA"),y((function(){return o.length>=3}),"formDNA input is too short")].every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})}));var a=this.getDNAparts(o),s=a.dna,l=a.formula,u=a.varList;return[y((function(){return n.totalVarsFromDNA(s)>=0}),"formDNA code length is not in the range 4^x"),y((function(){return!s.split("").some((function(t){return isNaN(parseInt(t))||parseInt(t)<0||parseInt(t)>3}))}),"formDNA code is not in quaternion format (consisting only of the numbers 0/1/2/3)"),i&&void 0!==l?y((function(){return n.dnaMatchesForm(s,l,u)}),"formDNA code part doesn't match formula part or formula part doesn't match its specified variable order"):null].filter((function(t){return t})).every((function(t){return t().cata({error:function(t){throw new Error(t)},success:function(t){return t}})})),!0}},{key:"totalVarsFromDNA",value:function(t){var e=t.split(":").pop(),n=Math.log(e.length)/Math.log(4);return n%1==0?n:NaN}},{key:"repairDNA",value:function(t){if(t.includes("::")){var e=this.getDNAparts(t);if(e.formula){var n=void 0;try{e.varList&&this.formMatchesVarList(e.formula,e.varList)&&(n=e.varList)}catch(t){console.error(t.message)}return this.formToDNA(e.formula,n)}return this.isValidDNA(t)?t:null}return this.formToDNA(t)}},{key:"getDNAparts",value:function(t){var e,n=void 0,r=void 0,i=t.split(":");if(e=i.pop(),i[0].length>0){var o=i[0].split(".");n=o[0],r=o.length>1?o[1].slice(1,-1).split(","):r}return{dna:e,formula:n,varList:r}}}],(n=null)&&Ht(e.prototype,n),r&&Ht(e,r),i}(N);e.default={calc:i,form:N,graph:kt,dna:Kt}}]).default}));
//# sourceMappingURL=formform.min.js.map