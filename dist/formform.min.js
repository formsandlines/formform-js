!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.formform=e():t.formform=e()}(this,(function(){return function(){var t={736:function(t,e,r){var n;t=r.nmd(t);var i=function(t){"use strict";var e=1e7,r=9007199254740992,n=h(r),o="0123456789abcdefghijklmnopqrstuvwxyz",s="function"==typeof BigInt;function a(t,e,r,n){return void 0===t?a[0]:void 0===e||10==+e&&!r?Y(t):T(t,e,r,n)}function u(t,e){this.value=t,this.sign=e,this.isSmall=!1}function l(t){this.value=t,this.sign=t<0,this.isSmall=!0}function p(t){this.value=t}function c(t){return-r<t&&t<r}function h(t){return t<1e7?[t]:t<1e14?[t%1e7,Math.floor(t/1e7)]:[t%1e7,Math.floor(t/1e7)%1e7,Math.floor(t/1e14)]}function f(t){v(t);var r=t.length;if(r<4&&I(t,n)<0)switch(r){case 0:return 0;case 1:return t[0];case 2:return t[0]+t[1]*e;default:return t[0]+(t[1]+t[2]*e)*e}return t}function v(t){for(var e=t.length;0===t[--e];);t.length=e+1}function g(t){for(var e=new Array(t),r=-1;++r<t;)e[r]=0;return e}function y(t){return t>0?Math.floor(t):Math.ceil(t)}function m(t,r){var n,i,o=t.length,s=r.length,a=new Array(o),u=0,l=e;for(i=0;i<s;i++)u=(n=t[i]+r[i]+u)>=l?1:0,a[i]=n-u*l;for(;i<o;)u=(n=t[i]+u)===l?1:0,a[i++]=n-u*l;return u>0&&a.push(u),a}function d(t,e){return t.length>=e.length?m(t,e):m(e,t)}function w(t,r){var n,i,o=t.length,s=new Array(o),a=e;for(i=0;i<o;i++)n=t[i]-a+r,r=Math.floor(n/a),s[i]=n-r*a,r+=1;for(;r>0;)s[i++]=r%a,r=Math.floor(r/a);return s}function b(t,r){var n,i,o=t.length,s=r.length,a=new Array(o),u=0,l=e;for(n=0;n<s;n++)(i=t[n]-u-r[n])<0?(i+=l,u=1):u=0,a[n]=i;for(n=s;n<o;n++){if(!((i=t[n]-u)<0)){a[n++]=i;break}i+=l,a[n]=i}for(;n<o;n++)a[n]=t[n];return v(a),a}function N(t,r,n){var i,o,s=t.length,a=new Array(s),p=-r,c=e;for(i=0;i<s;i++)o=t[i]+p,p=Math.floor(o/c),o%=c,a[i]=o<0?o+c:o;return"number"==typeof(a=f(a))?(n&&(a=-a),new l(a)):new u(a,n)}function E(t,r){var n,i,o,s,a=t.length,u=r.length,l=g(a+u),p=e;for(o=0;o<a;++o){s=t[o];for(var c=0;c<u;++c)n=s*r[c]+l[o+c],i=Math.floor(n/p),l[o+c]=n-i*p,l[o+c+1]+=i}return v(l),l}function A(t,r){var n,i,o=t.length,s=new Array(o),a=e,u=0;for(i=0;i<o;i++)n=t[i]*r+u,u=Math.floor(n/a),s[i]=n-u*a;for(;u>0;)s[i++]=u%a,u=Math.floor(u/a);return s}function O(t,e){for(var r=[];e-- >0;)r.push(0);return r.concat(t)}function S(t,e){var r=Math.max(t.length,e.length);if(r<=30)return E(t,e);r=Math.ceil(r/2);var n=t.slice(r),i=t.slice(0,r),o=e.slice(r),s=e.slice(0,r),a=S(i,s),u=S(n,o),l=S(d(i,n),d(s,o)),p=d(d(a,O(b(b(l,a),u),r)),O(u,2*r));return v(p),p}function V(t,r,n){return new u(t<e?A(r,t):E(r,h(t)),n)}function F(t){var r,n,i,o,s=t.length,a=g(s+s),u=e;for(i=0;i<s;i++){n=0-(o=t[i])*o;for(var l=i;l<s;l++)r=o*t[l]*2+a[i+l]+n,n=Math.floor(r/u),a[i+l]=r-n*u;a[i+s]=n}return v(a),a}function M(t,e){var r,n,i,o,s=t.length,a=g(s);for(i=0,r=s-1;r>=0;--r)i=(o=1e7*i+t[r])-(n=y(o/e))*e,a[r]=0|n;return[a,0|i]}function D(t,r){var n,i=Y(r);if(s)return[new p(t.value/i.value),new p(t.value%i.value)];var o,c=t.value,m=i.value;if(0===m)throw new Error("Cannot divide by zero");if(t.isSmall)return i.isSmall?[new l(y(c/m)),new l(c%m)]:[a[0],t];if(i.isSmall){if(1===m)return[t,a[0]];if(-1==m)return[t.negate(),a[0]];var d=Math.abs(m);if(d<e){o=f((n=M(c,d))[0]);var w=n[1];return t.sign&&(w=-w),"number"==typeof o?(t.sign!==i.sign&&(o=-o),[new l(o),new l(w)]):[new u(o,t.sign!==i.sign),new l(w)]}m=h(d)}var N=I(c,m);if(-1===N)return[a[0],t];if(0===N)return[a[t.sign===i.sign?1:-1],a[0]];o=(n=c.length+m.length<=200?function(t,r){var n,i,o,s,a,u,l,p=t.length,c=r.length,h=e,v=g(r.length),y=r[c-1],m=Math.ceil(h/(2*y)),d=A(t,m),w=A(r,m);for(d.length<=p&&d.push(0),w.push(0),y=w[c-1],i=p-c;i>=0;i--){for(n=h-1,d[i+c]!==y&&(n=Math.floor((d[i+c]*h+d[i+c-1])/y)),o=0,s=0,u=w.length,a=0;a<u;a++)o+=n*w[a],l=Math.floor(o/h),s+=d[i+a]-(o-l*h),o=l,s<0?(d[i+a]=s+h,s=-1):(d[i+a]=s,s=0);for(;0!==s;){for(n-=1,o=0,a=0;a<u;a++)(o+=d[i+a]-h+w[a])<0?(d[i+a]=o+h,o=0):(d[i+a]=o,o=1);s+=o}v[i]=n}return d=M(d,m)[0],[f(v),f(d)]}(c,m):function(t,r){for(var n,i,o,s,a,u=t.length,l=r.length,p=[],c=[],h=e;u;)if(c.unshift(t[--u]),v(c),I(c,r)<0)p.push(0);else{o=c[(i=c.length)-1]*h+c[i-2],s=r[l-1]*h+r[l-2],i>l&&(o=(o+1)*h),n=Math.ceil(o/s);do{if(I(a=A(r,n),c)<=0)break;n--}while(n);p.push(n),c=b(c,a)}return p.reverse(),[f(p),f(c)]}(c,m))[0];var E=t.sign!==i.sign,O=n[1],S=t.sign;return"number"==typeof o?(E&&(o=-o),o=new l(o)):o=new u(o,E),"number"==typeof O?(S&&(O=-O),O=new l(O)):O=new u(O,S),[o,O]}function I(t,e){if(t.length!==e.length)return t.length>e.length?1:-1;for(var r=t.length-1;r>=0;r--)if(t[r]!==e[r])return t[r]>e[r]?1:-1;return 0}function q(t){var e=t.abs();return!e.isUnit()&&(!!(e.equals(2)||e.equals(3)||e.equals(5))||!(e.isEven()||e.isDivisibleBy(3)||e.isDivisibleBy(5))&&(!!e.lesser(49)||void 0))}function x(t,e){for(var r,n,o,s=t.prev(),a=s,u=0;a.isEven();)a=a.divide(2),u++;t:for(n=0;n<e.length;n++)if(!t.lesser(e[n])&&!(o=i(e[n]).modPow(a,t)).isUnit()&&!o.equals(s)){for(r=u-1;0!=r;r--){if((o=o.square().mod(t)).isUnit())return!1;if(o.equals(s))continue t}return!1}return!0}u.prototype=Object.create(a.prototype),l.prototype=Object.create(a.prototype),p.prototype=Object.create(a.prototype),u.prototype.add=function(t){var e=Y(t);if(this.sign!==e.sign)return this.subtract(e.negate());var r=this.value,n=e.value;return e.isSmall?new u(w(r,Math.abs(n)),this.sign):new u(d(r,n),this.sign)},u.prototype.plus=u.prototype.add,l.prototype.add=function(t){var e=Y(t),r=this.value;if(r<0!==e.sign)return this.subtract(e.negate());var n=e.value;if(e.isSmall){if(c(r+n))return new l(r+n);n=h(Math.abs(n))}return new u(w(n,Math.abs(r)),r<0)},l.prototype.plus=l.prototype.add,p.prototype.add=function(t){return new p(this.value+Y(t).value)},p.prototype.plus=p.prototype.add,u.prototype.subtract=function(t){var e=Y(t);if(this.sign!==e.sign)return this.add(e.negate());var r=this.value,n=e.value;return e.isSmall?N(r,Math.abs(n),this.sign):function(t,e,r){var n;return I(t,e)>=0?n=b(t,e):(n=b(e,t),r=!r),"number"==typeof(n=f(n))?(r&&(n=-n),new l(n)):new u(n,r)}(r,n,this.sign)},u.prototype.minus=u.prototype.subtract,l.prototype.subtract=function(t){var e=Y(t),r=this.value;if(r<0!==e.sign)return this.add(e.negate());var n=e.value;return e.isSmall?new l(r-n):N(n,Math.abs(r),r>=0)},l.prototype.minus=l.prototype.subtract,p.prototype.subtract=function(t){return new p(this.value-Y(t).value)},p.prototype.minus=p.prototype.subtract,u.prototype.negate=function(){return new u(this.value,!this.sign)},l.prototype.negate=function(){var t=this.sign,e=new l(-this.value);return e.sign=!t,e},p.prototype.negate=function(){return new p(-this.value)},u.prototype.abs=function(){return new u(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},p.prototype.abs=function(){return new p(this.value>=0?this.value:-this.value)},u.prototype.multiply=function(t){var r,n,i,o=Y(t),s=this.value,l=o.value,p=this.sign!==o.sign;if(o.isSmall){if(0===l)return a[0];if(1===l)return this;if(-1===l)return this.negate();if((r=Math.abs(l))<e)return new u(A(s,r),p);l=h(r)}return new u(-.012*(n=s.length)-.012*(i=l.length)+15e-6*n*i>0?S(s,l):E(s,l),p)},u.prototype.times=u.prototype.multiply,l.prototype._multiplyBySmall=function(t){return c(t.value*this.value)?new l(t.value*this.value):V(Math.abs(t.value),h(Math.abs(this.value)),this.sign!==t.sign)},u.prototype._multiplyBySmall=function(t){return 0===t.value?a[0]:1===t.value?this:-1===t.value?this.negate():V(Math.abs(t.value),this.value,this.sign!==t.sign)},l.prototype.multiply=function(t){return Y(t)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,p.prototype.multiply=function(t){return new p(this.value*Y(t).value)},p.prototype.times=p.prototype.multiply,u.prototype.square=function(){return new u(F(this.value),!1)},l.prototype.square=function(){var t=this.value*this.value;return c(t)?new l(t):new u(F(h(Math.abs(this.value))),!1)},p.prototype.square=function(t){return new p(this.value*this.value)},u.prototype.divmod=function(t){var e=D(this,t);return{quotient:e[0],remainder:e[1]}},p.prototype.divmod=l.prototype.divmod=u.prototype.divmod,u.prototype.divide=function(t){return D(this,t)[0]},p.prototype.over=p.prototype.divide=function(t){return new p(this.value/Y(t).value)},l.prototype.over=l.prototype.divide=u.prototype.over=u.prototype.divide,u.prototype.mod=function(t){return D(this,t)[1]},p.prototype.mod=p.prototype.remainder=function(t){return new p(this.value%Y(t).value)},l.prototype.remainder=l.prototype.mod=u.prototype.remainder=u.prototype.mod,u.prototype.pow=function(t){var e,r,n,i=Y(t),o=this.value,s=i.value;if(0===s)return a[1];if(0===o)return a[0];if(1===o)return a[1];if(-1===o)return i.isEven()?a[1]:a[-1];if(i.sign)return a[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&c(e=Math.pow(o,s)))return new l(y(e));for(r=this,n=a[1];!0&s&&(n=n.times(r),--s),0!==s;)s/=2,r=r.square();return n},l.prototype.pow=u.prototype.pow,p.prototype.pow=function(t){var e=Y(t),r=this.value,n=e.value,i=BigInt(0),o=BigInt(1),s=BigInt(2);if(n===i)return a[1];if(r===i)return a[0];if(r===o)return a[1];if(r===BigInt(-1))return e.isEven()?a[1]:a[-1];if(e.isNegative())return new p(i);for(var u=this,l=a[1];(n&o)===o&&(l=l.times(u),--n),n!==i;)n/=s,u=u.square();return l},u.prototype.modPow=function(t,e){if(t=Y(t),(e=Y(e)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=a[1],n=this.mod(e);for(t.isNegative()&&(t=t.multiply(a[-1]),n=n.modInv(e));t.isPositive();){if(n.isZero())return a[0];t.isOdd()&&(r=r.multiply(n).mod(e)),t=t.divide(2),n=n.square().mod(e)}return r},p.prototype.modPow=l.prototype.modPow=u.prototype.modPow,u.prototype.compareAbs=function(t){var e=Y(t),r=this.value,n=e.value;return e.isSmall?1:I(r,n)},l.prototype.compareAbs=function(t){var e=Y(t),r=Math.abs(this.value),n=e.value;return e.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},p.prototype.compareAbs=function(t){var e=this.value,r=Y(t).value;return(e=e>=0?e:-e)===(r=r>=0?r:-r)?0:e>r?1:-1},u.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Y(t),r=this.value,n=e.value;return this.sign!==e.sign?e.sign?1:-1:e.isSmall?this.sign?-1:1:I(r,n)*(this.sign?-1:1)},u.prototype.compareTo=u.prototype.compare,l.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=Y(t),r=this.value,n=e.value;return e.isSmall?r==n?0:r>n?1:-1:r<0!==e.sign?r<0?-1:1:r<0?1:-1},l.prototype.compareTo=l.prototype.compare,p.prototype.compare=function(t){if(t===1/0)return-1;if(t===-1/0)return 1;var e=this.value,r=Y(t).value;return e===r?0:e>r?1:-1},p.prototype.compareTo=p.prototype.compare,u.prototype.equals=function(t){return 0===this.compare(t)},p.prototype.eq=p.prototype.equals=l.prototype.eq=l.prototype.equals=u.prototype.eq=u.prototype.equals,u.prototype.notEquals=function(t){return 0!==this.compare(t)},p.prototype.neq=p.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=u.prototype.neq=u.prototype.notEquals,u.prototype.greater=function(t){return this.compare(t)>0},p.prototype.gt=p.prototype.greater=l.prototype.gt=l.prototype.greater=u.prototype.gt=u.prototype.greater,u.prototype.lesser=function(t){return this.compare(t)<0},p.prototype.lt=p.prototype.lesser=l.prototype.lt=l.prototype.lesser=u.prototype.lt=u.prototype.lesser,u.prototype.greaterOrEquals=function(t){return this.compare(t)>=0},p.prototype.geq=p.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals,u.prototype.lesserOrEquals=function(t){return this.compare(t)<=0},p.prototype.leq=p.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals,u.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},p.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},u.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},p.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},u.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},p.prototype.isPositive=l.prototype.isPositive,u.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},p.prototype.isNegative=l.prototype.isNegative,u.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},p.prototype.isUnit=function(){return this.abs().value===BigInt(1)},u.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},p.prototype.isZero=function(){return this.value===BigInt(0)},u.prototype.isDivisibleBy=function(t){var e=Y(t);return!e.isZero()&&(!!e.isUnit()||(0===e.compareAbs(2)?this.isEven():this.mod(e).isZero()))},p.prototype.isDivisibleBy=l.prototype.isDivisibleBy=u.prototype.isDivisibleBy,u.prototype.isPrime=function(e){var r=q(this);if(r!==t)return r;var n=this.abs(),o=n.bitLength();if(o<=64)return x(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var s=Math.log(2)*o.toJSNumber(),a=Math.ceil(!0===e?2*Math.pow(s,2):s),u=[],l=0;l<a;l++)u.push(i(l+2));return x(n,u)},p.prototype.isPrime=l.prototype.isPrime=u.prototype.isPrime,u.prototype.isProbablePrime=function(e,r){var n=q(this);if(n!==t)return n;for(var o=this.abs(),s=e===t?5:e,a=[],u=0;u<s;u++)a.push(i.randBetween(2,o.minus(2),r));return x(o,a)},p.prototype.isProbablePrime=l.prototype.isProbablePrime=u.prototype.isProbablePrime,u.prototype.modInv=function(t){for(var e,r,n,o=i.zero,s=i.one,a=Y(t),u=this.abs();!u.isZero();)e=a.divide(u),r=o,n=a,o=s,a=u,s=r.subtract(e.multiply(s)),u=n.subtract(e.multiply(u));if(!a.isUnit())throw new Error(this.toString()+" and "+t.toString()+" are not co-prime");return-1===o.compare(0)&&(o=o.add(t)),this.isNegative()?o.negate():o},p.prototype.modInv=l.prototype.modInv=u.prototype.modInv,u.prototype.next=function(){var t=this.value;return this.sign?N(t,1,this.sign):new u(w(t,1),this.sign)},l.prototype.next=function(){var t=this.value;return t+1<r?new l(t+1):new u(n,!1)},p.prototype.next=function(){return new p(this.value+BigInt(1))},u.prototype.prev=function(){var t=this.value;return this.sign?new u(w(t,1),!0):N(t,1,this.sign)},l.prototype.prev=function(){var t=this.value;return t-1>-r?new l(t-1):new u(n,!0)},p.prototype.prev=function(){return new p(this.value-BigInt(1))};for(var L=[1];2*L[L.length-1]<=e;)L.push(2*L[L.length-1]);var R=L.length,P=L[R-1];function j(t){return Math.abs(t)<=e}function k(t,e,r){e=Y(e);for(var n=t.isNegative(),o=e.isNegative(),s=n?t.not():t,a=o?e.not():e,u=0,l=0,p=null,c=null,h=[];!s.isZero()||!a.isZero();)u=(p=D(s,P))[1].toJSNumber(),n&&(u=P-1-u),l=(c=D(a,P))[1].toJSNumber(),o&&(l=P-1-l),s=p[0],a=c[0],h.push(r(u,l));for(var f=0!==r(n?1:0,o?1:0)?i(-1):i(0),v=h.length-1;v>=0;v-=1)f=f.multiply(P).add(i(h[v]));return f}u.prototype.shiftLeft=function(t){var e=Y(t).toJSNumber();if(!j(e))throw new Error(String(e)+" is too large for shifting.");if(e<0)return this.shiftRight(-e);var r=this;if(r.isZero())return r;for(;e>=R;)r=r.multiply(P),e-=R-1;return r.multiply(L[e])},p.prototype.shiftLeft=l.prototype.shiftLeft=u.prototype.shiftLeft,u.prototype.shiftRight=function(t){var e,r=Y(t).toJSNumber();if(!j(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=R;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(e=D(n,P))[1].isNegative()?e[0].prev():e[0],r-=R-1}return(e=D(n,L[r]))[1].isNegative()?e[0].prev():e[0]},p.prototype.shiftRight=l.prototype.shiftRight=u.prototype.shiftRight,u.prototype.not=function(){return this.negate().prev()},p.prototype.not=l.prototype.not=u.prototype.not,u.prototype.and=function(t){return k(this,t,(function(t,e){return t&e}))},p.prototype.and=l.prototype.and=u.prototype.and,u.prototype.or=function(t){return k(this,t,(function(t,e){return t|e}))},p.prototype.or=l.prototype.or=u.prototype.or,u.prototype.xor=function(t){return k(this,t,(function(t,e){return t^e}))},p.prototype.xor=l.prototype.xor=u.prototype.xor;var B=1<<30;function $(t){var r=t.value,n="number"==typeof r?r|B:"bigint"==typeof r?r|BigInt(B):r[0]+r[1]*e|1073758208;return n&-n}function J(t,e){if(e.compareTo(t)<=0){var r=J(t,e.square(e)),n=r.p,o=r.e,s=n.multiply(e);return s.compareTo(t)<=0?{p:s,e:2*o+1}:{p:n,e:2*o}}return{p:i(1),e:0}}function _(t,e){return t=Y(t),e=Y(e),t.greater(e)?t:e}function Z(t,e){return t=Y(t),e=Y(e),t.lesser(e)?t:e}function z(t,e){if(t=Y(t).abs(),e=Y(e).abs(),t.equals(e))return t;if(t.isZero())return e;if(e.isZero())return t;for(var r,n,i=a[1];t.isEven()&&e.isEven();)r=Z($(t),$(e)),t=t.divide(r),e=e.divide(r),i=i.multiply(r);for(;t.isEven();)t=t.divide($(t));do{for(;e.isEven();)e=e.divide($(e));t.greater(e)&&(n=e,e=t,t=n),e=e.subtract(t)}while(!e.isZero());return i.isUnit()?t:t.multiply(i)}u.prototype.bitLength=function(){var t=this;return t.compareTo(i(0))<0&&(t=t.negate().subtract(i(1))),0===t.compareTo(i(0))?i(0):i(J(t,i(2)).e).add(i(1))},p.prototype.bitLength=l.prototype.bitLength=u.prototype.bitLength;var T=function(t,e,r,n){r=r||o,t=String(t),n||(t=t.toLowerCase(),r=r.toLowerCase());var i,s=t.length,a=Math.abs(e),u={};for(i=0;i<r.length;i++)u[r[i]]=i;for(i=0;i<s;i++)if("-"!==(c=t[i])&&c in u&&u[c]>=a){if("1"===c&&1===a)continue;throw new Error(c+" is not a valid digit in base "+e+".")}e=Y(e);var l=[],p="-"===t[0];for(i=p?1:0;i<t.length;i++){var c;if((c=t[i])in u)l.push(Y(u[c]));else{if("<"!==c)throw new Error(c+" is not a valid character");var h=i;do{i++}while(">"!==t[i]&&i<t.length);l.push(Y(t.slice(h+1,i)))}}return C(l,e,p)};function C(t,e,r){var n,i=a[0],o=a[1];for(n=t.length-1;n>=0;n--)i=i.add(t[n].times(o)),o=o.times(e);return r?i.negate():i}function U(t,e){if((e=i(e)).isZero()){if(t.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(e.equals(-1)){if(t.isZero())return{value:[0],isNegative:!1};if(t.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-t.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(t.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(t.isNegative()&&e.isPositive()&&(n=!0,t=t.abs()),e.isUnit())return t.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(t.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var o,s=[],a=t;a.isNegative()||a.compareAbs(e)>=0;){o=a.divmod(e),a=o.quotient;var u=o.remainder;u.isNegative()&&(u=e.minus(u).abs(),a=a.next()),s.push(u.toJSNumber())}return s.push(a.toJSNumber()),{value:s.reverse(),isNegative:n}}function W(t,e,r){var n=U(t,e);return(n.isNegative?"-":"")+n.value.map((function(t){return function(t,e){return t<(e=e||o).length?e[t]:"<"+t+">"}(t,r)})).join("")}function G(t){if(c(+t)){var e=+t;if(e===y(e))return s?new p(BigInt(e)):new l(e);throw new Error("Invalid integer: "+t)}var r="-"===t[0];r&&(t=t.slice(1));var n=t.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==y(i)||!c(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var o=n[0],a=o.indexOf(".");if(a>=0&&(i-=o.length-a-1,o=o.slice(0,a)+o.slice(a+1)),i<0)throw new Error("Cannot include negative exponent part for integers");t=o+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(t))throw new Error("Invalid integer: "+t);if(s)return new p(BigInt(r?"-"+t:t));for(var h=[],f=t.length,g=f-7;f>0;)h.push(+t.slice(g,f)),(g-=7)<0&&(g=0),f-=7;return v(h),new u(h,r)}function Y(t){return"number"==typeof t?function(t){if(s)return new p(BigInt(t));if(c(t)){if(t!==y(t))throw new Error(t+" is not an integer.");return new l(t)}return G(t.toString())}(t):"string"==typeof t?G(t):"bigint"==typeof t?new p(t):t}u.prototype.toArray=function(t){return U(this,t)},l.prototype.toArray=function(t){return U(this,t)},p.prototype.toArray=function(t){return U(this,t)},u.prototype.toString=function(e,r){if(e===t&&(e=10),10!==e)return W(this,e,r);for(var n,i=this.value,o=i.length,s=String(i[--o]);--o>=0;)n=String(i[o]),s+="0000000".slice(n.length)+n;return(this.sign?"-":"")+s},l.prototype.toString=function(e,r){return e===t&&(e=10),10!=e?W(this,e,r):String(this.value)},p.prototype.toString=l.prototype.toString,p.prototype.toJSON=u.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},u.prototype.valueOf=function(){return parseInt(this.toString(),10)},u.prototype.toJSNumber=u.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,p.prototype.valueOf=p.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var H=0;H<1e3;H++)a[H]=Y(H),H>0&&(a[-H]=Y(-H));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=_,a.min=Z,a.gcd=z,a.lcm=function(t,e){return t=Y(t).abs(),e=Y(e).abs(),t.divide(z(t,e)).multiply(e)},a.isInstance=function(t){return t instanceof u||t instanceof l||t instanceof p},a.randBetween=function(t,r,n){t=Y(t),r=Y(r);var i=n||Math.random,o=Z(t,r),s=_(t,r).subtract(o).add(1);if(s.isSmall)return o.add(Math.floor(i()*s));for(var u=U(s,e).value,l=[],p=!0,c=0;c<u.length;c++){var h=p?u[c]:e,f=y(i()*h);l.push(f),f<h&&(p=!1)}return o.add(a.fromArray(l,e,!1))},a.fromArray=function(t,e,r){return C(t.map(Y),Y(e||10),r)},a}();t.hasOwnProperty("exports")&&(t.exports=i),void 0===(n=function(){return i}.call(e,r,e,t))||(t.exports=n)}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={id:n,loaded:!1,exports:{}};return t[n](o,o.exports,r),o.loaded=!0,o.exports}r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t};var n={};return function(){"use strict";r.d(n,{default:function(){return v}});class t{constructor(){}static rel_logic(t,e){return t>3||t<0||e>3||e<0?-98:0===t||1===e?e:0===e||1===t||t===e?t:2===t&&3===e||3===t&&2===e?1:-99}static rel(...t){if(t.length>1){let e=0;for(let r in t)e=this.rel_logic(e,t[r]);return e}return-97}static inv_logic(t){switch(t){case 0:return 1;case 1:return 0;case 2:return 3;case 3:return 2}return-99}static inv(t,e){if(e>0){let r=t;for(let t=0;t<e;t++)r=this.inv_logic(r);return r}return this.inv_logic(t)}static uForm2(t,e,r=!1){return this.reEntry(void 0,!1,r,t,e)}static iForm2(t,e,r=!1){return this.reEntry(void 0,!0,r,t,e)}static uForm3(t,e,r,n,i=!1){return this.reEntry(!0,t,i,e,r,n)}static iForm3(t,e,r,n,i=!1){return this.reEntry(!1,t,i,e,r,n)}static uForm4(t,e,r,n,i=!1){return this.reEntry(void 0,!1,i,t,e,r,n)}static iForm4(t,e,r,n,i=!1){return this.reEntry(void 0,!0,i,t,e,r,n)}static uForm5(t,e,r,n,i,o,s=!1){return this.reEntry(!0,t,s,e,r,n,i,o)}static iForm5(t,e,r,n,i,o,s=!1){return this.reEntry(!1,t,s,e,r,n,i,o)}static reEntry(t,e,r,...n){void 0===t&&(t=!1),void 0===e&&(e=!1);const i=n.length%2==0;let o=0,s=-1,a=!1,u=!1;i?e?u=!0:a=!0:t?a=!0:u=!0;let l=-1;for(let t=0;t<n.length;t++){const e=n[t];if(1==e){l=t;break}if(0==e)o++;else if(2==e||3==e)if(-1==s)s=t;else if(e!=n[s]){l=s;break}}if(o==n.length)return u?3:2;if(l>=0){let t=1;for(let r=l;r<n.length;r++)t=e&&r==n.length-1?this.rel(t,n[r]):this.inv(this.rel(t,n[r]));return t}const p=!t||i||e?1:2;for(let o=n.length*p-1;o>=0;o--){const s=o%n.length;if(2==n[s]||3==n[s]){const a=n.length*p-1-o;if(r&&(e&&a%2==0||!e&&a%2==1))return u?this.rel(3,n[s]):this.rel(2,n[s]);{let r=2;!e||i||t||(r=this.inv(r));for(let t=0;t<n.length*p;t++){let i=0;t==o&&(i=2==n[s]?0:this.inv(0)),r=e&&t==n.length-1?this.rel(r,i):this.inv(this.rel(r,i))}let a=2;!e||i||t||(a=this.inv(a));for(let t=0;t<n.length*p;t++){let r=0;t==o&&(r=2==n[s]?1:this.inv(1)),a=e&&t==n.length-1?this.rel(a,r):this.inv(this.rel(a,r))}return this.cont(r,a)}}}return-99}static implL(t,e){return this.rel(this.inv(t),e)}static implR(t,e){return this.rel(t,this.inv(e))}static pre(t,e){return this.inv(this.implL(t,e))}static post(t,e){return this.inv(this.implR(t,e))}static cont(t,e){return this.rel(this.pre(t,e),this.post(t,e))}static equiv(t,e){return this.inv(this.cont(t,e))}}function e(t,e){for(var r=t+"";r.length<e;)r="0"+r;return r}function i(t){return t.reduce((function(t,e){return t.concat(Array.isArray(e)?i(e):e)}),[])}const o=(t,e="(",r=")")=>0===t.length||0===t.split("").reduce(((t,n,i,o)=>{if(n===e)t++;else if(n===r){if(null===t)return NaN;t--}return i===o.length-1&&null===t?0:t}),null),s=(t,e)=>(...r)=>{const n=t(...r);return{cata:t=>n?t.success(n):t.error(e)}},a=(t,e='"',r="‽")=>u(t,e)?t.split(e).filter(((t,e,r)=>e%2==0||e===r.length-1)).join(r):null,u=(t,e='"')=>t.split(e).length%2==1,l=(t,e={open:"{",close:"}"},r=[])=>{const n=t.match(new RegExp(`\\${e.open}[^${e.open}${e.close}]*?\\${e.close}`,"g"));if(!n)return r;const i=n.reduce(((t,e)=>t.replace(e,"•")),t);return l(i,e,[...r,...n])},p={a:"ᴬ",b:"ᴮ",c:"ᵓ",d:"ᴰ",e:"ᴱ",f:"ᵎ",g:"ᴳ",h:"ᴴ",i:"ᴵ",j:"ᴶ",k:"ᴷ",l:"ᴸ",m:"ᴹ",n:"ᴺ",o:"ᴼ",p:"ᴾ",q:"ᴽ",r:"ᴿ",s:"ᵕ",t:"ᵀ",u:"ᵁ",v:"ᵛ",w:"ᵂ",x:"ᵡ",y:"ᵞ",z:"ᵜ",alt:"ᵽ","2r":"ᵳ","2r+1":"ᵲ"},c=((t,e=!1)=>Object.keys(t).reduce(((r,n)=>Object.assign(r,{[t[n]]:e?n:(r[t[n]]||[]).concat(n)})),{}))(p,!0);class h extends t{constructor(){}static calc(t){let e=0;const r=this.getValidForm(t);for(let t in r.space)if("form"===r.space[t].type)e=this.rel(e,this.calc(r.space[t]));else if("const"===r.space[t].type)e=this.rel(e,r.space[t].value);else if("var"===r.space[t].type)isNaN(r.space[t].value)||(e=this.rel(e,r.space[t].value));else if("unclear"===r.space[t].type)e=this.rel(e,r.space[t].value);else if("reEntry"===r.space[t].type){let n=[];const i=r.space[t];for(let t in i.nested)n=[...n,this.calc(i.nested[t])];const o=i.nested.length%2==0?void 0:i.reEven;e=this.rel(e,this.reEntry(o,i.lastOpen,i.altInterpretation,...n))}return r.unmarked?e:this.inv(e)}static calcAll(t){const r=this.getValidForm(t),n=this.getVariables(r),i=n.length,o={};if(i<1)return o.Result=this.calc(r),o;const s=n.join()+";";for(let t=0;t<4**i;t++){const a=e(t.toString(4),i),u=a.split("").map(((t,e)=>({var:n[e],value:parseInt(t)})));o[s+a]=this.interCalc(r,u)}return o}static interCalc(t,e){return this.calc(this.interpret(t,e))}static interpret(t,e){const r=this.getValidForm(t),n=JSON.parse(JSON.stringify(r));return this.traverseForm(n,(function(t){const r=t.space;for(let t in r)if("var"===r[t].type)for(let n in e)if(r[t].symbol===e[n].var){r[t].value=e[n].value;break}})),n}static rel_logic(t,e){return typeof t===Array||typeof e===Array?null:super.rel_logic(t,e)}static rel(...t){return super.rel(...t)}static inv_logic(t){return typeof t===Array?null:super.inv_logic(t)}static inv(t,e){return super.inv(t,e)}static parseLinear(t){const e=this.convFromLinear(t);let r=null;try{r=JSON.parse(e)}catch(t){console.log(t)}return r}static convFromLinear(t){const e=this.cleanLinear(t);return i(this.constructFromLinear(e)).join("")}static cleanLinear(t){let e="",r=!1,n=!1;for(let i in t){const o=t[i];if("string"!=typeof o)break;'"'!==o||n||(r=!r),"/"!==o||r||(n=!n)," "===o?(r||n)&&(e+=o):e+=o}return e}static constructFromLinear(t){let e=[],r=!0,n=0,i=!1,o=!1;for(let e in t){const s=t[e];if("string"!=typeof s)break;if(!i&&!o)if("("===s){if(0==n&&0!=e)break;n++}else if(")"===s&&(n--,0==n)){if(e==t.length-1){r=!1;break}break}'"'!==s||o||(i=!i),"/"!==s||i||(o=!o)}e=[...e,"  {"],e=[...e,'"type":"form",'],r?e=[...e,'"unmarked":true,']:t=t.slice(1,t.length-1),e=[...e,'"space":['];let s=[""];n=0,i=!1,o=!1;for(let e in t){let r=t[e];const a=t[e-1];if("string"!=typeof r)break;i||o||(")"!==r&&"}"!==r||n--,"("===r||"{"===r?(0===n&&e>0&&(s=[...s,""]),n++):")"!==a&&"}"!==a||")"===r||"}"===r||0===n&&(s=[...s,""]),1===n&&","===r?r="⤵":1===n&&"|"===r?r="⤴":1===n&&"@"===r&&(r="↻")),'"'!==r||o||(i=!i),"/"!==r||i||(o=!o),s[s.length-1]+=r}for(let t in s){if("("===s[t][0]){let e=[this.constructFromLinear(s[t])];s[t]=e.slice()}else if("{"===s[t][0]){let e=["  {"];e=[...e,'"type":"reEntry",'];const r=s[t].slice(1,s[t].length-1);let n;if(r.includes("↻")){const t=r.startsWith("alt⤴"),i=t?r.slice(4):r.slice();let o=[-1,-1];i.startsWith("..↻._")?o=[3,1]:i.startsWith("..↻.")?o=[3,0]:i.startsWith("..↻_")?o=[2,1]:i.startsWith("..↻")?o=[2,0]:i.startsWith("↻_")?o=[0,1]:i.startsWith("↻")&&(o=[0,0]);const s=o[0]+o[1]+1;n=i.slice(s).split("⤵"),e=n.length%2==0?[...e,'"reEven":"undefined",']:2===o[0]?[...e,'"reEven":true,']:[...e,'"reEven":false,'],e=o[1]>0?[...e,'"lastOpen":true,']:[...e,'"lastOpen":false,'],e=t?[...e,'"altInterpretation":true,']:[...e,'"altInterpretation":false,']}else{const t=r.split("⤴");n=t[t.length-1].split("⤵"),e=n.length%2==0?[...e,'"reEven":"undefined",']:"2r"===t[0]||"2r"===t[1]||"2r"===t[2]?[...e,'"reEven":true,']:[...e,'"reEven":false,'],e="open"===t[0]||"open"===t[1]||"open"===t[2]?[...e,'"lastOpen":true,']:[...e,'"lastOpen":false,'],e="alt"===t[0]||"alt"===t[1]||"alt"===t[2]?[...e,'"altInterpretation":true,']:[...e,'"altInterpretation":false,']}e=[...e,'"nested":['];for(let t in n)e=[...e,this.constructFromLinear(n[t])],t<n.length-1&&(e=[...e,","]);e=[...e,"]}  "],s[t]=e.slice()}else{let e=[],r=[],n=!1,i=!1;for(let e in s[t]){const o=s[t][e];if("string"!=typeof o)break;'"'!==o||i?"/"!==o||n?(n||i||(r=[...r,""]),r[r.length-1]+='"'===o&&i?"\\"+o:o):(i=!i,i&&(r=[...r,"‽"])):(n=!n,n&&(r=[...r,"‖"]))}for(let t in r){if("string"!=typeof r[t])break;e=[...e,"  {"],!isNaN(r[t])&&r[t].length>0&&"‽"!==r[t][0]&&"‖"!==r[t][0]?(e=[...e,'"type":"const",'],e=[...e,'"value":'],e=[...e,r[t]]):"‽"===r[t][0]?(e=[...e,'"type":"unclear",'],e=[...e,'"value":2,'],e=[...e,'"symbol":'],e=[...e,'"'+r[t].slice(1)+'"']):(e=[...e,'"type":"var",'],e=[...e,'"value":"*",'],e=[...e,'"symbol":'],e="‖"===r[t][0]?[...e,'"'+r[t].slice(1)+'"']:[...e,'"'+r[t]+'"']),e=[...e,"}  "],t<r.length-1&&(e=[...e,","])}s[t]=e.slice()}e=[...e,s[t]],t<s.length-1&&(e=[...e,","])}return e=[...e,"]}  "],e}static constructNested(t,e={}){let r=t.space=[];t.nested.reverse();for(let n in t.nested){if(n>0){r.unshift({type:"form",reChild:!0,space:[]});const e=r[0];t.nested[n].unmarked?e.space.push(...t.nested[n].space):e.space.push(t.nested[n]),r=e.space}else t.nested[n].unmarked?r.push(...t.nested[n].space):r.push(t.nested[n]);e.addEmptyReChildSpace&&0===r.length&&r.push({type:"space"})}let n=t;if(t.space.length>0)for(;n.space[0].hasOwnProperty("reChild")&&(n=n.space[0],!(n.space.length<1)););return t.lastOpen?(n.space.unshift({type:"form",reChild:!0,space:[]}),n.space[0].space.unshift({type:"reEntryPoint"})):n.space.unshift({type:"reEntryPoint"}),delete t.nested,t}static expand_reEntry(t,e={}){const r=this.getValidForm(t),n=JSON.parse(JSON.stringify(r));let i=0;return this.traverseForm(r,(function(t){t.runningIndex=i,i++})),i=0,this.traverseForm(n,(function(t){t.runningIndex=i,i++})),this.traverseForm(r,(function(t){"reEntry"===t.type&&this.traverseForm(n,(function(r){if(JSON.stringify(t)===JSON.stringify(r)&&t.runningIndex===(r.hasOwnProperty("runningIndex")?r.runningIndex:null))return r=this.constructNested(r,e),!0}))})),this.traverseForm(n,(function(t){delete t.runningIndex})),n}static jsonString(t,e=!1){const r=this.getValidForm(e?this.expand_reEntry(t):t);return JSON.stringify(r,void 0,2)}static getVariables(t){const e=this.getValidForm(t);let r=[];return this.traverseForm(e,(function(t){const e=t.space;for(let t in e)"var"===e[t].type&&(n=r,i=e[t].symbol,-1==n.indexOf(i)&&(r=[...r,e[t].symbol]));var n,i})),r.sort()}static traverseForm(t,e){const r=e.apply(this,[t]);if(t.space){if(t.space.length>0)for(let r in t.space)if(("form"===t.space[r].type||"reEntry"===t.space[r].type)&&this.traverseForm(t.space[r],e))break}else if(t.nested){if(t.nested.length>0)for(let r in t.nested)if(this.traverseForm(t.nested[r],e))break}else console.log("ERROR: Not a form!");return r}static getTotalVars(t){return this.getVariables(t.substr()).length}static reOrderVars(t,e){return this.decodeVars(this.encodeVars(t,e))}static decodeVars(t,e){let r=c;if(e){const t=Object.keys(c),n=t.slice(0,e.length),i=t.slice(-3);r=n.concat(i).reduce(((t,r,n)=>({...t,[r]:n<e.length?e[n]:c[r]})),{})}return t.split("").map((t=>Object.keys(r).indexOf(t)>-1?r[t]:t)).join("")}static encodeVars(t,e){function r(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}e||(e=this.getVariables(t));return e.reduce(((t,e,n)=>t.replace(new RegExp("alt(?=|)","g"),p.alt).replace(new RegExp("2r(?=|)","g"),p["2r"]).replace(new RegExp("2r+1(?=|)","g"),p["2r+1"]).replace(new RegExp((t=>t.length>1?`"${r(t)}"`:`${r(t)}`)(e),"g"),Object.keys(c)[n])),t)}static matchDefaultVarOrder(t){return"ELR"===t.join("")?["L","E","R"]:"+-LR"===t.join("")?["-","L","R","+"]:"+-ELR"===t.join("")?["-","L","E","R","+"]:t}static isValidForm(t,e){return"string"==typeof t?isValidFormula(t,e):isValidJSONForm(t,e)}static isValidFormula(t,e){let r=[s((()=>"string"==typeof t),"Formula input is not of type ‘string’")];if(t.length>0&&(r=[...r,s((()=>!!a(t,'"')&&!!a(t,"/")),'Number of quotes for literal variables (e.g.: "x") or number of slashes for unclear FORMs (e.g.: /x/) don\'t match')]),r.every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))),t.length>0){const e=a(a(t,'"'),"/");[s((()=>o(e,"(",")")),"Number or opening/closing order of parantheses in formula don't match"),s((()=>o(e,"{","}")),"Number or opening/closing order of curly brackets in formula don't match")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})));const r=l(e,{open:"(",close:")"}),n=l(e,{open:"{",close:"}"});[s((()=>r.every((t=>o(t,"{","}")))&&n.every((t=>o(t,"(",")")))),"Opening/closing of parantheses overlaps with opening/closing of curly brackets in formula (e.g.: ({a)b})"),s((()=>n.every((t=>this.isValidReEntry(t)))),"Option part of one or more re-entry constructions is not well-formed")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}return!0}static isValidReEntry(t,e){const r=t.slice(1,-1).split("|");if(r.length>1){const t=r.filter(((t,e,r)=>e<r.length-1)),e=["alt","open","2r","2r+1"],n=t.reduce(((t,r)=>[...t,e.filter((t=>r===t))[0]]),[]).filter((t=>t)),i=[...new Set(n)];return[s((()=>i.length===t.length),"One or more re-entry constructions have invalid or duplicate options"),s((()=>i.filter((t=>t===e[2]||t===e[3])).length<2),"One or more re-entry constructions have both options ‘2r’ and ‘2r+1’ set at the same time")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}return!0}static isValidJSONForm(t,e){return[s((()=>!0),"")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}static formMatchesVarList(t,e){const r=this.getVariables(t);if(e.length!==r.length||!r.every((t=>e.some((e=>t===e)))))throw new Error("FORM doesn't match the given variable list");return!0}static getValidForm(t){if("string"==typeof t){if(!this.isValidFormula(t))throw new Error("Input is not a valid formula");return this.parseLinear(t)}return t}}var f=r(736),v={calc:t,form:h,dna:class extends h{constructor(){}static calcAll(t){if(t.includes("::")&&this.isValidDNA(t)){const r=t.split(":").pop(),n=r.split("").reverse(),i=this.totalVarsFromDNA(r),o=Array.from({length:i},((t,e)=>`"x_${e}"`)),s={};if(i<1)return s.Result=parseInt(n[0]),s;const a=o.join()+";";for(let t=0;t<n.length;t++){const r=e(t.toString(4),i);r.split("").map(((t,e)=>({var:o[e],value:parseInt(t)}))),s[a+r]=n[t]}return s}return super.calcAll(t)}static getVariables(t){if("string"==typeof t&&t.includes("::")){const{dna:e,formula:r,varList:n}=this.getDNAparts(t);if(void 0!==n)return n;if(void 0!==r)return super.getVariables(r);const i=this.totalVarsFromDNA(e);return Array.from({length:i},((t,e)=>`x_${e}`))}return super.getVariables(t)}static encode(t,e){const r=e?this.reOrderVars(t,e):t;return Object.values(this.calcAll(r)).reverse().join("")}static decode(t,e){if(e&&e.length!==this.totalVarsFromDNA(t))throw new Error("Number of variables in given variable list doesn't match formDNA code length");e||(e=this.generateVarNames(this.totalVarsFromDNA(t)));const r=this.universe_n(e),n=t.split("").reverse();return r.map(((t,e)=>`((${n[e]})(${t}))`)).join("")}static intToDNA(t,r){const n=t.toString(4);if("-"===n.substr(0,1))throw new Error("Negative integers cannot be converted to formDNA.");if(n.includes("."))throw new Error("Fractional numbers cannot be converted to formDNA.");const i=r?4**r:function t(e,r=0){return 4**r>=e?4**r:t(e,r+1)}(n.length);if(n.length>i)throw new Error("Integer size exceeds desired DNA length.");return e(n,i)}static formToDNA(t,e,r){const{output:n}={output:void 0,...r};let i,o,s;if(t.includes("::")){if(!this.isValidDNA(t))throw new Error("Input is not valid formDNA");const e=this.getDNAparts(t);i=e.dna,o=e.formula,s=e.varList}else i=this.encode(t,e||void 0),o=t,s=e||this.getVariables(o);switch(n){case"text":return(void 0!==o?o:"")+(s&&i.length>1?`.[${s.join(",")}]`:"")+"::"+i;case"num":return i;default:return[o,s,i]}}static dnaToFORM(t,e,r){return this.decode(t,e)}static genRandomDNA(t){const e=(r=f(4).pow(f(4).pow(t)).subtract(1),f.randBetween(0,r));var r;return this.intToDNA(e,t)}static vmap(t,e,r){const{limitSize:n,convDefaultVarorder:i,size:o,gapGrow:s,marginFunc:a,strokeW:u}={limitSize:!0,convDefaultVarorder:!0,size:void 0,gapGrow:1.5,marginFunc:void 0,strokeW:.5,...r};let l,p=t;if(t.includes("::")&&this.isValidDNA(t)){const r=this.getDNAparts(t);l=r.dna,p=r.formula;const n=r.varList?r.varList:this.getVariables(t);if(void 0!==e&&void 0!==n&&(h=n,void 0===(c=e)||void 0===h||c.length!==h.length||!c.every((t=>h.some((e=>t===e))))))throw new Error("Variable order is specified in the formDNA input and as an argument for the vmap function and they are different. Please select only one specification to avoid conflicting results.");n?e=n:p&&(e=this.getVariables(p))}else e||(e=this.getVariables(p),i&&(e=this.matchDefaultVarOrder(e)));var c,h;l||(l=this.encode(p,e));const f=this.totalVarsFromDNA(l);if(NaN===f)throw new Error("Invalid variable number for vmaps.");if(n&&f>8)throw new Error('vmaps with more than 8 variables are too computationally intensive to be rendered with this implementation. If you still want to proceed, add the option "limitSize: false" to your vmap function call (using the formform library).');const v=l.split("").reverse().join(""),g=o||(t=>{const e=17-(t>3?2*(t-3):0);return Math.max(2,e)})(f),y=[u,...Array.from({length:f-1},a||((t,e)=>(e+1)*s))],m={w:g,h:g};return{tree:this.constructVmap(v,f,m,y),input:t,varorder:e,options:r}}static vmapPerspectives(t,e,r,n){const{limitSize:i}={limitSize:!0,...r};if("string"==typeof t&&t.includes("::"))throw new Error("formDNA input is not yet supported for vmap perspectives.");void 0===e&&(e=this.matchDefaultVarOrder(this.getVariables(t)));const o=e.length;if(i&&o>5)throw new Error('Rendering all the perspectives for vmaps with more than 5 variables is too computationally intensive with this implementation. You can, however, still compute single permutations by changing the variable order of your FORM. If you still want to proceed, add the option "limitSize: false" to your vmapPerspectives function call (using the formform library).');const s=t;var a;return(a=e,a.reduce((function t(e,r,n,i){return e.concat(i.length>1&&i.slice(0,n).concat(i.slice(n+1)).reduce(t,[]).map((function(t){return[r].concat(t)}))||[[r]])}),[])).map((t=>this.vmap(s,t,{hideInputLabel:!0,customLabel:void 0,...n})))}static vmapList(t,e){return t.map((t=>this.vmap(t[0],t[1],{...t[2],...e})))}static constructVmap(t,e,r,n){const i=(t,e)=>t%2*(void 0!==e?e:0),o=(t,e)=>+(t>0&&t<3)*(void 0!==e?e:0),s=(t,r,n,a,u=0)=>{const l={},p=((t,e)=>e.slice(1,t).reverse().reduce(((t,e,r)=>t+2**r*e),0))(r,a),c=4**r,h=Math.sqrt(c);if(t=t.substr(u*c,c),l.data={dna:"::"+t.split("").reverse().join(""),vnum:r,cell:n,margins:e>0?a.slice(0,r):a.slice(0,1)},l.height=r,l.depth=e-Math.log(c)/Math.log(4),l.order=u,l.position=[i(u,h*n.w)+i(u,p)+i(u,a[r]),o(u,h*n.h)+o(u,p)+o(u,a[r])],l.scale=[h*n.w+p,h*n.h+p],0===e)return l.value=t,l;l.children=[];for(let e=0;r>0&&e<4||0===r&&e<1;e++)if(r>1)l.children=[...l.children,s(t,r-1,n,a,e)];else{const s=t.substr(e,1);l.children=[...l.children,{data:{dna:"::"+s,vnum:0,cell:n,margins:a.slice(0,1)},value:s,height:r-1,depth:l.depth+1,order:e,position:[i(e,n.w),o(e,n.h)],scale:[n.w,n.h]}]}return l};return s(t,e,r,n)}static dnaMatchesForm(t,e,r,n){const i=r||super.getVariables(e);return(r?[s((()=>this.formMatchesVarList(e,i)),"FORM doesn't match the given variable list"),s((()=>i.length===this.totalVarsFromDNA(t)),"Number of variables in given variable list doesn't match formDNA code length"),s((()=>this.encode(e,i)===t),"formDNA code is inconsistent with FORM interpretation results (respecting specified variable order)")]:[s((()=>i&&i.length===this.totalVarsFromDNA(t)),"Number of FORM variables doesn't match formDNA code length"),s((()=>this.encode(e)===t),"formDNA code is inconsistent with FORM interpretation results")]).every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})))}static isValidDNA(t,e){const{compareForm:r,requireMark:n}={compareForm:!0,requireMark:!0,...e},i=n?t:"::"+t;[s((()=>"string"==typeof i),"formDNA input is not of type ‘string’"),s((()=>i.includes("::")),"Input does not include the mark ‘::’ for formDNA"),s((()=>i.length>=3),"formDNA input is too short")].every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t})));const{dna:o,formula:a,varList:u}=this.getDNAparts(i);return[s((()=>this.totalVarsFromDNA(o)>=0),"formDNA code length is not in the range 4^x"),s((()=>!o.split("").some((t=>isNaN(parseInt(t))||parseInt(t)<0||parseInt(t)>3))),"formDNA code is not in quaternion format (consisting only of the numbers 0/1/2/3)"),r&&void 0!==a?s((()=>this.dnaMatchesForm(o,a,u)),"formDNA code part doesn't match formula part or formula part doesn't match its specified variable order"):null].filter((t=>t)).every((t=>t().cata({error:t=>{throw new Error(t)},success:t=>t}))),!0}static generateVarNames(t,e){return Array.from({length:t},((t,r)=>{let n=`x_${r}`;if(void 0!==e)for(;e.includes(n);)n+="′";return n}))}static universe_1(t){return t.length>1&&(t=`"${t}"`),[`({(${t})}{2r|(${t})})`,`({${t}}{2r|${t}})`,`(({(${t})}${t})({2r|${t}}(${t})))`,`(({${t}}(${t}))({2r|(${t})}${t}))`]}static universe_n(t){const r=t.length,n=t.map((t=>this.universe_1(t)));return Array.from({length:4**r},((t,i)=>{const o=e(i.toString(4),r).split(""),s=n.reduce(((t,e,r,n)=>t+`(${e[o[r]]})`+(r===n.length-1?")":"")),"(");return r>1?s:s.slice(2,-2)}))}static totalVarsFromDNA(t){const e=t.split(":").pop(),r=Math.log(e.length)/Math.log(4);return r%1==0?r:NaN}static repairDNA(t){if(t.includes("::")){const e=this.getDNAparts(t);if(e.formula){let t;try{e.varList&&this.formMatchesVarList(e.formula,e.varList)&&(t=e.varList)}catch(t){console.error(t.message)}return this.formToDNA(e.formula,t)}return this.isValidDNA(t)?t:null}return this.formToDNA(t)}static getDNAparts(t){let e,r,n;const i=t.split(":");if(e=i.pop(),i[0].length>0){const t=i[0].split(".");r=t[0],n=t.length>1?t[1].slice(1,-1).split(","):n}return{dna:e,formula:r,varList:n}}}}}(),n.default}()}));
//# sourceMappingURL=formform.min.js.map